cuequivariance or cuequivariance_torch is not available. Cuequivariance acceleration will be disabled.
False
Results directory samples/ already exists. Exiting.
Reading data from:  ./raw/bi4-6_parsed.csv
['./raw/bi4-6_parsed.csv']
Reading data from:  ./raw/bi4-6_parsed.csv
[-23374.019247256296]
(4, 3)
Loading saved bootstrap sample 0
Training model 0
Using latent charge and penalty 1
2025-04-29 19:43:05.530 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:43:05.530 INFO: MACE version: 0.3.10
2025-04-29 19:43:05.591 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:43:05.681 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:43:05.681 INFO: Using heads: ['default']
2025-04-29 19:43:05.682 INFO: =============    Processing head default     ===========
2025-04-29 19:43:05.682 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:43:05.686 INFO: Atomic Numbers used: [83]
2025-04-29 19:43:05.686 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5843.559373643665}}
2025-04-29 19:43:05.697 INFO: Atomic Energies used (z: eV) for head default: {83: -5843.559373643665}
2025-04-29 19:43:05.812 INFO: Computing average number of neighbors
2025-04-29 19:43:08.413 INFO: Average number of neighbors: 3.0
2025-04-29 19:43:08.413 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:43:08.414 INFO: ===========MODEL DETAILS===========
2025-04-29 19:43:08.414 INFO: Building model
2025-04-29 19:43:08.414 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:43:08.414 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:43:08.414 INFO: 8 radial and 5 basis functions
2025-04-29 19:43:08.414 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:43:08.414 INFO: Distance transform for radial basis functions: None
2025-04-29 19:43:08.414 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:43:08.710 INFO: Mean: 8.631235935106154e-06, Std: [0.50390049]
0.0 [0.50390049]
2025-04-29 19:43:08.710 INFO: Scale: [0.50390049], Shift: 0.0
2025-04-29 19:43:10.029 INFO: Total number of parameters: 509618
2025-04-29 19:43:10.029 INFO: 
2025-04-29 19:43:10.029 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:43:10.029 INFO: Using ADAM as parameter optimizer
2025-04-29 19:43:10.029 INFO: Batch size: 32
2025-04-29 19:43:10.029 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:43:10.029 INFO: Number of gradient updates: 2250
2025-04-29 19:43:10.029 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:43:10.029 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:43:10.031 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:43:10.031 INFO: 
2025-04-29 19:43:10.031 INFO: ===========TRAINING===========
2025-04-29 19:43:10.031 INFO: Started training, reporting errors on validation set
2025-04-29 19:43:10.031 INFO: Loss metrics on validation set
2025-04-29 19:43:12.558 INFO: Initial: head: validation, loss=16.67781722, MAE_E=16054.51 meV, MAE_F=  327.81 meV / A
2025-04-29 19:43:17.887 INFO: Epoch 0: head: train, loss=0.65906025, MAE_E= 2769.67 meV, MAE_F=  101.33 meV / A
2025-04-29 19:43:19.223 INFO: Epoch 0: head: validation, loss=0.65150305, MAE_E= 2765.88 meV, MAE_F=  100.34 meV / A
2025-04-29 19:43:21.455 INFO: Epoch 1: head: train, loss=0.45644742, MAE_E= 1053.27 meV, MAE_F=   84.37 meV / A
2025-04-29 19:43:22.103 INFO: Epoch 1: head: validation, loss=0.44883793, MAE_E= 1047.65 meV, MAE_F=   80.11 meV / A
2025-04-29 19:43:24.551 INFO: Epoch 2: head: train, loss=0.95469771, MAE_E=  152.10 meV, MAE_F=  105.77 meV / A
2025-04-29 19:43:25.105 INFO: Epoch 2: head: validation, loss=0.96146304, MAE_E=  159.68 meV, MAE_F=  108.95 meV / A
2025-04-29 19:43:27.362 INFO: Epoch 3: head: train, loss=0.14272594, MAE_E=  828.73 meV, MAE_F=   67.01 meV / A
2025-04-29 19:43:27.994 INFO: Epoch 3: head: validation, loss=0.14194673, MAE_E=  826.17 meV, MAE_F=   64.76 meV / A
2025-04-29 19:43:30.385 INFO: Epoch 4: head: train, loss=0.07535675, MAE_E= 1286.16 meV, MAE_F=   80.84 meV / A
2025-04-29 19:43:31.017 INFO: Epoch 4: head: validation, loss=0.07144715, MAE_E= 1282.91 meV, MAE_F=   77.34 meV / A
2025-04-29 19:43:33.311 INFO: Epoch 5: head: train, loss=0.14266218, MAE_E=  738.25 meV, MAE_F=   59.32 meV / A
2025-04-29 19:43:33.958 INFO: Epoch 5: head: validation, loss=0.14334985, MAE_E=  738.10 meV, MAE_F=   58.02 meV / A
2025-04-29 19:43:36.266 INFO: Epoch 6: head: train, loss=1.57653616, MAE_E=22240.77 meV, MAE_F=  221.34 meV / A
2025-04-29 19:43:36.880 INFO: Epoch 6: head: validation, loss=1.65433668, MAE_E=22251.38 meV, MAE_F=  222.10 meV / A
2025-04-29 19:43:39.187 INFO: Epoch 7: head: train, loss=0.97121760, MAE_E=20547.82 meV, MAE_F=  118.16 meV / A
2025-04-29 19:43:39.893 INFO: Epoch 7: head: validation, loss=1.01250667, MAE_E=20550.27 meV, MAE_F=  114.80 meV / A
2025-04-29 19:43:42.213 INFO: Epoch 8: head: train, loss=0.32439057, MAE_E= 9594.43 meV, MAE_F=  103.86 meV / A
2025-04-29 19:43:42.851 INFO: Epoch 8: head: validation, loss=0.32799493, MAE_E= 9597.69 meV, MAE_F=  100.60 meV / A
2025-04-29 19:43:44.994 INFO: Epoch 9: head: train, loss=0.18462814, MAE_E= 4786.45 meV, MAE_F=   96.32 meV / A
2025-04-29 19:43:45.521 INFO: Epoch 9: head: validation, loss=0.18358369, MAE_E= 4788.57 meV, MAE_F=   96.49 meV / A
2025-04-29 19:43:47.691 INFO: Epoch 10: head: train, loss=0.08923812, MAE_E= 2182.94 meV, MAE_F=   86.99 meV / A
2025-04-29 19:43:48.215 INFO: Epoch 10: head: validation, loss=0.08104830, MAE_E= 2183.33 meV, MAE_F=   84.54 meV / A
2025-04-29 19:43:50.342 INFO: Epoch 11: head: train, loss=0.13451015, MAE_E=  867.29 meV, MAE_F=   78.05 meV / A
2025-04-29 19:43:50.877 INFO: Epoch 11: head: validation, loss=0.13034456, MAE_E=  867.44 meV, MAE_F=   77.45 meV / A
2025-04-29 19:43:53.074 INFO: Epoch 12: head: train, loss=0.05518822, MAE_E=  461.03 meV, MAE_F=   60.02 meV / A
2025-04-29 19:43:53.653 INFO: Epoch 12: head: validation, loss=0.05358818, MAE_E=  462.06 meV, MAE_F=   60.04 meV / A
2025-04-29 19:43:56.024 INFO: Epoch 13: head: train, loss=0.03574237, MAE_E=  309.86 meV, MAE_F=   46.19 meV / A
2025-04-29 19:43:56.651 INFO: Epoch 13: head: validation, loss=0.03558510, MAE_E=  311.85 meV, MAE_F=   46.05 meV / A
2025-04-29 19:43:59.057 INFO: Epoch 14: head: train, loss=0.03502260, MAE_E=  175.10 meV, MAE_F=   39.85 meV / A
2025-04-29 19:43:59.674 INFO: Epoch 14: head: validation, loss=0.03536009, MAE_E=  177.81 meV, MAE_F=   39.54 meV / A
2025-04-29 19:44:02.122 INFO: Epoch 15: head: train, loss=0.02289227, MAE_E=   86.14 meV, MAE_F=   36.09 meV / A
2025-04-29 19:44:02.699 INFO: Epoch 15: head: validation, loss=0.02326106, MAE_E=   88.04 meV, MAE_F=   35.82 meV / A
2025-04-29 19:44:05.145 INFO: Epoch 16: head: train, loss=0.01764776, MAE_E=   57.05 meV, MAE_F=   33.41 meV / A
2025-04-29 19:44:05.741 INFO: Epoch 16: head: validation, loss=0.01788808, MAE_E=   58.46 meV, MAE_F=   33.46 meV / A
2025-04-29 19:44:08.098 INFO: Epoch 17: head: train, loss=0.00949279, MAE_E=   46.87 meV, MAE_F=   33.66 meV / A
2025-04-29 19:44:08.676 INFO: Epoch 17: head: validation, loss=0.00941460, MAE_E=   47.71 meV, MAE_F=   33.67 meV / A
2025-04-29 19:44:10.927 INFO: Epoch 18: head: train, loss=0.01610503, MAE_E=  118.95 meV, MAE_F=   41.05 meV / A
2025-04-29 19:44:11.507 INFO: Epoch 18: head: validation, loss=0.01471034, MAE_E=  116.84 meV, MAE_F=   39.69 meV / A
2025-04-29 19:44:13.859 INFO: Epoch 19: head: train, loss=0.02402202, MAE_E=   93.61 meV, MAE_F=   50.72 meV / A
2025-04-29 19:44:14.455 INFO: Epoch 19: head: validation, loss=0.02256253, MAE_E=   96.88 meV, MAE_F=   49.22 meV / A
2025-04-29 19:44:16.786 INFO: Epoch 20: head: train, loss=0.01734928, MAE_E=  248.86 meV, MAE_F=   41.26 meV / A
2025-04-29 19:44:17.392 INFO: Epoch 20: head: validation, loss=0.01710033, MAE_E=  252.65 meV, MAE_F=   40.42 meV / A
2025-04-29 19:44:19.740 INFO: Epoch 21: head: train, loss=0.01168742, MAE_E=  199.84 meV, MAE_F=   35.88 meV / A
2025-04-29 19:44:20.372 INFO: Epoch 21: head: validation, loss=0.01166651, MAE_E=  203.43 meV, MAE_F=   35.25 meV / A
2025-04-29 19:44:22.712 INFO: Epoch 22: head: train, loss=0.01158225, MAE_E=   89.47 meV, MAE_F=   36.34 meV / A
2025-04-29 19:44:23.331 INFO: Epoch 22: head: validation, loss=0.01153591, MAE_E=   92.73 meV, MAE_F=   35.66 meV / A
2025-04-29 19:44:25.597 INFO: Epoch 23: head: train, loss=0.00797051, MAE_E=  164.54 meV, MAE_F=   31.14 meV / A
2025-04-29 19:44:26.214 INFO: Epoch 23: head: validation, loss=0.00808129, MAE_E=  167.77 meV, MAE_F=   30.82 meV / A
2025-04-29 19:44:28.631 INFO: Epoch 24: head: train, loss=0.01444645, MAE_E=   28.16 meV, MAE_F=   30.99 meV / A
2025-04-29 19:44:29.192 INFO: Epoch 24: head: validation, loss=0.01478015, MAE_E=   27.24 meV, MAE_F=   30.90 meV / A
2025-04-29 19:44:31.545 INFO: Epoch 25: head: train, loss=0.00560296, MAE_E=  183.75 meV, MAE_F=   25.44 meV / A
2025-04-29 19:44:32.124 INFO: Epoch 25: head: validation, loss=0.00565964, MAE_E=  186.34 meV, MAE_F=   25.28 meV / A
2025-04-29 19:44:34.572 INFO: Epoch 26: head: train, loss=0.01551056, MAE_E=   29.83 meV, MAE_F=   35.50 meV / A
2025-04-29 19:44:35.218 INFO: Epoch 26: head: validation, loss=0.01486767, MAE_E=   30.05 meV, MAE_F=   34.53 meV / A
2025-04-29 19:44:37.524 INFO: Epoch 27: head: train, loss=0.06812499, MAE_E=   61.06 meV, MAE_F=   77.02 meV / A
2025-04-29 19:44:38.162 INFO: Epoch 27: head: validation, loss=0.06312817, MAE_E=   60.77 meV, MAE_F=   72.84 meV / A
2025-04-29 19:44:40.464 INFO: Epoch 28: head: train, loss=0.09884513, MAE_E=  293.07 meV, MAE_F=  101.21 meV / A
2025-04-29 19:44:41.113 INFO: Epoch 28: head: validation, loss=0.09083343, MAE_E=  290.32 meV, MAE_F=   98.15 meV / A
2025-04-29 19:44:43.466 INFO: Epoch 29: head: train, loss=0.07923147, MAE_E=  753.34 meV, MAE_F=   87.72 meV / A
2025-04-29 19:44:44.107 INFO: Epoch 29: head: validation, loss=0.07611274, MAE_E=  751.04 meV, MAE_F=   87.51 meV / A
2025-04-29 19:44:46.407 INFO: Epoch 30: head: train, loss=0.06795007, MAE_E= 1082.30 meV, MAE_F=   78.22 meV / A
2025-04-29 19:44:47.031 INFO: Epoch 30: head: validation, loss=0.06476679, MAE_E= 1081.08 meV, MAE_F=   78.27 meV / A
2025-04-29 19:44:49.306 INFO: Epoch 31: head: train, loss=0.07354833, MAE_E=  747.72 meV, MAE_F=   94.20 meV / A
2025-04-29 19:44:49.993 INFO: Epoch 31: head: validation, loss=0.08313250, MAE_E=  747.82 meV, MAE_F=   99.37 meV / A
2025-04-29 19:44:52.286 INFO: Epoch 32: head: train, loss=0.08675723, MAE_E= 1447.90 meV, MAE_F=   93.10 meV / A
2025-04-29 19:44:52.913 INFO: Epoch 32: head: validation, loss=0.08480347, MAE_E= 1449.20 meV, MAE_F=   91.38 meV / A
2025-04-29 19:44:55.271 INFO: Epoch 33: head: train, loss=0.24975247, MAE_E= 3109.69 meV, MAE_F=  141.60 meV / A
2025-04-29 19:44:55.830 INFO: Epoch 33: head: validation, loss=0.22646820, MAE_E= 3113.50 meV, MAE_F=  132.84 meV / A
2025-04-29 19:44:58.096 INFO: Epoch 34: head: train, loss=0.28632916, MAE_E= 3443.11 meV, MAE_F=  151.08 meV / A
2025-04-29 19:44:58.710 INFO: Epoch 34: head: validation, loss=0.26024072, MAE_E= 3447.36 meV, MAE_F=  141.08 meV / A
2025-04-29 19:45:00.990 INFO: Epoch 35: head: train, loss=0.26732229, MAE_E= 3630.74 meV, MAE_F=  149.64 meV / A
2025-04-29 19:45:01.613 INFO: Epoch 35: head: validation, loss=0.24439995, MAE_E= 3634.23 meV, MAE_F=  140.83 meV / A
2025-04-29 19:45:03.887 INFO: Epoch 36: head: train, loss=0.20743034, MAE_E= 3166.43 meV, MAE_F=  133.01 meV / A
2025-04-29 19:45:04.512 INFO: Epoch 36: head: validation, loss=0.19063580, MAE_E= 3168.99 meV, MAE_F=  126.36 meV / A
2025-04-29 19:45:06.783 INFO: Epoch 37: head: train, loss=0.27083489, MAE_E= 3751.25 meV, MAE_F=  132.63 meV / A
2025-04-29 19:45:07.390 INFO: Epoch 37: head: validation, loss=0.24662541, MAE_E= 3754.53 meV, MAE_F=  122.35 meV / A
2025-04-29 19:45:09.599 INFO: Epoch 38: head: train, loss=0.37230743, MAE_E= 2769.47 meV, MAE_F=  146.66 meV / A
2025-04-29 19:45:10.211 INFO: Epoch 38: head: validation, loss=0.34753947, MAE_E= 2772.10 meV, MAE_F=  137.87 meV / A
2025-04-29 19:45:12.464 INFO: Epoch 39: head: train, loss=0.40683485, MAE_E= 1557.34 meV, MAE_F=  148.64 meV / A
2025-04-29 19:45:13.135 INFO: Epoch 39: head: validation, loss=0.37607612, MAE_E= 1560.40 meV, MAE_F=  139.19 meV / A
2025-04-29 19:45:15.451 INFO: Epoch 40: head: train, loss=0.32343167, MAE_E= 1531.38 meV, MAE_F=  136.20 meV / A
2025-04-29 19:45:16.102 INFO: Epoch 40: head: validation, loss=0.29727700, MAE_E= 1533.96 meV, MAE_F=  128.18 meV / A
2025-04-29 19:45:18.385 INFO: Epoch 41: head: train, loss=0.25281223, MAE_E= 1719.99 meV, MAE_F=  121.55 meV / A
2025-04-29 19:45:19.038 INFO: Epoch 41: head: validation, loss=0.22697304, MAE_E= 1722.76 meV, MAE_F=  112.41 meV / A
2025-04-29 19:45:21.402 INFO: Epoch 42: head: train, loss=0.17963379, MAE_E= 1506.61 meV, MAE_F=  103.33 meV / A
2025-04-29 19:45:21.957 INFO: Epoch 42: head: validation, loss=0.15877169, MAE_E= 1509.54 meV, MAE_F=   94.03 meV / A
2025-04-29 19:45:24.272 INFO: Epoch 43: head: train, loss=0.11544746, MAE_E=  907.86 meV, MAE_F=   90.96 meV / A
2025-04-29 19:45:24.895 INFO: Epoch 43: head: validation, loss=0.10771246, MAE_E=  909.28 meV, MAE_F=   84.31 meV / A
2025-04-29 19:45:27.162 INFO: Epoch 44: head: train, loss=0.09486806, MAE_E=  832.64 meV, MAE_F=   82.27 meV / A
2025-04-29 19:45:27.753 INFO: Epoch 44: head: validation, loss=0.08274820, MAE_E=  834.13 meV, MAE_F=   76.27 meV / A
2025-04-29 19:45:30.099 INFO: Epoch 45: head: train, loss=0.07619799, MAE_E=  709.84 meV, MAE_F=   73.57 meV / A
2025-04-29 19:45:30.760 INFO: Epoch 45: head: validation, loss=0.06743287, MAE_E=  711.24 meV, MAE_F=   68.49 meV / A
2025-04-29 19:45:30.760 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:45:30.760 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5039], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:45:30.780 INFO: 
2025-04-29 19:45:30.780 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:45:30.780 INFO: eveluation
2025-04-29 19:45:30.781 INFO: The scale is [0.50390049] and shift is 0.0
2025-04-29 19:45:30.909 INFO: Energy Mean: -23374.25177951389, Variance: 0.01433678897810571
2025-04-29 19:45:31.196 INFO: Energy RMSE: 0.5671133399009705
2025-04-29 19:45:31.196 INFO: Energy R2: -21.43302237521424
2025-04-29 19:45:31.196 INFO: Energy MAE: 0.5658203363418579
90
(90, 4, 3)
torch.Size([90, 4, 3])
2025-04-29 19:45:31.197 INFO: Forces RMSE: 0.2189864665104921
2025-04-29 19:45:31.197 INFO: Forces R2: 0.9468270930070647
2025-04-29 19:45:31.685 INFO: Energy Mean: -23374.237494574652, Variance: 0.020091338658038475
2025-04-29 19:45:31.812 INFO: Loading checkpoint: results/latent_charge_embed/bi4-6_logs//sample_0//checkpoints/bi4-6_run-123_epoch-25.pt
2025-04-29 19:45:31.854 INFO: Loaded Stage one model from epoch 25 for evaluation
2025-04-29 19:45:31.855 INFO: Saving model to results/latent_charge_embed/bi4-6_logs/sample_0/checkpoints/bi4-6_run-123.model
2025-04-29 19:45:32.020 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi4-6_logs/sample_0/bi4-6_compiled.model
2025-04-29 19:45:32.110 INFO: Done
Loading saved bootstrap sample 1
Training model 1
Using latent charge and penalty 1
2025-04-29 19:45:32.509 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:45:32.509 INFO: MACE version: 0.3.10
2025-04-29 19:45:32.509 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:45:32.515 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:45:32.515 INFO: Using heads: ['default']
2025-04-29 19:45:32.515 INFO: =============    Processing head default     ===========
2025-04-29 19:45:32.515 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:45:32.519 INFO: Atomic Numbers used: [83]
2025-04-29 19:45:32.519 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5843.555805121528}}
2025-04-29 19:45:32.523 INFO: Atomic Energies used (z: eV) for head default: {83: -5843.555805121528}
2025-04-29 19:45:32.640 INFO: Computing average number of neighbors
2025-04-29 19:45:33.190 INFO: Average number of neighbors: 3.0
2025-04-29 19:45:33.190 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:45:33.190 INFO: ===========MODEL DETAILS===========
2025-04-29 19:45:33.192 INFO: Building model
2025-04-29 19:45:33.192 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:45:33.192 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:45:33.192 INFO: 8 radial and 5 basis functions
2025-04-29 19:45:33.192 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:45:33.192 INFO: Distance transform for radial basis functions: None
2025-04-29 19:45:33.192 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:45:33.749 INFO: Mean: -8.088699517181588e-05, Std: [0.55112707]
0.0 [0.55112707]
2025-04-29 19:45:33.750 INFO: Scale: [0.55112707], Shift: 0.0
2025-04-29 19:45:35.097 INFO: Total number of parameters: 509618
2025-04-29 19:45:35.097 INFO: 
2025-04-29 19:45:35.097 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:45:35.097 INFO: Using ADAM as parameter optimizer
2025-04-29 19:45:35.097 INFO: Batch size: 32
2025-04-29 19:45:35.098 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:45:35.098 INFO: Number of gradient updates: 2250
2025-04-29 19:45:35.098 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:45:35.098 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:45:35.099 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:45:35.099 INFO: 
2025-04-29 19:45:35.099 INFO: ===========TRAINING===========
2025-04-29 19:45:35.099 INFO: Started training, reporting errors on validation set
2025-04-29 19:45:35.099 INFO: Loss metrics on validation set
2025-04-29 19:45:36.036 INFO: Initial: head: validation, loss=16.98793155, MAE_E=17497.97 meV, MAE_F=  369.92 meV / A
2025-04-29 19:45:38.433 INFO: Epoch 0: head: train, loss=1.08847452, MAE_E= 3034.61 meV, MAE_F=  118.94 meV / A
2025-04-29 19:45:39.200 INFO: Epoch 0: head: validation, loss=1.05868673, MAE_E= 3039.79 meV, MAE_F=  112.30 meV / A
2025-04-29 19:45:41.755 INFO: Epoch 1: head: train, loss=0.98114498, MAE_E= 7203.15 meV, MAE_F=  281.52 meV / A
2025-04-29 19:45:42.455 INFO: Epoch 1: head: validation, loss=0.95603605, MAE_E= 7197.00 meV, MAE_F=  278.31 meV / A
2025-04-29 19:45:44.991 INFO: Epoch 2: head: train, loss=0.56294642, MAE_E=  260.43 meV, MAE_F=  107.15 meV / A
2025-04-29 19:45:45.654 INFO: Epoch 2: head: validation, loss=0.53903275, MAE_E=  253.33 meV, MAE_F=   98.31 meV / A
2025-04-29 19:45:48.119 INFO: Epoch 3: head: train, loss=0.43423861, MAE_E=  928.22 meV, MAE_F=   94.09 meV / A
2025-04-29 19:45:48.791 INFO: Epoch 3: head: validation, loss=0.41456073, MAE_E=  924.50 meV, MAE_F=   88.44 meV / A
2025-04-29 19:45:51.270 INFO: Epoch 4: head: train, loss=0.46224557, MAE_E= 3755.97 meV, MAE_F=  126.08 meV / A
2025-04-29 19:45:51.949 INFO: Epoch 4: head: validation, loss=0.46516178, MAE_E= 3752.50 meV, MAE_F=  124.56 meV / A
2025-04-29 19:45:54.377 INFO: Epoch 5: head: train, loss=0.15499003, MAE_E= 2168.22 meV, MAE_F=  107.75 meV / A
2025-04-29 19:45:55.051 INFO: Epoch 5: head: validation, loss=0.12396735, MAE_E= 2173.94 meV, MAE_F=   97.24 meV / A
2025-04-29 19:45:57.503 INFO: Epoch 6: head: train, loss=0.43281690, MAE_E= 9033.85 meV, MAE_F=  164.70 meV / A
2025-04-29 19:45:58.189 INFO: Epoch 6: head: validation, loss=0.43796514, MAE_E= 9032.99 meV, MAE_F=  163.78 meV / A
2025-04-29 19:46:00.509 INFO: Epoch 7: head: train, loss=0.68526319, MAE_E=11936.24 meV, MAE_F=  178.35 meV / A
2025-04-29 19:46:01.174 INFO: Epoch 7: head: validation, loss=0.71622632, MAE_E=11940.37 meV, MAE_F=  173.39 meV / A
2025-04-29 19:46:03.642 INFO: Epoch 8: head: train, loss=0.20577227, MAE_E= 7180.17 meV, MAE_F=  108.03 meV / A
2025-04-29 19:46:04.367 INFO: Epoch 8: head: validation, loss=0.21481857, MAE_E= 7183.93 meV, MAE_F=  104.93 meV / A
2025-04-29 19:46:06.757 INFO: Epoch 9: head: train, loss=0.43442256, MAE_E= 6876.56 meV, MAE_F=  215.25 meV / A
2025-04-29 19:46:07.435 INFO: Epoch 9: head: validation, loss=0.47058635, MAE_E= 6872.55 meV, MAE_F=  215.24 meV / A
2025-04-29 19:46:09.850 INFO: Epoch 10: head: train, loss=0.15821293, MAE_E=   74.48 meV, MAE_F=  150.51 meV / A
2025-04-29 19:46:10.508 INFO: Epoch 10: head: validation, loss=0.16274125, MAE_E=   79.01 meV, MAE_F=  145.94 meV / A
2025-04-29 19:46:12.904 INFO: Epoch 11: head: train, loss=0.25001186, MAE_E= 5699.62 meV, MAE_F=  104.20 meV / A
2025-04-29 19:46:13.584 INFO: Epoch 11: head: validation, loss=0.22888246, MAE_E= 5705.28 meV, MAE_F=   94.14 meV / A
2025-04-29 19:46:16.034 INFO: Epoch 12: head: train, loss=0.15268720, MAE_E= 4457.17 meV, MAE_F=   87.05 meV / A
2025-04-29 19:46:16.733 INFO: Epoch 12: head: validation, loss=0.13084927, MAE_E= 4460.62 meV, MAE_F=   79.24 meV / A
2025-04-29 19:46:19.201 INFO: Epoch 13: head: train, loss=0.12618919, MAE_E= 2166.14 meV, MAE_F=   87.44 meV / A
2025-04-29 19:46:19.914 INFO: Epoch 13: head: validation, loss=0.09710029, MAE_E= 2172.03 meV, MAE_F=   77.83 meV / A
2025-04-29 19:46:22.424 INFO: Epoch 14: head: train, loss=0.08717144, MAE_E=  840.18 meV, MAE_F=   75.68 meV / A
2025-04-29 19:46:23.064 INFO: Epoch 14: head: validation, loss=0.07073980, MAE_E=  844.98 meV, MAE_F=   69.31 meV / A
2025-04-29 19:46:25.523 INFO: Epoch 15: head: train, loss=0.11331540, MAE_E= 1822.61 meV, MAE_F=   82.68 meV / A
2025-04-29 19:46:26.190 INFO: Epoch 15: head: validation, loss=0.08964049, MAE_E= 1826.80 meV, MAE_F=   75.42 meV / A
2025-04-29 19:46:28.582 INFO: Epoch 16: head: train, loss=0.05516555, MAE_E= 1930.08 meV, MAE_F=   68.57 meV / A
2025-04-29 19:46:29.267 INFO: Epoch 16: head: validation, loss=0.04784224, MAE_E= 1932.30 meV, MAE_F=   63.36 meV / A
2025-04-29 19:46:31.795 INFO: Epoch 17: head: train, loss=0.03863969, MAE_E= 1862.19 meV, MAE_F=   66.73 meV / A
2025-04-29 19:46:32.504 INFO: Epoch 17: head: validation, loss=0.03718644, MAE_E= 1863.14 meV, MAE_F=   64.35 meV / A
2025-04-29 19:46:34.944 INFO: Epoch 18: head: train, loss=0.03578745, MAE_E= 1013.78 meV, MAE_F=   60.73 meV / A
2025-04-29 19:46:35.592 INFO: Epoch 18: head: validation, loss=0.03217085, MAE_E= 1015.47 meV, MAE_F=   57.41 meV / A
2025-04-29 19:46:38.027 INFO: Epoch 19: head: train, loss=0.06791990, MAE_E= 1471.27 meV, MAE_F=   75.24 meV / A
2025-04-29 19:46:38.697 INFO: Epoch 19: head: validation, loss=0.05605421, MAE_E= 1474.44 meV, MAE_F=   71.12 meV / A
2025-04-29 19:46:41.217 INFO: Epoch 20: head: train, loss=0.13077516, MAE_E= 1810.04 meV, MAE_F=   99.71 meV / A
2025-04-29 19:46:41.935 INFO: Epoch 20: head: validation, loss=0.11185254, MAE_E= 1813.22 meV, MAE_F=   97.32 meV / A
2025-04-29 19:46:44.392 INFO: Epoch 21: head: train, loss=0.07797143, MAE_E= 1208.60 meV, MAE_F=   79.00 meV / A
2025-04-29 19:46:45.053 INFO: Epoch 21: head: validation, loss=0.06489518, MAE_E= 1211.65 meV, MAE_F=   75.30 meV / A
2025-04-29 19:46:47.467 INFO: Epoch 22: head: train, loss=0.09519889, MAE_E= 1112.33 meV, MAE_F=   87.78 meV / A
2025-04-29 19:46:48.140 INFO: Epoch 22: head: validation, loss=0.08137764, MAE_E= 1114.93 meV, MAE_F=   85.85 meV / A
2025-04-29 19:46:50.650 INFO: Epoch 23: head: train, loss=0.11585266, MAE_E=  813.34 meV, MAE_F=   91.08 meV / A
2025-04-29 19:46:51.316 INFO: Epoch 23: head: validation, loss=0.10658451, MAE_E=  815.67 meV, MAE_F=   90.28 meV / A
2025-04-29 19:46:53.691 INFO: Epoch 24: head: train, loss=0.06013158, MAE_E=  354.36 meV, MAE_F=   67.11 meV / A
2025-04-29 19:46:54.329 INFO: Epoch 24: head: validation, loss=0.05521865, MAE_E=  356.64 meV, MAE_F=   65.99 meV / A
2025-04-29 19:46:56.811 INFO: Epoch 25: head: train, loss=0.03882000, MAE_E=  405.16 meV, MAE_F=   55.65 meV / A
2025-04-29 19:46:57.469 INFO: Epoch 25: head: validation, loss=0.03482189, MAE_E=  407.19 meV, MAE_F=   54.28 meV / A
2025-04-29 19:46:59.904 INFO: Epoch 26: head: train, loss=0.03260412, MAE_E=  263.28 meV, MAE_F=   48.47 meV / A
2025-04-29 19:47:00.608 INFO: Epoch 26: head: validation, loss=0.03018602, MAE_E=  265.90 meV, MAE_F=   46.85 meV / A
2025-04-29 19:47:03.106 INFO: Epoch 27: head: train, loss=0.02006502, MAE_E=  183.34 meV, MAE_F=   44.25 meV / A
2025-04-29 19:47:03.790 INFO: Epoch 27: head: validation, loss=0.01860221, MAE_E=  186.00 meV, MAE_F=   42.75 meV / A
2025-04-29 19:47:06.196 INFO: Epoch 28: head: train, loss=0.01948326, MAE_E=  174.43 meV, MAE_F=   43.79 meV / A
2025-04-29 19:47:06.833 INFO: Epoch 28: head: validation, loss=0.01837831, MAE_E=  177.02 meV, MAE_F=   42.53 meV / A
2025-04-29 19:47:09.283 INFO: Epoch 29: head: train, loss=0.01569497, MAE_E=  132.69 meV, MAE_F=   40.44 meV / A
2025-04-29 19:47:09.983 INFO: Epoch 29: head: validation, loss=0.01482773, MAE_E=  135.29 meV, MAE_F=   38.97 meV / A
2025-04-29 19:47:12.505 INFO: Epoch 30: head: train, loss=0.01535246, MAE_E=  111.45 meV, MAE_F=   39.76 meV / A
2025-04-29 19:47:13.209 INFO: Epoch 30: head: validation, loss=0.01440131, MAE_E=  113.74 meV, MAE_F=   38.22 meV / A
2025-04-29 19:47:15.681 INFO: Epoch 31: head: train, loss=0.01798620, MAE_E=   54.84 meV, MAE_F=   45.61 meV / A
2025-04-29 19:47:16.375 INFO: Epoch 31: head: validation, loss=0.01633546, MAE_E=   55.98 meV, MAE_F=   44.45 meV / A
2025-04-29 19:47:18.828 INFO: Epoch 32: head: train, loss=0.01892870, MAE_E=   75.04 meV, MAE_F=   47.35 meV / A
2025-04-29 19:47:19.500 INFO: Epoch 32: head: validation, loss=0.01672561, MAE_E=   72.88 meV, MAE_F=   45.79 meV / A
2025-04-29 19:47:22.038 INFO: Epoch 33: head: train, loss=0.01627969, MAE_E=   30.65 meV, MAE_F=   45.19 meV / A
2025-04-29 19:47:22.720 INFO: Epoch 33: head: validation, loss=0.01490193, MAE_E=   30.43 meV, MAE_F=   44.17 meV / A
2025-04-29 19:47:25.124 INFO: Epoch 34: head: train, loss=0.01587481, MAE_E=   41.42 meV, MAE_F=   44.70 meV / A
2025-04-29 19:47:25.739 INFO: Epoch 34: head: validation, loss=0.01468272, MAE_E=   39.89 meV, MAE_F=   43.70 meV / A
2025-04-29 19:47:28.174 INFO: Epoch 35: head: train, loss=0.01563288, MAE_E=   41.17 meV, MAE_F=   44.41 meV / A
2025-04-29 19:47:28.867 INFO: Epoch 35: head: validation, loss=0.01446072, MAE_E=   42.79 meV, MAE_F=   43.51 meV / A
2025-04-29 19:47:31.385 INFO: Epoch 36: head: train, loss=0.02312238, MAE_E=   42.33 meV, MAE_F=   47.98 meV / A
2025-04-29 19:47:32.074 INFO: Epoch 36: head: validation, loss=0.02104995, MAE_E=   45.00 meV, MAE_F=   46.55 meV / A
2025-04-29 19:47:34.509 INFO: Epoch 37: head: train, loss=0.02056100, MAE_E=   98.36 meV, MAE_F=   50.94 meV / A
2025-04-29 19:47:35.177 INFO: Epoch 37: head: validation, loss=0.01884658, MAE_E=  100.31 meV, MAE_F=   49.59 meV / A
2025-04-29 19:47:37.547 INFO: Epoch 38: head: train, loss=0.02135096, MAE_E=   67.06 meV, MAE_F=   50.57 meV / A
2025-04-29 19:47:38.196 INFO: Epoch 38: head: validation, loss=0.01843554, MAE_E=   69.05 meV, MAE_F=   48.09 meV / A
2025-04-29 19:47:40.573 INFO: Epoch 39: head: train, loss=0.01858674, MAE_E=   69.43 meV, MAE_F=   48.93 meV / A
2025-04-29 19:47:41.251 INFO: Epoch 39: head: validation, loss=0.01695826, MAE_E=   71.56 meV, MAE_F=   46.77 meV / A
2025-04-29 19:47:43.692 INFO: Epoch 40: head: train, loss=0.01628759, MAE_E=  160.09 meV, MAE_F=   45.47 meV / A
2025-04-29 19:47:44.417 INFO: Epoch 40: head: validation, loss=0.01462646, MAE_E=  162.61 meV, MAE_F=   42.87 meV / A
2025-04-29 19:47:46.838 INFO: Epoch 41: head: train, loss=0.01439359, MAE_E=  154.91 meV, MAE_F=   43.19 meV / A
2025-04-29 19:47:47.557 INFO: Epoch 41: head: validation, loss=0.01317597, MAE_E=  158.01 meV, MAE_F=   41.10 meV / A
2025-04-29 19:47:50.017 INFO: Epoch 42: head: train, loss=0.01292638, MAE_E=   67.00 meV, MAE_F=   41.00 meV / A
2025-04-29 19:47:50.674 INFO: Epoch 42: head: validation, loss=0.01185559, MAE_E=   68.21 meV, MAE_F=   39.13 meV / A
2025-04-29 19:47:53.183 INFO: Epoch 43: head: train, loss=0.01241931, MAE_E=   61.85 meV, MAE_F=   39.83 meV / A
2025-04-29 19:47:53.823 INFO: Epoch 43: head: validation, loss=0.01133773, MAE_E=   63.56 meV, MAE_F=   38.21 meV / A
2025-04-29 19:47:56.242 INFO: Epoch 44: head: train, loss=0.01130968, MAE_E=   40.95 meV, MAE_F=   38.38 meV / A
2025-04-29 19:47:56.949 INFO: Epoch 44: head: validation, loss=0.01069736, MAE_E=   43.25 meV, MAE_F=   37.14 meV / A
2025-04-29 19:47:59.467 INFO: Epoch 45: head: train, loss=0.01056210, MAE_E=   37.40 meV, MAE_F=   37.24 meV / A
2025-04-29 19:48:00.181 INFO: Epoch 45: head: validation, loss=0.01014656, MAE_E=   39.45 meV, MAE_F=   36.26 meV / A
2025-04-29 19:48:02.566 INFO: Epoch 46: head: train, loss=0.01072832, MAE_E=   34.88 meV, MAE_F=   36.60 meV / A
2025-04-29 19:48:03.232 INFO: Epoch 46: head: validation, loss=0.01040028, MAE_E=   37.06 meV, MAE_F=   35.69 meV / A
2025-04-29 19:48:05.672 INFO: Epoch 47: head: train, loss=0.00992768, MAE_E=   37.86 meV, MAE_F=   36.29 meV / A
2025-04-29 19:48:06.364 INFO: Epoch 47: head: validation, loss=0.00956975, MAE_E=   39.28 meV, MAE_F=   35.24 meV / A
2025-04-29 19:48:08.893 INFO: Epoch 48: head: train, loss=0.01123676, MAE_E=   57.66 meV, MAE_F=   37.99 meV / A
2025-04-29 19:48:09.620 INFO: Epoch 48: head: validation, loss=0.01071124, MAE_E=   55.74 meV, MAE_F=   36.82 meV / A
2025-04-29 19:48:12.054 INFO: Epoch 49: head: train, loss=0.01112840, MAE_E=   39.55 meV, MAE_F=   38.27 meV / A
2025-04-29 19:48:12.776 INFO: Epoch 49: head: validation, loss=0.01038674, MAE_E=   40.95 meV, MAE_F=   36.89 meV / A
2025-04-29 19:48:15.219 INFO: Epoch 50: head: train, loss=0.01201974, MAE_E=   60.62 meV, MAE_F=   39.04 meV / A
2025-04-29 19:48:15.899 INFO: Epoch 50: head: validation, loss=0.01076327, MAE_E=   58.79 meV, MAE_F=   36.99 meV / A
2025-04-29 19:48:18.297 INFO: Epoch 51: head: train, loss=0.01292024, MAE_E=  195.97 meV, MAE_F=   41.51 meV / A
2025-04-29 19:48:19.007 INFO: Epoch 51: head: validation, loss=0.01228278, MAE_E=  194.64 meV, MAE_F=   39.63 meV / A
2025-04-29 19:48:21.452 INFO: Epoch 52: head: train, loss=0.01454883, MAE_E=   27.32 meV, MAE_F=   44.66 meV / A
2025-04-29 19:48:22.103 INFO: Epoch 52: head: validation, loss=0.01443064, MAE_E=   28.32 meV, MAE_F=   43.34 meV / A
2025-04-29 19:48:24.476 INFO: Epoch 53: head: train, loss=0.01532939, MAE_E=  121.86 meV, MAE_F=   45.93 meV / A
2025-04-29 19:48:25.184 INFO: Epoch 53: head: validation, loss=0.01556687, MAE_E=  120.82 meV, MAE_F=   45.10 meV / A
2025-04-29 19:48:27.613 INFO: Epoch 54: head: train, loss=0.01624112, MAE_E=  222.40 meV, MAE_F=   46.55 meV / A
2025-04-29 19:48:28.318 INFO: Epoch 54: head: validation, loss=0.01588254, MAE_E=  220.90 meV, MAE_F=   44.82 meV / A
2025-04-29 19:48:30.857 INFO: Epoch 55: head: train, loss=0.01694947, MAE_E=  141.69 meV, MAE_F=   45.58 meV / A
2025-04-29 19:48:31.573 INFO: Epoch 55: head: validation, loss=0.01681552, MAE_E=  139.78 meV, MAE_F=   44.21 meV / A
2025-04-29 19:48:33.927 INFO: Epoch 56: head: train, loss=0.01577090, MAE_E=  133.68 meV, MAE_F=   44.75 meV / A
2025-04-29 19:48:34.604 INFO: Epoch 56: head: validation, loss=0.01589640, MAE_E=  132.18 meV, MAE_F=   43.83 meV / A
2025-04-29 19:48:37.055 INFO: Epoch 57: head: train, loss=0.01482769, MAE_E=  107.54 meV, MAE_F=   43.86 meV / A
2025-04-29 19:48:37.741 INFO: Epoch 57: head: validation, loss=0.01492234, MAE_E=  105.56 meV, MAE_F=   42.85 meV / A
2025-04-29 19:48:40.224 INFO: Epoch 58: head: train, loss=0.01400625, MAE_E=   93.29 meV, MAE_F=   42.58 meV / A
2025-04-29 19:48:40.928 INFO: Epoch 58: head: validation, loss=0.01412741, MAE_E=   90.93 meV, MAE_F=   41.80 meV / A
2025-04-29 19:48:43.429 INFO: Epoch 59: head: train, loss=0.01340657, MAE_E=   69.68 meV, MAE_F=   41.36 meV / A
2025-04-29 19:48:44.134 INFO: Epoch 59: head: validation, loss=0.01361820, MAE_E=   67.18 meV, MAE_F=   40.96 meV / A
2025-04-29 19:48:46.565 INFO: Epoch 60: head: train, loss=0.01427305, MAE_E=   54.75 meV, MAE_F=   42.78 meV / A
2025-04-29 19:48:47.265 INFO: Epoch 60: head: validation, loss=0.01434451, MAE_E=   56.09 meV, MAE_F=   42.29 meV / A
2025-04-29 19:48:49.734 INFO: Epoch 61: head: train, loss=0.02543967, MAE_E=  169.28 meV, MAE_F=   57.40 meV / A
2025-04-29 19:48:50.453 INFO: Epoch 61: head: validation, loss=0.02513909, MAE_E=  171.23 meV, MAE_F=   56.89 meV / A
2025-04-29 19:48:52.922 INFO: Epoch 62: head: train, loss=0.03020242, MAE_E=   66.50 meV, MAE_F=   64.46 meV / A
2025-04-29 19:48:53.636 INFO: Epoch 62: head: validation, loss=0.03040973, MAE_E=   66.43 meV, MAE_F=   63.63 meV / A
2025-04-29 19:48:56.052 INFO: Epoch 63: head: train, loss=0.02716826, MAE_E=   68.78 meV, MAE_F=   62.45 meV / A
2025-04-29 19:48:56.701 INFO: Epoch 63: head: validation, loss=0.02823759, MAE_E=   68.09 meV, MAE_F=   62.24 meV / A
2025-04-29 19:48:59.106 INFO: Epoch 64: head: train, loss=0.02639862, MAE_E=   64.59 meV, MAE_F=   60.86 meV / A
2025-04-29 19:48:59.802 INFO: Epoch 64: head: validation, loss=0.02753708, MAE_E=   63.72 meV, MAE_F=   61.17 meV / A
2025-04-29 19:49:02.225 INFO: Epoch 65: head: train, loss=0.02387796, MAE_E=   42.94 meV, MAE_F=   57.33 meV / A
2025-04-29 19:49:02.918 INFO: Epoch 65: head: validation, loss=0.02428545, MAE_E=   41.65 meV, MAE_F=   56.86 meV / A
2025-04-29 19:49:05.397 INFO: Epoch 66: head: train, loss=0.02432942, MAE_E=   43.42 meV, MAE_F=   54.41 meV / A
2025-04-29 19:49:05.997 INFO: Epoch 66: head: validation, loss=0.02357659, MAE_E=   41.94 meV, MAE_F=   54.09 meV / A
2025-04-29 19:49:08.482 INFO: Epoch 67: head: train, loss=0.02093313, MAE_E=   30.84 meV, MAE_F=   51.01 meV / A
2025-04-29 19:49:09.122 INFO: Epoch 67: head: validation, loss=0.02024695, MAE_E=   30.25 meV, MAE_F=   50.59 meV / A
2025-04-29 19:49:09.122 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:49:09.122 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5511], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:49:09.126 INFO: 
2025-04-29 19:49:09.126 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:49:09.126 INFO: eveluation
2025-04-29 19:49:09.127 INFO: The scale is [0.55112707] and shift is 0.0
2025-04-29 19:49:09.258 INFO: Energy Mean: -23374.228059895835, Variance: 0.017041104634602865
2025-04-29 19:49:09.513 INFO: Energy RMSE: 1.6346526145935059
2025-04-29 19:49:09.513 INFO: Energy R2: -155.80258753821974
2025-04-29 19:49:09.513 INFO: Energy MAE: 1.6342014074325562
90
(90, 4, 3)
torch.Size([90, 4, 3])
2025-04-29 19:49:09.514 INFO: Forces RMSE: 0.1460392274863129
2025-04-29 19:49:09.514 INFO: Forces R2: 0.9789624791158589
2025-04-29 19:49:11.771 INFO: Energy Mean: -23374.22322048611, Variance: 0.024383989498939048
2025-04-29 19:49:11.892 INFO: Loading checkpoint: results/latent_charge_embed/bi4-6_logs//sample_1//checkpoints/bi4-6_run-123_epoch-47.pt
2025-04-29 19:49:11.942 INFO: Loaded Stage one model from epoch 47 for evaluation
2025-04-29 19:49:11.943 INFO: Saving model to results/latent_charge_embed/bi4-6_logs/sample_1/checkpoints/bi4-6_run-123.model
2025-04-29 19:49:12.105 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi4-6_logs/sample_1/bi4-6_compiled.model
2025-04-29 19:49:12.195 INFO: Done
Loading saved bootstrap sample 2
Training model 2
Using latent charge and penalty 1
2025-04-29 19:49:12.813 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:49:12.813 INFO: MACE version: 0.3.10
2025-04-29 19:49:12.813 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:49:12.819 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:49:12.819 INFO: Using heads: ['default']
2025-04-29 19:49:12.819 INFO: =============    Processing head default     ===========
2025-04-29 19:49:12.819 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:49:12.823 INFO: Atomic Numbers used: [83]
2025-04-29 19:49:12.823 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5843.558938259549}}
2025-04-29 19:49:12.827 INFO: Atomic Energies used (z: eV) for head default: {83: -5843.558938259549}
2025-04-29 19:49:12.947 INFO: Computing average number of neighbors
2025-04-29 19:49:13.532 INFO: Average number of neighbors: 3.0
2025-04-29 19:49:13.532 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:49:13.532 INFO: ===========MODEL DETAILS===========
2025-04-29 19:49:13.534 INFO: Building model
2025-04-29 19:49:13.534 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:49:13.534 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:49:13.534 INFO: 8 radial and 5 basis functions
2025-04-29 19:49:13.534 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:49:13.534 INFO: Distance transform for radial basis functions: None
2025-04-29 19:49:13.534 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:49:14.140 INFO: Mean: 2.6849303966710895e-05, Std: [0.50596635]
0.0 [0.50596635]
2025-04-29 19:49:14.140 INFO: Scale: [0.50596635], Shift: 0.0
2025-04-29 19:49:15.298 INFO: Total number of parameters: 509618
2025-04-29 19:49:15.298 INFO: 
2025-04-29 19:49:15.299 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:49:15.299 INFO: Using ADAM as parameter optimizer
2025-04-29 19:49:15.299 INFO: Batch size: 32
2025-04-29 19:49:15.299 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:49:15.299 INFO: Number of gradient updates: 2250
2025-04-29 19:49:15.299 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:49:15.299 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:49:15.300 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:49:15.300 INFO: 
2025-04-29 19:49:15.300 INFO: ===========TRAINING===========
2025-04-29 19:49:15.300 INFO: Started training, reporting errors on validation set
2025-04-29 19:49:15.300 INFO: Loss metrics on validation set
2025-04-29 19:49:16.245 INFO: Initial: head: validation, loss=16.70843963, MAE_E=16095.91 meV, MAE_F=  338.85 meV / A
2025-04-29 19:49:18.679 INFO: Epoch 0: head: train, loss=0.64732419, MAE_E= 2684.69 meV, MAE_F=   81.67 meV / A
2025-04-29 19:49:19.496 INFO: Epoch 0: head: validation, loss=0.64572752, MAE_E= 2678.83 meV, MAE_F=   82.67 meV / A
2025-04-29 19:49:22.102 INFO: Epoch 1: head: train, loss=0.05269667, MAE_E= 1687.94 meV, MAE_F=   75.30 meV / A
2025-04-29 19:49:22.792 INFO: Epoch 1: head: validation, loss=0.05330186, MAE_E= 1680.63 meV, MAE_F=   75.63 meV / A
2025-04-29 19:49:25.300 INFO: Epoch 2: head: train, loss=0.58703366, MAE_E= 5425.71 meV, MAE_F=  114.57 meV / A
2025-04-29 19:49:25.984 INFO: Epoch 2: head: validation, loss=0.59732249, MAE_E= 5420.75 meV, MAE_F=  115.16 meV / A
2025-04-29 19:49:28.413 INFO: Epoch 3: head: train, loss=0.19041786, MAE_E= 5447.41 meV, MAE_F=  129.25 meV / A
2025-04-29 19:49:29.130 INFO: Epoch 3: head: validation, loss=0.21219853, MAE_E= 5452.22 meV, MAE_F=  132.53 meV / A
2025-04-29 19:49:31.608 INFO: Epoch 4: head: train, loss=0.09441147, MAE_E= 3927.27 meV, MAE_F=   76.32 meV / A
2025-04-29 19:49:32.310 INFO: Epoch 4: head: validation, loss=0.10857841, MAE_E= 3936.07 meV, MAE_F=   83.23 meV / A
2025-04-29 19:49:34.726 INFO: Epoch 5: head: train, loss=0.13218490, MAE_E= 1902.57 meV, MAE_F=   71.23 meV / A
2025-04-29 19:49:35.412 INFO: Epoch 5: head: validation, loss=0.14013367, MAE_E= 1893.64 meV, MAE_F=   75.80 meV / A
2025-04-29 19:49:37.890 INFO: Epoch 6: head: train, loss=0.23631355, MAE_E=  662.32 meV, MAE_F=  193.37 meV / A
2025-04-29 19:49:38.545 INFO: Epoch 6: head: validation, loss=0.26442754, MAE_E=  669.23 meV, MAE_F=  201.54 meV / A
2025-04-29 19:49:41.038 INFO: Epoch 7: head: train, loss=0.17114467, MAE_E=  938.18 meV, MAE_F=  129.52 meV / A
2025-04-29 19:49:41.715 INFO: Epoch 7: head: validation, loss=0.16976565, MAE_E=  941.95 meV, MAE_F=  130.46 meV / A
2025-04-29 19:49:44.231 INFO: Epoch 8: head: train, loss=0.07907351, MAE_E=  349.11 meV, MAE_F=   84.75 meV / A
2025-04-29 19:49:44.938 INFO: Epoch 8: head: validation, loss=0.08092274, MAE_E=  355.01 meV, MAE_F=   87.95 meV / A
2025-04-29 19:49:47.376 INFO: Epoch 9: head: train, loss=0.04636371, MAE_E=  324.81 meV, MAE_F=   77.74 meV / A
2025-04-29 19:49:48.084 INFO: Epoch 9: head: validation, loss=0.05576065, MAE_E=  333.51 meV, MAE_F=   83.04 meV / A
2025-04-29 19:49:50.547 INFO: Epoch 10: head: train, loss=0.07423878, MAE_E=   52.55 meV, MAE_F=   74.44 meV / A
2025-04-29 19:49:51.246 INFO: Epoch 10: head: validation, loss=0.07395403, MAE_E=   56.75 meV, MAE_F=   76.77 meV / A
2025-04-29 19:49:53.700 INFO: Epoch 11: head: train, loss=0.11805014, MAE_E=  794.08 meV, MAE_F=   87.66 meV / A
2025-04-29 19:49:54.425 INFO: Epoch 11: head: validation, loss=0.11007465, MAE_E=  789.71 meV, MAE_F=   89.15 meV / A
2025-04-29 19:49:56.901 INFO: Epoch 12: head: train, loss=0.36357834, MAE_E= 1673.54 meV, MAE_F=  160.67 meV / A
2025-04-29 19:49:57.596 INFO: Epoch 12: head: validation, loss=0.33962906, MAE_E= 1672.13 meV, MAE_F=  158.25 meV / A
2025-04-29 19:50:00.090 INFO: Epoch 13: head: train, loss=0.29406372, MAE_E=   48.65 meV, MAE_F=  145.23 meV / A
2025-04-29 19:50:00.741 INFO: Epoch 13: head: validation, loss=0.27786703, MAE_E=   51.98 meV, MAE_F=  143.61 meV / A
2025-04-29 19:50:03.131 INFO: Epoch 14: head: train, loss=0.18938052, MAE_E= 1495.75 meV, MAE_F=  111.92 meV / A
2025-04-29 19:50:03.768 INFO: Epoch 14: head: validation, loss=0.17423678, MAE_E= 1492.63 meV, MAE_F=  111.82 meV / A
2025-04-29 19:50:06.193 INFO: Epoch 15: head: train, loss=0.12199679, MAE_E= 1570.01 meV, MAE_F=   90.04 meV / A
2025-04-29 19:50:06.868 INFO: Epoch 15: head: validation, loss=0.11345277, MAE_E= 1564.89 meV, MAE_F=   91.59 meV / A
2025-04-29 19:50:09.278 INFO: Epoch 16: head: train, loss=0.07943045, MAE_E=  580.90 meV, MAE_F=   75.27 meV / A
2025-04-29 19:50:10.033 INFO: Epoch 16: head: validation, loss=0.07609122, MAE_E=  574.29 meV, MAE_F=   76.53 meV / A
2025-04-29 19:50:12.456 INFO: Epoch 17: head: train, loss=0.06303333, MAE_E=  620.15 meV, MAE_F=   67.56 meV / A
2025-04-29 19:50:13.129 INFO: Epoch 17: head: validation, loss=0.06326752, MAE_E=  613.26 meV, MAE_F=   68.77 meV / A
2025-04-29 19:50:15.520 INFO: Epoch 18: head: train, loss=0.04554745, MAE_E=  337.40 meV, MAE_F=   61.14 meV / A
2025-04-29 19:50:16.132 INFO: Epoch 18: head: validation, loss=0.04993444, MAE_E=  330.24 meV, MAE_F=   63.96 meV / A
2025-04-29 19:50:18.651 INFO: Epoch 19: head: train, loss=0.02953263, MAE_E=  173.99 meV, MAE_F=   55.83 meV / A
2025-04-29 19:50:19.278 INFO: Epoch 19: head: validation, loss=0.03376233, MAE_E=  167.52 meV, MAE_F=   57.50 meV / A
2025-04-29 19:50:21.865 INFO: Epoch 20: head: train, loss=0.02722859, MAE_E=  144.96 meV, MAE_F=   53.82 meV / A
2025-04-29 19:50:22.561 INFO: Epoch 20: head: validation, loss=0.03247983, MAE_E=  138.55 meV, MAE_F=   55.85 meV / A
2025-04-29 19:50:25.112 INFO: Epoch 21: head: train, loss=0.02830622, MAE_E=  167.79 meV, MAE_F=   55.27 meV / A
2025-04-29 19:50:25.757 INFO: Epoch 21: head: validation, loss=0.03304914, MAE_E=  161.44 meV, MAE_F=   56.54 meV / A
2025-04-29 19:50:28.208 INFO: Epoch 22: head: train, loss=0.02459427, MAE_E=   50.46 meV, MAE_F=   50.67 meV / A
2025-04-29 19:50:28.876 INFO: Epoch 22: head: validation, loss=0.03078888, MAE_E=   51.50 meV, MAE_F=   53.00 meV / A
2025-04-29 19:50:31.509 INFO: Epoch 23: head: train, loss=0.01899848, MAE_E=   37.89 meV, MAE_F=   48.84 meV / A
2025-04-29 19:50:32.134 INFO: Epoch 23: head: validation, loss=0.02465573, MAE_E=   40.14 meV, MAE_F=   51.13 meV / A
2025-04-29 19:50:34.669 INFO: Epoch 24: head: train, loss=0.01644523, MAE_E=   59.13 meV, MAE_F=   45.62 meV / A
2025-04-29 19:50:35.332 INFO: Epoch 24: head: validation, loss=0.02126126, MAE_E=   58.18 meV, MAE_F=   47.32 meV / A
2025-04-29 19:50:37.875 INFO: Epoch 25: head: train, loss=0.01273917, MAE_E=   44.56 meV, MAE_F=   41.42 meV / A
2025-04-29 19:50:38.506 INFO: Epoch 25: head: validation, loss=0.01741944, MAE_E=   44.61 meV, MAE_F=   43.47 meV / A
2025-04-29 19:50:41.127 INFO: Epoch 26: head: train, loss=0.01395309, MAE_E=   35.60 meV, MAE_F=   40.22 meV / A
2025-04-29 19:50:41.732 INFO: Epoch 26: head: validation, loss=0.01815478, MAE_E=   42.50 meV, MAE_F=   42.14 meV / A
2025-04-29 19:50:44.175 INFO: Epoch 27: head: train, loss=0.01851949, MAE_E=   65.26 meV, MAE_F=   38.68 meV / A
2025-04-29 19:50:44.803 INFO: Epoch 27: head: validation, loss=0.02260783, MAE_E=   71.65 meV, MAE_F=   40.69 meV / A
2025-04-29 19:50:47.262 INFO: Epoch 28: head: train, loss=0.01038538, MAE_E=   81.46 meV, MAE_F=   37.22 meV / A
2025-04-29 19:50:47.926 INFO: Epoch 28: head: validation, loss=0.01469257, MAE_E=   87.67 meV, MAE_F=   39.58 meV / A
2025-04-29 19:50:50.450 INFO: Epoch 29: head: train, loss=0.00992515, MAE_E=   38.13 meV, MAE_F=   36.16 meV / A
2025-04-29 19:50:51.155 INFO: Epoch 29: head: validation, loss=0.01426449, MAE_E=   45.26 meV, MAE_F=   38.80 meV / A
2025-04-29 19:50:53.680 INFO: Epoch 30: head: train, loss=0.01290004, MAE_E=  109.12 meV, MAE_F=   39.43 meV / A
2025-04-29 19:50:54.370 INFO: Epoch 30: head: validation, loss=0.01708956, MAE_E=  114.49 meV, MAE_F=   41.48 meV / A
2025-04-29 19:50:56.844 INFO: Epoch 31: head: train, loss=0.01190290, MAE_E=   22.91 meV, MAE_F=   38.70 meV / A
2025-04-29 19:50:57.555 INFO: Epoch 31: head: validation, loss=0.01603826, MAE_E=   29.21 meV, MAE_F=   40.43 meV / A
2025-04-29 19:51:00.029 INFO: Epoch 32: head: train, loss=0.01163953, MAE_E=   22.75 meV, MAE_F=   37.85 meV / A
2025-04-29 19:51:00.740 INFO: Epoch 32: head: validation, loss=0.01563023, MAE_E=   28.84 meV, MAE_F=   39.51 meV / A
2025-04-29 19:51:03.145 INFO: Epoch 33: head: train, loss=0.01051076, MAE_E=   97.26 meV, MAE_F=   36.84 meV / A
2025-04-29 19:51:03.802 INFO: Epoch 33: head: validation, loss=0.01487517, MAE_E=   93.80 meV, MAE_F=   39.10 meV / A
2025-04-29 19:51:06.291 INFO: Epoch 34: head: train, loss=0.01574082, MAE_E=  319.41 meV, MAE_F=   42.89 meV / A
2025-04-29 19:51:07.010 INFO: Epoch 34: head: validation, loss=0.01905179, MAE_E=  324.59 meV, MAE_F=   43.91 meV / A
2025-04-29 19:51:09.444 INFO: Epoch 35: head: train, loss=0.01827756, MAE_E=  277.18 meV, MAE_F=   45.82 meV / A
2025-04-29 19:51:10.121 INFO: Epoch 35: head: validation, loss=0.02219028, MAE_E=  270.98 meV, MAE_F=   47.25 meV / A
2025-04-29 19:51:12.483 INFO: Epoch 36: head: train, loss=0.02090522, MAE_E=   71.22 meV, MAE_F=   49.16 meV / A
2025-04-29 19:51:13.152 INFO: Epoch 36: head: validation, loss=0.02612579, MAE_E=   70.82 meV, MAE_F=   51.46 meV / A
2025-04-29 19:51:15.557 INFO: Epoch 37: head: train, loss=0.02128487, MAE_E=   97.62 meV, MAE_F=   50.50 meV / A
2025-04-29 19:51:16.213 INFO: Epoch 37: head: validation, loss=0.02741247, MAE_E=   94.02 meV, MAE_F=   53.30 meV / A
2025-04-29 19:51:18.635 INFO: Epoch 38: head: train, loss=0.02890419, MAE_E=  210.96 meV, MAE_F=   53.63 meV / A
2025-04-29 19:51:19.312 INFO: Epoch 38: head: validation, loss=0.03518423, MAE_E=  217.64 meV, MAE_F=   56.61 meV / A
2025-04-29 19:51:21.777 INFO: Epoch 39: head: train, loss=0.05001085, MAE_E=  583.58 meV, MAE_F=   64.24 meV / A
2025-04-29 19:51:22.476 INFO: Epoch 39: head: validation, loss=0.05223699, MAE_E=  577.46 meV, MAE_F=   67.23 meV / A
2025-04-29 19:51:24.912 INFO: Epoch 40: head: train, loss=0.04730022, MAE_E=  255.33 meV, MAE_F=   61.99 meV / A
2025-04-29 19:51:25.611 INFO: Epoch 40: head: validation, loss=0.04717418, MAE_E=  248.38 meV, MAE_F=   64.37 meV / A
2025-04-29 19:51:28.054 INFO: Epoch 41: head: train, loss=0.04531584, MAE_E=  361.60 meV, MAE_F=   61.17 meV / A
2025-04-29 19:51:28.714 INFO: Epoch 41: head: validation, loss=0.04442064, MAE_E=  355.06 meV, MAE_F=   63.03 meV / A
2025-04-29 19:51:31.277 INFO: Epoch 42: head: train, loss=0.03765784, MAE_E=  261.55 meV, MAE_F=   58.04 meV / A
2025-04-29 19:51:31.967 INFO: Epoch 42: head: validation, loss=0.03843959, MAE_E=  254.89 meV, MAE_F=   59.99 meV / A
2025-04-29 19:51:34.403 INFO: Epoch 43: head: train, loss=0.03479005, MAE_E=  195.06 meV, MAE_F=   56.61 meV / A
2025-04-29 19:51:35.087 INFO: Epoch 43: head: validation, loss=0.03451861, MAE_E=  188.58 meV, MAE_F=   57.53 meV / A
2025-04-29 19:51:37.442 INFO: Epoch 44: head: train, loss=0.02724555, MAE_E=  155.87 meV, MAE_F=   51.88 meV / A
2025-04-29 19:51:38.155 INFO: Epoch 44: head: validation, loss=0.03001881, MAE_E=  149.14 meV, MAE_F=   53.64 meV / A
2025-04-29 19:51:40.743 INFO: Epoch 45: head: train, loss=0.04324386, MAE_E=  192.22 meV, MAE_F=   58.70 meV / A
2025-04-29 19:51:41.417 INFO: Epoch 45: head: validation, loss=0.04431321, MAE_E=  186.76 meV, MAE_F=   60.91 meV / A
2025-04-29 19:51:43.871 INFO: Epoch 46: head: train, loss=0.06683000, MAE_E=  145.48 meV, MAE_F=   68.95 meV / A
2025-04-29 19:51:44.586 INFO: Epoch 46: head: validation, loss=0.06156355, MAE_E=  140.26 meV, MAE_F=   69.40 meV / A
2025-04-29 19:51:47.059 INFO: Epoch 47: head: train, loss=0.05920596, MAE_E=  239.97 meV, MAE_F=   64.74 meV / A
2025-04-29 19:51:47.788 INFO: Epoch 47: head: validation, loss=0.05348449, MAE_E=  234.88 meV, MAE_F=   64.77 meV / A
2025-04-29 19:51:50.331 INFO: Epoch 48: head: train, loss=0.06208020, MAE_E=  137.96 meV, MAE_F=   67.20 meV / A
2025-04-29 19:51:51.038 INFO: Epoch 48: head: validation, loss=0.05498170, MAE_E=  132.52 meV, MAE_F=   66.60 meV / A
2025-04-29 19:51:53.542 INFO: Epoch 49: head: train, loss=0.05312527, MAE_E=  137.61 meV, MAE_F=   62.18 meV / A
2025-04-29 19:51:54.278 INFO: Epoch 49: head: validation, loss=0.04678656, MAE_E=  132.40 meV, MAE_F=   61.33 meV / A
2025-04-29 19:51:54.278 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:51:54.278 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5060], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:51:54.281 INFO: 
2025-04-29 19:51:54.281 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:51:54.281 INFO: eveluation
2025-04-29 19:51:54.281 INFO: The scale is [0.50596635] and shift is 0.0
2025-04-29 19:51:54.412 INFO: Energy Mean: -23374.235807291665, Variance: 0.01845286051432292
2025-04-29 19:51:54.674 INFO: Energy RMSE: 0.49963054060935974
2025-04-29 19:51:54.674 INFO: Energy R2: -12.528021562044627
2025-04-29 19:51:54.674 INFO: Energy MAE: 0.4986328184604645
90
(90, 4, 3)
torch.Size([90, 4, 3])
2025-04-29 19:51:54.675 INFO: Forces RMSE: 0.2604641995066092
2025-04-29 19:51:54.675 INFO: Forces R2: 0.9250760195522567
2025-04-29 19:51:55.178 INFO: Energy Mean: -23374.235753038196, Variance: 0.01676255108397684
2025-04-29 19:51:55.315 INFO: Loading checkpoint: results/latent_charge_embed/bi4-6_logs//sample_2//checkpoints/bi4-6_run-123_epoch-29.pt
2025-04-29 19:51:55.366 INFO: Loaded Stage one model from epoch 29 for evaluation
2025-04-29 19:51:55.366 INFO: Saving model to results/latent_charge_embed/bi4-6_logs/sample_2/checkpoints/bi4-6_run-123.model
2025-04-29 19:51:55.531 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi4-6_logs/sample_2/bi4-6_compiled.model
2025-04-29 19:51:55.621 INFO: Done
Loading saved bootstrap sample 3
Training model 3
Using latent charge and penalty 1
2025-04-29 19:51:56.213 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:51:56.213 INFO: MACE version: 0.3.10
2025-04-29 19:51:56.213 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:51:56.218 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:51:56.218 INFO: Using heads: ['default']
2025-04-29 19:51:56.218 INFO: =============    Processing head default     ===========
2025-04-29 19:51:56.218 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:51:56.222 INFO: Atomic Numbers used: [83]
2025-04-29 19:51:56.222 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5843.558680555559}}
2025-04-29 19:51:56.227 INFO: Atomic Energies used (z: eV) for head default: {83: -5843.558680555559}
2025-04-29 19:51:56.343 INFO: Computing average number of neighbors
2025-04-29 19:51:56.955 INFO: Average number of neighbors: 3.0
2025-04-29 19:51:56.956 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:51:56.956 INFO: ===========MODEL DETAILS===========
2025-04-29 19:51:56.958 INFO: Building model
2025-04-29 19:51:56.958 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:51:56.958 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:51:56.958 INFO: 8 radial and 5 basis functions
2025-04-29 19:51:56.958 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:51:56.958 INFO: Distance transform for radial basis functions: None
2025-04-29 19:51:56.958 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:51:57.587 INFO: Mean: 0.00031430023186244813, Std: [0.51024059]
0.0 [0.51024059]
2025-04-29 19:51:57.587 INFO: Scale: [0.51024059], Shift: 0.0
2025-04-29 19:51:58.786 INFO: Total number of parameters: 509618
2025-04-29 19:51:58.787 INFO: 
2025-04-29 19:51:58.787 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:51:58.787 INFO: Using ADAM as parameter optimizer
2025-04-29 19:51:58.787 INFO: Batch size: 32
2025-04-29 19:51:58.787 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:51:58.787 INFO: Number of gradient updates: 2250
2025-04-29 19:51:58.787 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:51:58.787 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:51:58.789 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:51:58.789 INFO: 
2025-04-29 19:51:58.789 INFO: ===========TRAINING===========
2025-04-29 19:51:58.789 INFO: Started training, reporting errors on validation set
2025-04-29 19:51:58.789 INFO: Loss metrics on validation set
2025-04-29 19:51:59.745 INFO: Initial: head: validation, loss=16.76990569, MAE_E=16244.99 meV, MAE_F=  335.22 meV / A
2025-04-29 19:52:02.210 INFO: Epoch 0: head: train, loss=0.78742899, MAE_E= 3269.15 meV, MAE_F=  110.82 meV / A
2025-04-29 19:52:03.042 INFO: Epoch 0: head: validation, loss=0.80690218, MAE_E= 3273.04 meV, MAE_F=  102.04 meV / A
2025-04-29 19:52:05.560 INFO: Epoch 1: head: train, loss=0.32774090, MAE_E= 2667.98 meV, MAE_F=  164.33 meV / A
2025-04-29 19:52:06.271 INFO: Epoch 1: head: validation, loss=0.34333005, MAE_E= 2660.71 meV, MAE_F=  158.61 meV / A
2025-04-29 19:52:08.799 INFO: Epoch 2: head: train, loss=0.05621578, MAE_E=   54.87 meV, MAE_F=   70.55 meV / A
2025-04-29 19:52:09.543 INFO: Epoch 2: head: validation, loss=0.06635624, MAE_E=   54.86 meV, MAE_F=   75.12 meV / A
2025-04-29 19:52:12.064 INFO: Epoch 3: head: train, loss=0.16095653, MAE_E= 3776.48 meV, MAE_F=  139.09 meV / A
2025-04-29 19:52:12.662 INFO: Epoch 3: head: validation, loss=0.18056944, MAE_E= 3777.14 meV, MAE_F=  143.77 meV / A
2025-04-29 19:52:15.180 INFO: Epoch 4: head: train, loss=0.42786131, MAE_E=13254.09 meV, MAE_F=   93.39 meV / A
2025-04-29 19:52:15.814 INFO: Epoch 4: head: validation, loss=0.47213903, MAE_E=13257.29 meV, MAE_F=   95.34 meV / A
2025-04-29 19:52:18.278 INFO: Epoch 5: head: train, loss=0.08178361, MAE_E= 1493.99 meV, MAE_F=   78.47 meV / A
2025-04-29 19:52:18.870 INFO: Epoch 5: head: validation, loss=0.10087541, MAE_E= 1496.26 meV, MAE_F=   77.69 meV / A
2025-04-29 19:52:21.327 INFO: Epoch 6: head: train, loss=0.14179756, MAE_E= 6922.42 meV, MAE_F=   72.75 meV / A
2025-04-29 19:52:21.971 INFO: Epoch 6: head: validation, loss=0.16342847, MAE_E= 6921.01 meV, MAE_F=   78.23 meV / A
2025-04-29 19:52:24.440 INFO: Epoch 7: head: train, loss=0.02792901, MAE_E=  543.57 meV, MAE_F=   54.63 meV / A
2025-04-29 19:52:25.151 INFO: Epoch 7: head: validation, loss=0.03612901, MAE_E=  545.86 meV, MAE_F=   58.28 meV / A
2025-04-29 19:52:27.699 INFO: Epoch 8: head: train, loss=0.02446645, MAE_E= 1510.99 meV, MAE_F=   44.20 meV / A
2025-04-29 19:52:28.329 INFO: Epoch 8: head: validation, loss=0.02687704, MAE_E= 1509.44 meV, MAE_F=   45.05 meV / A
2025-04-29 19:52:30.922 INFO: Epoch 9: head: train, loss=0.01141151, MAE_E=   54.50 meV, MAE_F=   36.91 meV / A
2025-04-29 19:52:31.591 INFO: Epoch 9: head: validation, loss=0.01260491, MAE_E=   55.29 meV, MAE_F=   37.17 meV / A
2025-04-29 19:52:34.075 INFO: Epoch 10: head: train, loss=0.13248010, MAE_E=  940.49 meV, MAE_F=  125.35 meV / A
2025-04-29 19:52:34.739 INFO: Epoch 10: head: validation, loss=0.12700799, MAE_E=  946.34 meV, MAE_F=  120.38 meV / A
2025-04-29 19:52:37.044 INFO: Epoch 11: head: train, loss=0.26097934, MAE_E= 1747.42 meV, MAE_F=  150.12 meV / A
2025-04-29 19:52:37.758 INFO: Epoch 11: head: validation, loss=0.25876956, MAE_E= 1754.46 meV, MAE_F=  139.74 meV / A
2025-04-29 19:52:40.157 INFO: Epoch 12: head: train, loss=0.06228386, MAE_E=   30.76 meV, MAE_F=   70.48 meV / A
2025-04-29 19:52:40.878 INFO: Epoch 12: head: validation, loss=0.07778597, MAE_E=   31.22 meV, MAE_F=   67.82 meV / A
2025-04-29 19:52:43.189 INFO: Epoch 13: head: train, loss=0.06610935, MAE_E=  178.32 meV, MAE_F=   65.85 meV / A
2025-04-29 19:52:43.837 INFO: Epoch 13: head: validation, loss=0.08127537, MAE_E=  176.65 meV, MAE_F=   65.24 meV / A
2025-04-29 19:52:46.188 INFO: Epoch 14: head: train, loss=0.05531260, MAE_E=  502.08 meV, MAE_F=   70.16 meV / A
2025-04-29 19:52:46.837 INFO: Epoch 14: head: validation, loss=0.07060320, MAE_E=  499.34 meV, MAE_F=   69.53 meV / A
2025-04-29 19:52:49.132 INFO: Epoch 15: head: train, loss=0.06984149, MAE_E= 2272.00 meV, MAE_F=   75.11 meV / A
2025-04-29 19:52:49.863 INFO: Epoch 15: head: validation, loss=0.08225820, MAE_E= 2274.11 meV, MAE_F=   81.17 meV / A
2025-04-29 19:52:52.122 INFO: Epoch 16: head: train, loss=0.05859212, MAE_E=  252.09 meV, MAE_F=   75.33 meV / A
2025-04-29 19:52:52.800 INFO: Epoch 16: head: validation, loss=0.07047935, MAE_E=  249.29 meV, MAE_F=   73.62 meV / A
2025-04-29 19:52:55.180 INFO: Epoch 17: head: train, loss=0.05964355, MAE_E=  122.28 meV, MAE_F=   80.52 meV / A
2025-04-29 19:52:55.834 INFO: Epoch 17: head: validation, loss=0.07133622, MAE_E=  120.72 meV, MAE_F=   80.60 meV / A
2025-04-29 19:52:58.138 INFO: Epoch 18: head: train, loss=0.03369336, MAE_E=  196.63 meV, MAE_F=   63.87 meV / A
2025-04-29 19:52:58.803 INFO: Epoch 18: head: validation, loss=0.04068533, MAE_E=  193.27 meV, MAE_F=   65.31 meV / A
2025-04-29 19:53:01.083 INFO: Epoch 19: head: train, loss=0.03136037, MAE_E= 1987.60 meV, MAE_F=   48.06 meV / A
2025-04-29 19:53:01.719 INFO: Epoch 19: head: validation, loss=0.03548260, MAE_E= 1990.33 meV, MAE_F=   49.33 meV / A
2025-04-29 19:53:04.114 INFO: Epoch 20: head: train, loss=0.02879264, MAE_E= 1791.41 meV, MAE_F=   54.21 meV / A
2025-04-29 19:53:04.834 INFO: Epoch 20: head: validation, loss=0.03430768, MAE_E= 1793.59 meV, MAE_F=   58.28 meV / A
2025-04-29 19:53:07.305 INFO: Epoch 21: head: train, loss=0.04282481, MAE_E= 1133.52 meV, MAE_F=   62.31 meV / A
2025-04-29 19:53:07.953 INFO: Epoch 21: head: validation, loss=0.05026214, MAE_E= 1135.25 meV, MAE_F=   62.16 meV / A
2025-04-29 19:53:10.403 INFO: Epoch 22: head: train, loss=0.04066729, MAE_E=  135.04 meV, MAE_F=   59.03 meV / A
2025-04-29 19:53:11.139 INFO: Epoch 22: head: validation, loss=0.04878536, MAE_E=  137.36 meV, MAE_F=   60.27 meV / A
2025-04-29 19:53:13.617 INFO: Epoch 23: head: train, loss=0.11081979, MAE_E= 1826.01 meV, MAE_F=  114.42 meV / A
2025-04-29 19:53:14.240 INFO: Epoch 23: head: validation, loss=0.12957524, MAE_E= 1831.56 meV, MAE_F=  114.91 meV / A
2025-04-29 19:53:16.575 INFO: Epoch 24: head: train, loss=0.21401652, MAE_E= 1557.35 meV, MAE_F=  174.79 meV / A
2025-04-29 19:53:17.280 INFO: Epoch 24: head: validation, loss=0.24126635, MAE_E= 1565.95 meV, MAE_F=  173.97 meV / A
2025-04-29 19:53:19.604 INFO: Epoch 25: head: train, loss=0.17529027, MAE_E= 1789.49 meV, MAE_F=  159.22 meV / A
2025-04-29 19:53:20.321 INFO: Epoch 25: head: validation, loss=0.19872543, MAE_E= 1781.89 meV, MAE_F=  159.78 meV / A
2025-04-29 19:53:22.751 INFO: Epoch 26: head: train, loss=0.11250308, MAE_E=  548.46 meV, MAE_F=  120.64 meV / A
2025-04-29 19:53:23.464 INFO: Epoch 26: head: validation, loss=0.12812418, MAE_E=  542.66 meV, MAE_F=  119.84 meV / A
2025-04-29 19:53:25.936 INFO: Epoch 27: head: train, loss=0.06538210, MAE_E= 1275.55 meV, MAE_F=   91.15 meV / A
2025-04-29 19:53:26.587 INFO: Epoch 27: head: validation, loss=0.07507837, MAE_E= 1270.62 meV, MAE_F=   91.56 meV / A
2025-04-29 19:53:28.914 INFO: Epoch 28: head: train, loss=0.04801548, MAE_E= 1690.97 meV, MAE_F=   70.89 meV / A
2025-04-29 19:53:29.647 INFO: Epoch 28: head: validation, loss=0.05410416, MAE_E= 1687.39 meV, MAE_F=   70.83 meV / A
2025-04-29 19:53:32.072 INFO: Epoch 29: head: train, loss=0.03477270, MAE_E= 1042.78 meV, MAE_F=   65.86 meV / A
2025-04-29 19:53:32.771 INFO: Epoch 29: head: validation, loss=0.03893870, MAE_E= 1040.16 meV, MAE_F=   65.25 meV / A
2025-04-29 19:53:32.772 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:53:32.772 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5102], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:53:32.774 INFO: 
2025-04-29 19:53:32.775 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:53:32.775 INFO: eveluation
2025-04-29 19:53:32.775 INFO: The scale is [0.51024059] and shift is 0.0
2025-04-29 19:53:32.902 INFO: Energy Mean: -23374.245594618056, Variance: 0.018209547348964367
2025-04-29 19:53:33.164 INFO: Energy RMSE: 0.5878517031669617
2025-04-29 19:53:33.164 INFO: Energy R2: -17.977388419316306
2025-04-29 19:53:33.164 INFO: Energy MAE: 0.583094596862793
90
(90, 4, 3)
torch.Size([90, 4, 3])
2025-04-29 19:53:33.165 INFO: Forces RMSE: 0.5141400106894497
2025-04-29 19:53:33.165 INFO: Forces R2: 0.7234597266272493
2025-04-29 19:53:33.662 INFO: Energy Mean: -23374.234722222223, Variance: 0.01784236295723621
2025-04-29 19:53:33.793 INFO: Loading checkpoint: results/latent_charge_embed/bi4-6_logs//sample_3//checkpoints/bi4-6_run-123_epoch-9.pt
2025-04-29 19:53:33.843 INFO: Loaded Stage one model from epoch 9 for evaluation
2025-04-29 19:53:33.843 INFO: Saving model to results/latent_charge_embed/bi4-6_logs/sample_3/checkpoints/bi4-6_run-123.model
2025-04-29 19:53:34.005 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi4-6_logs/sample_3/bi4-6_compiled.model
2025-04-29 19:53:34.097 INFO: Done
Loading saved bootstrap sample 4
Training model 4
Using latent charge and penalty 1
2025-04-29 19:53:34.716 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:53:34.716 INFO: MACE version: 0.3.10
2025-04-29 19:53:34.716 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:53:34.721 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:53:34.721 INFO: Using heads: ['default']
2025-04-29 19:53:34.721 INFO: =============    Processing head default     ===========
2025-04-29 19:53:34.721 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:53:34.725 INFO: Atomic Numbers used: [83]
2025-04-29 19:53:34.725 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5843.555931260852}}
2025-04-29 19:53:34.729 INFO: Atomic Energies used (z: eV) for head default: {83: -5843.555931260852}
2025-04-29 19:53:34.849 INFO: Computing average number of neighbors
2025-04-29 19:53:35.468 INFO: Average number of neighbors: 3.0
2025-04-29 19:53:35.469 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:53:35.469 INFO: ===========MODEL DETAILS===========
2025-04-29 19:53:35.470 INFO: Building model
2025-04-29 19:53:35.470 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:53:35.470 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:53:35.470 INFO: 8 radial and 5 basis functions
2025-04-29 19:53:35.471 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:53:35.471 INFO: Distance transform for radial basis functions: None
2025-04-29 19:53:35.471 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:53:36.096 INFO: Mean: -0.00037644511386050993, Std: [0.53071535]
0.0 [0.53071535]
2025-04-29 19:53:36.096 INFO: Scale: [0.53071535], Shift: 0.0
2025-04-29 19:53:37.277 INFO: Total number of parameters: 509618
2025-04-29 19:53:37.277 INFO: 
2025-04-29 19:53:37.277 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:53:37.277 INFO: Using ADAM as parameter optimizer
2025-04-29 19:53:37.277 INFO: Batch size: 32
2025-04-29 19:53:37.277 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:53:37.277 INFO: Number of gradient updates: 2250
2025-04-29 19:53:37.277 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:53:37.277 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:53:37.279 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:53:37.279 INFO: 
2025-04-29 19:53:37.279 INFO: ===========TRAINING===========
2025-04-29 19:53:37.279 INFO: Started training, reporting errors on validation set
2025-04-29 19:53:37.279 INFO: Loss metrics on validation set
2025-04-29 19:53:38.257 INFO: Initial: head: validation, loss=16.80443776, MAE_E=16889.26 meV, MAE_F=  331.75 meV / A
2025-04-29 19:53:40.708 INFO: Epoch 0: head: train, loss=0.85344014, MAE_E= 3949.70 meV, MAE_F=   94.70 meV / A
2025-04-29 19:53:41.539 INFO: Epoch 0: head: validation, loss=0.82889805, MAE_E= 3953.67 meV, MAE_F=   88.54 meV / A
2025-04-29 19:53:44.058 INFO: Epoch 1: head: train, loss=0.25480169, MAE_E= 4223.29 meV, MAE_F=  142.85 meV / A
2025-04-29 19:53:44.735 INFO: Epoch 1: head: validation, loss=0.25613936, MAE_E= 4223.90 meV, MAE_F=  139.05 meV / A
2025-04-29 19:53:47.114 INFO: Epoch 2: head: train, loss=0.04766622, MAE_E=  283.65 meV, MAE_F=   75.76 meV / A
2025-04-29 19:53:47.759 INFO: Epoch 2: head: validation, loss=0.05168358, MAE_E=  280.40 meV, MAE_F=   75.68 meV / A
2025-04-29 19:53:50.201 INFO: Epoch 3: head: train, loss=0.04432649, MAE_E= 1003.77 meV, MAE_F=   72.73 meV / A
2025-04-29 19:53:50.819 INFO: Epoch 3: head: validation, loss=0.04357973, MAE_E= 1003.13 meV, MAE_F=   70.89 meV / A
2025-04-29 19:53:53.094 INFO: Epoch 4: head: train, loss=0.04176331, MAE_E=  454.81 meV, MAE_F=   66.69 meV / A
2025-04-29 19:53:53.789 INFO: Epoch 4: head: validation, loss=0.03875793, MAE_E=  458.15 meV, MAE_F=   65.00 meV / A
2025-04-29 19:53:56.153 INFO: Epoch 5: head: train, loss=0.03921160, MAE_E= 1509.31 meV, MAE_F=   71.42 meV / A
2025-04-29 19:53:56.828 INFO: Epoch 5: head: validation, loss=0.03934882, MAE_E= 1507.52 meV, MAE_F=   70.84 meV / A
2025-04-29 19:53:59.072 INFO: Epoch 6: head: train, loss=0.04465103, MAE_E=  112.92 meV, MAE_F=   65.77 meV / A
2025-04-29 19:53:59.777 INFO: Epoch 6: head: validation, loss=0.04140842, MAE_E=  112.36 meV, MAE_F=   63.80 meV / A
2025-04-29 19:54:02.107 INFO: Epoch 7: head: train, loss=0.04436933, MAE_E=  140.12 meV, MAE_F=   70.53 meV / A
2025-04-29 19:54:02.786 INFO: Epoch 7: head: validation, loss=0.04019887, MAE_E=  139.74 meV, MAE_F=   67.52 meV / A
2025-04-29 19:54:05.160 INFO: Epoch 8: head: train, loss=0.73947099, MAE_E= 1261.71 meV, MAE_F=  251.66 meV / A
2025-04-29 19:54:05.747 INFO: Epoch 8: head: validation, loss=0.62949597, MAE_E= 1243.81 meV, MAE_F=  223.24 meV / A
2025-04-29 19:54:08.042 INFO: Epoch 9: head: train, loss=0.51676339, MAE_E=  284.82 meV, MAE_F=  194.62 meV / A
2025-04-29 19:54:08.709 INFO: Epoch 9: head: validation, loss=0.42196146, MAE_E=  292.57 meV, MAE_F=  173.71 meV / A
2025-04-29 19:54:11.075 INFO: Epoch 10: head: train, loss=0.32955286, MAE_E=  509.22 meV, MAE_F=  146.10 meV / A
2025-04-29 19:54:11.702 INFO: Epoch 10: head: validation, loss=0.26617388, MAE_E=  518.09 meV, MAE_F=  133.01 meV / A
2025-04-29 19:54:13.996 INFO: Epoch 11: head: train, loss=0.12910831, MAE_E=  700.72 meV, MAE_F=   99.48 meV / A
2025-04-29 19:54:14.646 INFO: Epoch 11: head: validation, loss=0.10025964, MAE_E=  702.62 meV, MAE_F=   91.93 meV / A
2025-04-29 19:54:17.047 INFO: Epoch 12: head: train, loss=0.10095478, MAE_E=  111.96 meV, MAE_F=   85.30 meV / A
2025-04-29 19:54:17.683 INFO: Epoch 12: head: validation, loss=0.07693047, MAE_E=  110.59 meV, MAE_F=   78.14 meV / A
2025-04-29 19:54:20.052 INFO: Epoch 13: head: train, loss=0.06632052, MAE_E=  952.04 meV, MAE_F=   76.33 meV / A
2025-04-29 19:54:20.726 INFO: Epoch 13: head: validation, loss=0.05202215, MAE_E=  950.64 meV, MAE_F=   71.06 meV / A
2025-04-29 19:54:23.110 INFO: Epoch 14: head: train, loss=0.05433294, MAE_E= 1324.38 meV, MAE_F=   69.71 meV / A
2025-04-29 19:54:23.753 INFO: Epoch 14: head: validation, loss=0.04357693, MAE_E= 1322.43 meV, MAE_F=   64.95 meV / A
2025-04-29 19:54:25.929 INFO: Epoch 15: head: train, loss=0.03689304, MAE_E=  491.04 meV, MAE_F=   60.96 meV / A
2025-04-29 19:54:26.501 INFO: Epoch 15: head: validation, loss=0.03005854, MAE_E=  487.89 meV, MAE_F=   57.98 meV / A
2025-04-29 19:54:28.740 INFO: Epoch 16: head: train, loss=0.17376140, MAE_E= 4105.53 meV, MAE_F=  138.49 meV / A
2025-04-29 19:54:29.425 INFO: Epoch 16: head: validation, loss=0.17472997, MAE_E= 4102.45 meV, MAE_F=  138.46 meV / A
2025-04-29 19:54:31.553 INFO: Epoch 17: head: train, loss=0.21832869, MAE_E= 1829.72 meV, MAE_F=  133.64 meV / A
2025-04-29 19:54:32.121 INFO: Epoch 17: head: validation, loss=0.19902960, MAE_E= 1831.10 meV, MAE_F=  128.10 meV / A
2025-04-29 19:54:34.300 INFO: Epoch 18: head: train, loss=0.15246308, MAE_E=  205.74 meV, MAE_F=  102.02 meV / A
2025-04-29 19:54:34.831 INFO: Epoch 18: head: validation, loss=0.13995481, MAE_E=  205.67 meV, MAE_F=   98.87 meV / A
2025-04-29 19:54:36.874 INFO: Epoch 19: head: train, loss=0.10153581, MAE_E=  312.64 meV, MAE_F=   85.35 meV / A
2025-04-29 19:54:37.453 INFO: Epoch 19: head: validation, loss=0.09397081, MAE_E=  314.93 meV, MAE_F=   84.41 meV / A
2025-04-29 19:54:39.599 INFO: Epoch 20: head: train, loss=0.07208223, MAE_E=  390.00 meV, MAE_F=   75.61 meV / A
2025-04-29 19:54:40.181 INFO: Epoch 20: head: validation, loss=0.06416316, MAE_E=  391.87 meV, MAE_F=   73.74 meV / A
2025-04-29 19:54:42.381 INFO: Epoch 21: head: train, loss=0.07542558, MAE_E=  495.13 meV, MAE_F=   72.53 meV / A
2025-04-29 19:54:42.955 INFO: Epoch 21: head: validation, loss=0.06594343, MAE_E=  494.45 meV, MAE_F=   69.12 meV / A
2025-04-29 19:54:45.242 INFO: Epoch 22: head: train, loss=0.06595675, MAE_E=   46.22 meV, MAE_F=   69.29 meV / A
2025-04-29 19:54:45.863 INFO: Epoch 22: head: validation, loss=0.05898308, MAE_E=   47.72 meV, MAE_F=   66.91 meV / A
2025-04-29 19:54:48.137 INFO: Epoch 23: head: train, loss=0.05422769, MAE_E=  106.06 meV, MAE_F=   66.86 meV / A
2025-04-29 19:54:48.710 INFO: Epoch 23: head: validation, loss=0.04893288, MAE_E=  103.34 meV, MAE_F=   64.47 meV / A
2025-04-29 19:54:51.075 INFO: Epoch 24: head: train, loss=0.05017466, MAE_E=   57.01 meV, MAE_F=   63.23 meV / A
2025-04-29 19:54:51.733 INFO: Epoch 24: head: validation, loss=0.04774791, MAE_E=   51.90 meV, MAE_F=   61.38 meV / A
2025-04-29 19:54:53.930 INFO: Epoch 25: head: train, loss=0.03997942, MAE_E=   37.14 meV, MAE_F=   58.72 meV / A
2025-04-29 19:54:54.523 INFO: Epoch 25: head: validation, loss=0.03884450, MAE_E=   33.78 meV, MAE_F=   57.42 meV / A
2025-04-29 19:54:56.661 INFO: Epoch 26: head: train, loss=0.03403094, MAE_E=   99.85 meV, MAE_F=   53.02 meV / A
2025-04-29 19:54:57.248 INFO: Epoch 26: head: validation, loss=0.03320712, MAE_E=   96.78 meV, MAE_F=   51.47 meV / A
2025-04-29 19:54:59.460 INFO: Epoch 27: head: train, loss=0.02927379, MAE_E=   83.45 meV, MAE_F=   48.61 meV / A
2025-04-29 19:55:00.059 INFO: Epoch 27: head: validation, loss=0.02823226, MAE_E=   80.22 meV, MAE_F=   47.21 meV / A
2025-04-29 19:55:02.324 INFO: Epoch 28: head: train, loss=0.02773781, MAE_E=  189.99 meV, MAE_F=   43.64 meV / A
2025-04-29 19:55:02.922 INFO: Epoch 28: head: validation, loss=0.02702972, MAE_E=  186.88 meV, MAE_F=   42.33 meV / A
2025-04-29 19:55:05.172 INFO: Epoch 29: head: train, loss=0.02497226, MAE_E=  634.73 meV, MAE_F=   39.82 meV / A
2025-04-29 19:55:05.754 INFO: Epoch 29: head: validation, loss=0.02426180, MAE_E=  632.14 meV, MAE_F=   38.77 meV / A
2025-04-29 19:55:08.021 INFO: Epoch 30: head: train, loss=0.02481273, MAE_E= 1450.93 meV, MAE_F=   39.00 meV / A
2025-04-29 19:55:08.587 INFO: Epoch 30: head: validation, loss=0.02404905, MAE_E= 1448.62 meV, MAE_F=   37.57 meV / A
2025-04-29 19:55:10.846 INFO: Epoch 31: head: train, loss=0.04813630, MAE_E= 3287.59 meV, MAE_F=   43.11 meV / A
2025-04-29 19:55:11.506 INFO: Epoch 31: head: validation, loss=0.04887913, MAE_E= 3290.65 meV, MAE_F=   41.69 meV / A
2025-04-29 19:55:13.772 INFO: Epoch 32: head: train, loss=0.25665797, MAE_E= 7224.38 meV, MAE_F=   52.35 meV / A
2025-04-29 19:55:14.363 INFO: Epoch 32: head: validation, loss=0.26394116, MAE_E= 7227.14 meV, MAE_F=   51.83 meV / A
2025-04-29 19:55:16.495 INFO: Epoch 33: head: train, loss=0.52130829, MAE_E= 8278.31 meV, MAE_F=   57.33 meV / A
2025-04-29 19:55:17.103 INFO: Epoch 33: head: validation, loss=0.53234270, MAE_E= 8281.06 meV, MAE_F=   57.65 meV / A
2025-04-29 19:55:19.255 INFO: Epoch 34: head: train, loss=0.36809926, MAE_E= 7673.13 meV, MAE_F=   51.99 meV / A
2025-04-29 19:55:19.931 INFO: Epoch 34: head: validation, loss=0.37752020, MAE_E= 7676.04 meV, MAE_F=   52.54 meV / A
2025-04-29 19:55:22.180 INFO: Epoch 35: head: train, loss=0.28937155, MAE_E= 6246.21 meV, MAE_F=   54.62 meV / A
2025-04-29 19:55:22.780 INFO: Epoch 35: head: validation, loss=0.29699268, MAE_E= 6248.52 meV, MAE_F=   54.50 meV / A
2025-04-29 19:55:24.979 INFO: Epoch 36: head: train, loss=0.19452403, MAE_E= 4705.38 meV, MAE_F=   54.38 meV / A
2025-04-29 19:55:25.552 INFO: Epoch 36: head: validation, loss=0.20011051, MAE_E= 4708.62 meV, MAE_F=   54.33 meV / A
2025-04-29 19:55:27.684 INFO: Epoch 37: head: train, loss=0.13403110, MAE_E= 3631.18 meV, MAE_F=   51.20 meV / A
2025-04-29 19:55:28.308 INFO: Epoch 37: head: validation, loss=0.13798535, MAE_E= 3633.85 meV, MAE_F=   51.15 meV / A
2025-04-29 19:55:30.562 INFO: Epoch 38: head: train, loss=0.13091200, MAE_E= 3010.32 meV, MAE_F=   49.50 meV / A
2025-04-29 19:55:31.165 INFO: Epoch 38: head: validation, loss=0.13393262, MAE_E= 3013.35 meV, MAE_F=   48.53 meV / A
2025-04-29 19:55:33.273 INFO: Epoch 39: head: train, loss=0.10585950, MAE_E= 2373.18 meV, MAE_F=   45.50 meV / A
2025-04-29 19:55:33.854 INFO: Epoch 39: head: validation, loss=0.10810751, MAE_E= 2376.61 meV, MAE_F=   44.83 meV / A
2025-04-29 19:55:36.053 INFO: Epoch 40: head: train, loss=0.09748607, MAE_E= 1838.83 meV, MAE_F=   41.79 meV / A
2025-04-29 19:55:36.619 INFO: Epoch 40: head: validation, loss=0.09915022, MAE_E= 1842.47 meV, MAE_F=   41.05 meV / A
2025-04-29 19:55:38.823 INFO: Epoch 41: head: train, loss=0.08686881, MAE_E= 1404.82 meV, MAE_F=   40.57 meV / A
2025-04-29 19:55:39.428 INFO: Epoch 41: head: validation, loss=0.08794733, MAE_E= 1408.62 meV, MAE_F=   39.38 meV / A
2025-04-29 19:55:41.700 INFO: Epoch 42: head: train, loss=0.07104179, MAE_E= 1039.70 meV, MAE_F=   41.77 meV / A
2025-04-29 19:55:42.292 INFO: Epoch 42: head: validation, loss=0.07180951, MAE_E= 1042.83 meV, MAE_F=   40.49 meV / A
2025-04-29 19:55:44.462 INFO: Epoch 43: head: train, loss=0.05899142, MAE_E=  805.15 meV, MAE_F=   38.86 meV / A
2025-04-29 19:55:45.047 INFO: Epoch 43: head: validation, loss=0.05969980, MAE_E=  808.41 meV, MAE_F=   38.16 meV / A
2025-04-29 19:55:47.210 INFO: Epoch 44: head: train, loss=0.04355730, MAE_E=  605.10 meV, MAE_F=   39.15 meV / A
2025-04-29 19:55:47.769 INFO: Epoch 44: head: validation, loss=0.04330565, MAE_E=  607.56 meV, MAE_F=   38.50 meV / A
2025-04-29 19:55:49.961 INFO: Epoch 45: head: train, loss=0.04238097, MAE_E=  494.60 meV, MAE_F=   49.19 meV / A
2025-04-29 19:55:50.516 INFO: Epoch 45: head: validation, loss=0.04278675, MAE_E=  497.75 meV, MAE_F=   48.81 meV / A
2025-04-29 19:55:52.726 INFO: Epoch 46: head: train, loss=0.04625044, MAE_E=  368.38 meV, MAE_F=   57.65 meV / A
2025-04-29 19:55:53.362 INFO: Epoch 46: head: validation, loss=0.04404891, MAE_E=  371.39 meV, MAE_F=   56.09 meV / A
2025-04-29 19:55:55.472 INFO: Epoch 47: head: train, loss=0.04504365, MAE_E=  344.76 meV, MAE_F=   60.43 meV / A
2025-04-29 19:55:56.031 INFO: Epoch 47: head: validation, loss=0.04269352, MAE_E=  347.43 meV, MAE_F=   58.49 meV / A
2025-04-29 19:55:58.258 INFO: Epoch 48: head: train, loss=0.04333134, MAE_E=  151.11 meV, MAE_F=   61.51 meV / A
2025-04-29 19:55:58.932 INFO: Epoch 48: head: validation, loss=0.04127949, MAE_E=  154.43 meV, MAE_F=   60.31 meV / A
2025-04-29 19:56:01.171 INFO: Epoch 49: head: train, loss=0.03680763, MAE_E=  504.54 meV, MAE_F=   60.70 meV / A
2025-04-29 19:56:01.835 INFO: Epoch 49: head: validation, loss=0.03531624, MAE_E=  508.28 meV, MAE_F=   58.73 meV / A
2025-04-29 19:56:04.028 INFO: Epoch 50: head: train, loss=0.05019401, MAE_E=  150.26 meV, MAE_F=   72.96 meV / A
2025-04-29 19:56:04.628 INFO: Epoch 50: head: validation, loss=0.05109673, MAE_E=  144.95 meV, MAE_F=   73.42 meV / A
2025-04-29 19:56:04.629 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:56:04.629 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5307], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:56:04.632 INFO: 
2025-04-29 19:56:04.632 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:56:04.632 INFO: eveluation
2025-04-29 19:56:04.632 INFO: The scale is [0.53071535] and shift is 0.0
2025-04-29 19:56:04.753 INFO: Energy Mean: -23374.246766493055, Variance: 0.015302459810986931
2025-04-29 19:56:05.012 INFO: Energy RMSE: 4.329903602600098
2025-04-29 19:56:05.012 INFO: Energy R2: -1224.166767925218
2025-04-29 19:56:05.012 INFO: Energy MAE: 4.328927993774414
90
(90, 4, 3)
torch.Size([90, 4, 3])
2025-04-29 19:56:05.013 INFO: Forces RMSE: 0.6285249585494141
2025-04-29 19:56:05.013 INFO: Forces R2: 0.5536405695378561
2025-04-29 19:56:05.494 INFO: Energy Mean: -23374.223725043405, Variance: 0.02233796858493193
2025-04-29 19:56:05.603 INFO: Loading checkpoint: results/latent_charge_embed/bi4-6_logs//sample_4//checkpoints/bi4-6_run-123_epoch-30.pt
2025-04-29 19:56:05.672 INFO: Loaded Stage one model from epoch 30 for evaluation
2025-04-29 19:56:05.672 INFO: Saving model to results/latent_charge_embed/bi4-6_logs/sample_4/checkpoints/bi4-6_run-123.model
2025-04-29 19:56:05.839 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi4-6_logs/sample_4/bi4-6_compiled.model
2025-04-29 19:56:05.929 INFO: Done

============================= JOB FEEDBACK =============================

Job ID: 3119738
Cluster: hk
User/Group: hv3694/hk-project-aimat2
Account: hk-project-aimat2
State: COMPLETED (exit code 0)
Partition: accelerated
Nodes: 1
Cores per node: 8
Nodelist: hkn0533
CPU Utilized: 00:23:17
CPU Efficiency: 21.43% of 01:48:40 core-walltime
Job Wall-clock time: 00:13:35
Starttime: Tue Apr 29 19:42:32 2025
Endtime: Tue Apr 29 19:56:07 2025
Memory Utilized: 1.84 GB
Memory Efficiency: 0.00% of 0.00 MB
Energy Consumed: 648540 Joule / 180.15 Watthours
Average node power draw: 795.754601226994 Watt
