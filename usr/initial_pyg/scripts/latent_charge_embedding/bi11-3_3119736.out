cuequivariance or cuequivariance_torch is not available. Cuequivariance acceleration will be disabled.
False
Results directory samples/ already exists. Exiting.
Reading data from:  ./raw/bi11-3_parsed.csv
['./raw/bi11-3_parsed.csv']
Reading data from:  ./raw/bi11-3_parsed.csv
[-64251.81630870205]
(11, 3)
Loading saved bootstrap sample 0
Training model 0
Using latent charge and penalty 1
2025-04-29 19:43:05.647 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:43:05.648 INFO: MACE version: 0.3.10
2025-04-29 19:43:05.709 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:43:05.751 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:43:05.751 INFO: Using heads: ['default']
2025-04-29 19:43:05.751 INFO: =============    Processing head default     ===========
2025-04-29 19:43:05.751 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:43:05.759 INFO: Atomic Numbers used: [83]
2025-04-29 19:43:05.759 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5841.031127683081}}
2025-04-29 19:43:05.765 INFO: Atomic Energies used (z: eV) for head default: {83: -5841.031127683081}
2025-04-29 19:43:05.886 INFO: Computing average number of neighbors
2025-04-29 19:43:08.647 INFO: Average number of neighbors: 10.0
2025-04-29 19:43:08.647 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:43:08.647 INFO: ===========MODEL DETAILS===========
2025-04-29 19:43:08.647 INFO: Building model
2025-04-29 19:43:08.647 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:43:08.647 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:43:08.647 INFO: 8 radial and 5 basis functions
2025-04-29 19:43:08.647 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:43:08.647 INFO: Distance transform for radial basis functions: None
2025-04-29 19:43:08.647 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:43:08.940 INFO: Mean: -0.0002827233615526661, Std: [0.75649623]
0.0 [0.75649623]
2025-04-29 19:43:08.941 INFO: Scale: [0.75649623], Shift: 0.0
2025-04-29 19:43:10.240 INFO: Total number of parameters: 509618
2025-04-29 19:43:10.240 INFO: 
2025-04-29 19:43:10.240 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:43:10.240 INFO: Using ADAM as parameter optimizer
2025-04-29 19:43:10.240 INFO: Batch size: 32
2025-04-29 19:43:10.240 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:43:10.240 INFO: Number of gradient updates: 2250
2025-04-29 19:43:10.240 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:43:10.240 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:43:10.242 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:43:10.242 INFO: 
2025-04-29 19:43:10.242 INFO: ===========TRAINING===========
2025-04-29 19:43:10.242 INFO: Started training, reporting errors on validation set
2025-04-29 19:43:10.242 INFO: Loss metrics on validation set
2025-04-29 19:43:12.810 INFO: Initial: head: validation, loss=3.89054231, MAE_E=32004.64 meV, MAE_F=  583.48 meV / A
2025-04-29 19:43:18.289 INFO: Epoch 0: head: train, loss=0.38450890, MAE_E= 7574.30 meV, MAE_F=  201.94 meV / A
2025-04-29 19:43:19.624 INFO: Epoch 0: head: validation, loss=0.41882416, MAE_E= 7554.91 meV, MAE_F=  206.31 meV / A
2025-04-29 19:43:22.024 INFO: Epoch 1: head: train, loss=0.36781298, MAE_E=  316.46 meV, MAE_F=  215.39 meV / A
2025-04-29 19:43:22.708 INFO: Epoch 1: head: validation, loss=0.40138836, MAE_E=  329.82 meV, MAE_F=  216.76 meV / A
2025-04-29 19:43:25.069 INFO: Epoch 2: head: train, loss=0.22902436, MAE_E= 1391.33 meV, MAE_F=  171.76 meV / A
2025-04-29 19:43:25.707 INFO: Epoch 2: head: validation, loss=0.25705087, MAE_E= 1402.85 meV, MAE_F=  175.00 meV / A
2025-04-29 19:43:28.118 INFO: Epoch 3: head: train, loss=0.25402011, MAE_E= 2289.76 meV, MAE_F=  150.65 meV / A
2025-04-29 19:43:28.686 INFO: Epoch 3: head: validation, loss=0.27058766, MAE_E= 2300.84 meV, MAE_F=  151.96 meV / A
2025-04-29 19:43:31.035 INFO: Epoch 4: head: train, loss=0.17203334, MAE_E= 3966.14 meV, MAE_F=  154.22 meV / A
2025-04-29 19:43:31.625 INFO: Epoch 4: head: validation, loss=0.18561150, MAE_E= 3950.18 meV, MAE_F=  153.85 meV / A
2025-04-29 19:43:34.041 INFO: Epoch 5: head: train, loss=0.08566649, MAE_E=  733.38 meV, MAE_F=  116.98 meV / A
2025-04-29 19:43:34.588 INFO: Epoch 5: head: validation, loss=0.08936571, MAE_E=  720.07 meV, MAE_F=  114.07 meV / A
2025-04-29 19:43:36.967 INFO: Epoch 6: head: train, loss=0.06252346, MAE_E=  333.43 meV, MAE_F=  100.51 meV / A
2025-04-29 19:43:37.635 INFO: Epoch 6: head: validation, loss=0.06490354, MAE_E=  345.43 meV, MAE_F=   96.98 meV / A
2025-04-29 19:43:40.162 INFO: Epoch 7: head: train, loss=0.05452347, MAE_E= 1924.85 meV, MAE_F=   86.77 meV / A
2025-04-29 19:43:40.730 INFO: Epoch 7: head: validation, loss=0.05577178, MAE_E= 1917.15 meV, MAE_F=   83.33 meV / A
2025-04-29 19:43:43.169 INFO: Epoch 8: head: train, loss=0.06867834, MAE_E= 2811.37 meV, MAE_F=   90.05 meV / A
2025-04-29 19:43:43.767 INFO: Epoch 8: head: validation, loss=0.07017952, MAE_E= 2822.71 meV, MAE_F=   87.75 meV / A
2025-04-29 19:43:46.146 INFO: Epoch 9: head: train, loss=0.07918121, MAE_E=  551.01 meV, MAE_F=  107.92 meV / A
2025-04-29 19:43:46.702 INFO: Epoch 9: head: validation, loss=0.08619811, MAE_E=  541.82 meV, MAE_F=  106.32 meV / A
2025-04-29 19:43:49.047 INFO: Epoch 10: head: train, loss=0.11454579, MAE_E= 3933.64 meV, MAE_F=  124.19 meV / A
2025-04-29 19:43:49.742 INFO: Epoch 10: head: validation, loss=0.12955027, MAE_E= 3939.39 meV, MAE_F=  124.45 meV / A
2025-04-29 19:43:52.095 INFO: Epoch 11: head: train, loss=0.07412665, MAE_E= 1330.29 meV, MAE_F=  104.24 meV / A
2025-04-29 19:43:52.699 INFO: Epoch 11: head: validation, loss=0.08176569, MAE_E= 1335.78 meV, MAE_F=  102.97 meV / A
2025-04-29 19:43:55.048 INFO: Epoch 12: head: train, loss=0.09578504, MAE_E= 6324.15 meV, MAE_F=  111.18 meV / A
2025-04-29 19:43:55.631 INFO: Epoch 12: head: validation, loss=0.10560261, MAE_E= 6329.59 meV, MAE_F=  110.05 meV / A
2025-04-29 19:43:57.939 INFO: Epoch 13: head: train, loss=0.05482218, MAE_E=  668.59 meV, MAE_F=   89.69 meV / A
2025-04-29 19:43:58.554 INFO: Epoch 13: head: validation, loss=0.05998361, MAE_E=  674.84 meV, MAE_F=   88.51 meV / A
2025-04-29 19:44:00.864 INFO: Epoch 14: head: train, loss=0.03902795, MAE_E=  416.25 meV, MAE_F=   78.46 meV / A
2025-04-29 19:44:01.431 INFO: Epoch 14: head: validation, loss=0.04251145, MAE_E=  421.92 meV, MAE_F=   76.95 meV / A
2025-04-29 19:44:03.883 INFO: Epoch 15: head: train, loss=0.06272904, MAE_E= 5910.09 meV, MAE_F=   77.49 meV / A
2025-04-29 19:44:04.508 INFO: Epoch 15: head: validation, loss=0.06482293, MAE_E= 5915.69 meV, MAE_F=   74.89 meV / A
2025-04-29 19:44:06.838 INFO: Epoch 16: head: train, loss=0.06638731, MAE_E= 3624.34 meV, MAE_F=   85.85 meV / A
2025-04-29 19:44:07.509 INFO: Epoch 16: head: validation, loss=0.06784298, MAE_E= 3618.10 meV, MAE_F=   84.12 meV / A
2025-04-29 19:44:09.832 INFO: Epoch 17: head: train, loss=0.06725351, MAE_E=11241.43 meV, MAE_F=   80.26 meV / A
2025-04-29 19:44:10.447 INFO: Epoch 17: head: validation, loss=0.07059057, MAE_E=11250.72 meV, MAE_F=   78.33 meV / A
2025-04-29 19:44:12.731 INFO: Epoch 18: head: train, loss=0.10870683, MAE_E=15292.54 meV, MAE_F=   89.52 meV / A
2025-04-29 19:44:13.348 INFO: Epoch 18: head: validation, loss=0.11416264, MAE_E=15302.65 meV, MAE_F=   87.12 meV / A
2025-04-29 19:44:15.674 INFO: Epoch 19: head: train, loss=0.06857800, MAE_E= 9209.17 meV, MAE_F=   91.28 meV / A
2025-04-29 19:44:16.259 INFO: Epoch 19: head: validation, loss=0.07207455, MAE_E= 9216.58 meV, MAE_F=   89.38 meV / A
2025-04-29 19:44:18.605 INFO: Epoch 20: head: train, loss=0.05959970, MAE_E= 5920.20 meV, MAE_F=   93.01 meV / A
2025-04-29 19:44:19.201 INFO: Epoch 20: head: validation, loss=0.06256347, MAE_E= 5926.33 meV, MAE_F=   92.11 meV / A
2025-04-29 19:44:21.560 INFO: Epoch 21: head: train, loss=0.04480440, MAE_E= 3932.02 meV, MAE_F=   82.27 meV / A
2025-04-29 19:44:22.200 INFO: Epoch 21: head: validation, loss=0.04669892, MAE_E= 3937.92 meV, MAE_F=   80.97 meV / A
2025-04-29 19:44:24.637 INFO: Epoch 22: head: train, loss=0.03293524, MAE_E= 2520.92 meV, MAE_F=   72.80 meV / A
2025-04-29 19:44:25.208 INFO: Epoch 22: head: validation, loss=0.03430198, MAE_E= 2526.39 meV, MAE_F=   71.34 meV / A
2025-04-29 19:44:27.523 INFO: Epoch 23: head: train, loss=0.02818798, MAE_E= 1891.64 meV, MAE_F=   67.44 meV / A
2025-04-29 19:44:28.179 INFO: Epoch 23: head: validation, loss=0.02912465, MAE_E= 1896.17 meV, MAE_F=   65.61 meV / A
2025-04-29 19:44:30.541 INFO: Epoch 24: head: train, loss=0.02437630, MAE_E=  971.96 meV, MAE_F=   65.34 meV / A
2025-04-29 19:44:31.129 INFO: Epoch 24: head: validation, loss=0.02510905, MAE_E=  976.23 meV, MAE_F=   63.46 meV / A
2025-04-29 19:44:33.606 INFO: Epoch 25: head: train, loss=0.02507268, MAE_E= 1051.78 meV, MAE_F=   63.04 meV / A
2025-04-29 19:44:34.280 INFO: Epoch 25: head: validation, loss=0.02592103, MAE_E= 1055.18 meV, MAE_F=   61.41 meV / A
2025-04-29 19:44:36.630 INFO: Epoch 26: head: train, loss=0.02504632, MAE_E=   29.70 meV, MAE_F=   68.77 meV / A
2025-04-29 19:44:37.208 INFO: Epoch 26: head: validation, loss=0.02613951, MAE_E=   28.88 meV, MAE_F=   67.63 meV / A
2025-04-29 19:44:39.524 INFO: Epoch 27: head: train, loss=0.02622534, MAE_E=   53.47 meV, MAE_F=   65.08 meV / A
2025-04-29 19:44:40.164 INFO: Epoch 27: head: validation, loss=0.02715876, MAE_E=   55.80 meV, MAE_F=   63.86 meV / A
2025-04-29 19:44:42.421 INFO: Epoch 28: head: train, loss=0.02343860, MAE_E=   30.77 meV, MAE_F=   62.21 meV / A
2025-04-29 19:44:43.043 INFO: Epoch 28: head: validation, loss=0.02420165, MAE_E=   31.21 meV, MAE_F=   60.72 meV / A
2025-04-29 19:44:45.472 INFO: Epoch 29: head: train, loss=0.02167379, MAE_E=   45.14 meV, MAE_F=   61.75 meV / A
2025-04-29 19:44:46.061 INFO: Epoch 29: head: validation, loss=0.02275248, MAE_E=   43.85 meV, MAE_F=   60.90 meV / A
2025-04-29 19:44:48.511 INFO: Epoch 30: head: train, loss=0.02034925, MAE_E=   23.81 meV, MAE_F=   60.02 meV / A
2025-04-29 19:44:49.107 INFO: Epoch 30: head: validation, loss=0.02095767, MAE_E=   20.43 meV, MAE_F=   58.39 meV / A
2025-04-29 19:44:51.621 INFO: Epoch 31: head: train, loss=0.03402782, MAE_E=   53.32 meV, MAE_F=   65.35 meV / A
2025-04-29 19:44:52.233 INFO: Epoch 31: head: validation, loss=0.03490109, MAE_E=   57.60 meV, MAE_F=   64.00 meV / A
2025-04-29 19:44:54.635 INFO: Epoch 32: head: train, loss=0.02578467, MAE_E=   24.11 meV, MAE_F=   62.00 meV / A
2025-04-29 19:44:55.227 INFO: Epoch 32: head: validation, loss=0.02658605, MAE_E=   23.02 meV, MAE_F=   60.27 meV / A
2025-04-29 19:44:57.601 INFO: Epoch 33: head: train, loss=0.02667223, MAE_E=  442.12 meV, MAE_F=   60.76 meV / A
2025-04-29 19:44:58.155 INFO: Epoch 33: head: validation, loss=0.02684644, MAE_E=  444.28 meV, MAE_F=   58.70 meV / A
2025-04-29 19:45:00.477 INFO: Epoch 34: head: train, loss=0.03453744, MAE_E=  409.24 meV, MAE_F=   63.05 meV / A
2025-04-29 19:45:01.020 INFO: Epoch 34: head: validation, loss=0.03494841, MAE_E=  410.91 meV, MAE_F=   61.28 meV / A
2025-04-29 19:45:03.334 INFO: Epoch 35: head: train, loss=0.03615332, MAE_E= 1597.63 meV, MAE_F=   66.05 meV / A
2025-04-29 19:45:03.882 INFO: Epoch 35: head: validation, loss=0.03662746, MAE_E= 1600.60 meV, MAE_F=   64.28 meV / A
2025-04-29 19:45:06.223 INFO: Epoch 36: head: train, loss=0.05643402, MAE_E= 4067.42 meV, MAE_F=   93.47 meV / A
2025-04-29 19:45:06.762 INFO: Epoch 36: head: validation, loss=0.05808677, MAE_E= 4071.54 meV, MAE_F=   91.55 meV / A
2025-04-29 19:45:09.106 INFO: Epoch 37: head: train, loss=0.05237076, MAE_E= 3498.53 meV, MAE_F=   95.35 meV / A
2025-04-29 19:45:09.659 INFO: Epoch 37: head: validation, loss=0.05462862, MAE_E= 3501.86 meV, MAE_F=   93.57 meV / A
2025-04-29 19:45:12.022 INFO: Epoch 38: head: train, loss=0.05120500, MAE_E= 3810.10 meV, MAE_F=   85.85 meV / A
2025-04-29 19:45:12.659 INFO: Epoch 38: head: validation, loss=0.05286415, MAE_E= 3812.75 meV, MAE_F=   83.91 meV / A
2025-04-29 19:45:15.075 INFO: Epoch 39: head: train, loss=0.13920757, MAE_E= 3213.28 meV, MAE_F=  150.82 meV / A
2025-04-29 19:45:15.730 INFO: Epoch 39: head: validation, loss=0.15098812, MAE_E= 3210.16 meV, MAE_F=  148.83 meV / A
2025-04-29 19:45:18.089 INFO: Epoch 40: head: train, loss=0.21500573, MAE_E= 7435.27 meV, MAE_F=  185.45 meV / A
2025-04-29 19:45:18.688 INFO: Epoch 40: head: validation, loss=0.23470612, MAE_E= 7433.89 meV, MAE_F=  183.87 meV / A
2025-04-29 19:45:21.018 INFO: Epoch 41: head: train, loss=0.19467840, MAE_E= 6766.49 meV, MAE_F=  176.04 meV / A
2025-04-29 19:45:21.675 INFO: Epoch 41: head: validation, loss=0.21283010, MAE_E= 6763.45 meV, MAE_F=  174.31 meV / A
2025-04-29 19:45:24.133 INFO: Epoch 42: head: train, loss=0.14430822, MAE_E= 6402.11 meV, MAE_F=  150.64 meV / A
2025-04-29 19:45:24.801 INFO: Epoch 42: head: validation, loss=0.15576125, MAE_E= 6398.23 meV, MAE_F=  148.04 meV / A
2025-04-29 19:45:27.229 INFO: Epoch 43: head: train, loss=0.10271198, MAE_E= 5451.32 meV, MAE_F=  126.78 meV / A
2025-04-29 19:45:27.844 INFO: Epoch 43: head: validation, loss=0.11066618, MAE_E= 5448.13 meV, MAE_F=  124.38 meV / A
2025-04-29 19:45:30.320 INFO: Epoch 44: head: train, loss=0.07122836, MAE_E= 4537.99 meV, MAE_F=  105.51 meV / A
2025-04-29 19:45:30.885 INFO: Epoch 44: head: validation, loss=0.07588958, MAE_E= 4534.60 meV, MAE_F=  103.01 meV / A
2025-04-29 19:45:33.242 INFO: Epoch 45: head: train, loss=0.09352475, MAE_E= 3613.81 meV, MAE_F=  122.55 meV / A
2025-04-29 19:45:33.838 INFO: Epoch 45: head: validation, loss=0.10186825, MAE_E= 3609.71 meV, MAE_F=  120.65 meV / A
2025-04-29 19:45:36.299 INFO: Epoch 46: head: train, loss=0.18423247, MAE_E= 1050.80 meV, MAE_F=  172.95 meV / A
2025-04-29 19:45:36.870 INFO: Epoch 46: head: validation, loss=0.20403457, MAE_E= 1043.38 meV, MAE_F=  171.78 meV / A
2025-04-29 19:45:39.242 INFO: Epoch 47: head: train, loss=0.16139833, MAE_E=  407.66 meV, MAE_F=  160.87 meV / A
2025-04-29 19:45:39.921 INFO: Epoch 47: head: validation, loss=0.17718189, MAE_E=  415.03 meV, MAE_F=  159.94 meV / A
2025-04-29 19:45:42.139 INFO: Epoch 48: head: train, loss=0.12349690, MAE_E=  972.31 meV, MAE_F=  140.23 meV / A
2025-04-29 19:45:42.763 INFO: Epoch 48: head: validation, loss=0.13612886, MAE_E=  979.89 meV, MAE_F=  139.84 meV / A
2025-04-29 19:45:45.130 INFO: Epoch 49: head: train, loss=0.08904012, MAE_E=  863.21 meV, MAE_F=  118.43 meV / A
2025-04-29 19:45:45.739 INFO: Epoch 49: head: validation, loss=0.09769188, MAE_E=  869.70 meV, MAE_F=  118.08 meV / A
2025-04-29 19:45:48.128 INFO: Epoch 50: head: train, loss=0.06988886, MAE_E=  278.22 meV, MAE_F=  103.88 meV / A
2025-04-29 19:45:48.782 INFO: Epoch 50: head: validation, loss=0.07591046, MAE_E=  283.71 meV, MAE_F=  103.35 meV / A
2025-04-29 19:45:48.783 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:45:48.783 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.7565], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:45:48.801 INFO: 
2025-04-29 19:45:48.801 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:45:48.801 INFO: eveluation
2025-04-29 19:45:48.801 INFO: The scale is [0.75649623] and shift is 0.0
2025-04-29 19:45:48.937 INFO: Energy Mean: -64251.35855034722, Variance: 0.11505618436836901
2025-04-29 19:45:49.216 INFO: Energy RMSE: 1.067055583000183
2025-04-29 19:45:49.217 INFO: Energy R2: -8.896099503494046
2025-04-29 19:45:49.217 INFO: Energy MAE: 1.0659722089767456
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:45:49.218 INFO: Forces RMSE: 0.3750226186313595
2025-04-29 19:45:49.218 INFO: Forces R2: 0.9783934458966611
2025-04-29 19:45:49.747 INFO: Energy Mean: -64251.34240451389, Variance: 0.10410331255123939
2025-04-29 19:45:49.874 INFO: Loading checkpoint: results/latent_charge_embed/bi11-3_logs//sample_0//checkpoints/bi11-3_run-123_epoch-30.pt
2025-04-29 19:45:49.915 INFO: Loaded Stage one model from epoch 30 for evaluation
2025-04-29 19:45:49.915 INFO: Saving model to results/latent_charge_embed/bi11-3_logs/sample_0/checkpoints/bi11-3_run-123.model
2025-04-29 19:45:50.079 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi11-3_logs/sample_0/bi11-3_compiled.model
2025-04-29 19:45:50.168 INFO: Done
Loading saved bootstrap sample 1
Training model 1
Using latent charge and penalty 1
2025-04-29 19:45:50.586 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:45:50.586 INFO: MACE version: 0.3.10
2025-04-29 19:45:50.586 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:45:50.591 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:45:50.591 INFO: Using heads: ['default']
2025-04-29 19:45:50.591 INFO: =============    Processing head default     ===========
2025-04-29 19:45:50.591 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:45:50.599 INFO: Atomic Numbers used: [83]
2025-04-29 19:45:50.599 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5841.029255445075}}
2025-04-29 19:45:50.603 INFO: Atomic Energies used (z: eV) for head default: {83: -5841.029255445075}
2025-04-29 19:45:50.721 INFO: Computing average number of neighbors
2025-04-29 19:45:51.207 INFO: Average number of neighbors: 10.0
2025-04-29 19:45:51.207 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:45:51.207 INFO: ===========MODEL DETAILS===========
2025-04-29 19:45:51.209 INFO: Building model
2025-04-29 19:45:51.209 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:45:51.209 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:45:51.209 INFO: 8 radial and 5 basis functions
2025-04-29 19:45:51.209 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:45:51.210 INFO: Distance transform for radial basis functions: None
2025-04-29 19:45:51.210 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:45:51.749 INFO: Mean: -2.0849489855146884e-06, Std: [0.77560663]
0.0 [0.77560663]
2025-04-29 19:45:51.749 INFO: Scale: [0.77560663], Shift: 0.0
2025-04-29 19:45:53.046 INFO: Total number of parameters: 509618
2025-04-29 19:45:53.046 INFO: 
2025-04-29 19:45:53.046 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:45:53.046 INFO: Using ADAM as parameter optimizer
2025-04-29 19:45:53.046 INFO: Batch size: 32
2025-04-29 19:45:53.046 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:45:53.046 INFO: Number of gradient updates: 2250
2025-04-29 19:45:53.046 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:45:53.046 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:45:53.048 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:45:53.048 INFO: 
2025-04-29 19:45:53.048 INFO: ===========TRAINING===========
2025-04-29 19:45:53.048 INFO: Started training, reporting errors on validation set
2025-04-29 19:45:53.048 INFO: Loss metrics on validation set
2025-04-29 19:45:53.949 INFO: Initial: head: validation, loss=3.79703037, MAE_E=32852.33 meV, MAE_F=  570.33 meV / A
2025-04-29 19:45:56.384 INFO: Epoch 0: head: train, loss=0.39515383, MAE_E= 7115.03 meV, MAE_F=  207.80 meV / A
2025-04-29 19:45:57.156 INFO: Epoch 0: head: validation, loss=0.41746906, MAE_E= 7099.08 meV, MAE_F=  203.11 meV / A
2025-04-29 19:45:59.754 INFO: Epoch 1: head: train, loss=0.45561346, MAE_E= 2065.13 meV, MAE_F=  255.05 meV / A
2025-04-29 19:46:00.447 INFO: Epoch 1: head: validation, loss=0.48033567, MAE_E= 2092.57 meV, MAE_F=  244.93 meV / A
2025-04-29 19:46:02.917 INFO: Epoch 2: head: train, loss=0.16038521, MAE_E= 1003.11 meV, MAE_F=  161.27 meV / A
2025-04-29 19:46:03.560 INFO: Epoch 2: head: validation, loss=0.18029369, MAE_E=  990.34 meV, MAE_F=  161.06 meV / A
2025-04-29 19:46:06.071 INFO: Epoch 3: head: train, loss=0.13012239, MAE_E=  140.36 meV, MAE_F=  138.49 meV / A
2025-04-29 19:46:06.706 INFO: Epoch 3: head: validation, loss=0.14223797, MAE_E=  156.02 meV, MAE_F=  135.13 meV / A
2025-04-29 19:46:09.223 INFO: Epoch 4: head: train, loss=0.06721376, MAE_E=  482.97 meV, MAE_F=  102.00 meV / A
2025-04-29 19:46:09.956 INFO: Epoch 4: head: validation, loss=0.07570892, MAE_E=  496.09 meV, MAE_F=  100.33 meV / A
2025-04-29 19:46:12.575 INFO: Epoch 5: head: train, loss=0.03854707, MAE_E=  926.95 meV, MAE_F=   82.58 meV / A
2025-04-29 19:46:13.310 INFO: Epoch 5: head: validation, loss=0.04534136, MAE_E=  919.03 meV, MAE_F=   83.83 meV / A
2025-04-29 19:46:15.869 INFO: Epoch 6: head: train, loss=0.03158014, MAE_E=  121.05 meV, MAE_F=   73.03 meV / A
2025-04-29 19:46:16.512 INFO: Epoch 6: head: validation, loss=0.03564883, MAE_E=  114.20 meV, MAE_F=   74.91 meV / A
2025-04-29 19:46:19.065 INFO: Epoch 7: head: train, loss=0.02897798, MAE_E=  244.20 meV, MAE_F=   68.99 meV / A
2025-04-29 19:46:19.770 INFO: Epoch 7: head: validation, loss=0.03191919, MAE_E=  240.08 meV, MAE_F=   70.85 meV / A
2025-04-29 19:46:22.336 INFO: Epoch 8: head: train, loss=0.02511392, MAE_E=   42.27 meV, MAE_F=   68.45 meV / A
2025-04-29 19:46:23.059 INFO: Epoch 8: head: validation, loss=0.02832306, MAE_E=   40.89 meV, MAE_F=   70.76 meV / A
2025-04-29 19:46:25.599 INFO: Epoch 9: head: train, loss=0.03760554, MAE_E=  109.71 meV, MAE_F=   69.51 meV / A
2025-04-29 19:46:26.286 INFO: Epoch 9: head: validation, loss=0.04067633, MAE_E=  118.10 meV, MAE_F=   70.35 meV / A
2025-04-29 19:46:28.746 INFO: Epoch 10: head: train, loss=0.02474173, MAE_E=  173.41 meV, MAE_F=   64.28 meV / A
2025-04-29 19:46:29.405 INFO: Epoch 10: head: validation, loss=0.02768301, MAE_E=  167.51 meV, MAE_F=   66.49 meV / A
2025-04-29 19:46:31.968 INFO: Epoch 11: head: train, loss=0.02023660, MAE_E=   25.40 meV, MAE_F=   60.26 meV / A
2025-04-29 19:46:32.594 INFO: Epoch 11: head: validation, loss=0.02282340, MAE_E=   24.01 meV, MAE_F=   62.33 meV / A
2025-04-29 19:46:35.140 INFO: Epoch 12: head: train, loss=0.02323723, MAE_E=   93.94 meV, MAE_F=   62.19 meV / A
2025-04-29 19:46:35.768 INFO: Epoch 12: head: validation, loss=0.02585660, MAE_E=  100.62 meV, MAE_F=   63.39 meV / A
2025-04-29 19:46:38.223 INFO: Epoch 13: head: train, loss=0.03344290, MAE_E=  171.98 meV, MAE_F=   68.90 meV / A
2025-04-29 19:46:38.934 INFO: Epoch 13: head: validation, loss=0.03715942, MAE_E=  179.79 meV, MAE_F=   69.64 meV / A
2025-04-29 19:46:41.489 INFO: Epoch 14: head: train, loss=0.03032458, MAE_E=  463.28 meV, MAE_F=   70.52 meV / A
2025-04-29 19:46:42.156 INFO: Epoch 14: head: validation, loss=0.03490963, MAE_E=  469.74 meV, MAE_F=   72.84 meV / A
2025-04-29 19:46:44.674 INFO: Epoch 15: head: train, loss=0.02525811, MAE_E=  150.87 meV, MAE_F=   65.28 meV / A
2025-04-29 19:46:45.304 INFO: Epoch 15: head: validation, loss=0.02897722, MAE_E=  147.02 meV, MAE_F=   67.23 meV / A
2025-04-29 19:46:47.840 INFO: Epoch 16: head: train, loss=0.02681023, MAE_E=  915.04 meV, MAE_F=   64.66 meV / A
2025-04-29 19:46:48.490 INFO: Epoch 16: head: validation, loss=0.03062064, MAE_E=  907.95 meV, MAE_F=   66.46 meV / A
2025-04-29 19:46:50.956 INFO: Epoch 17: head: train, loss=0.03059111, MAE_E= 5310.55 meV, MAE_F=   62.57 meV / A
2025-04-29 19:46:51.689 INFO: Epoch 17: head: validation, loss=0.03353025, MAE_E= 5304.64 meV, MAE_F=   63.20 meV / A
2025-04-29 19:46:54.224 INFO: Epoch 18: head: train, loss=0.02323562, MAE_E= 2689.34 meV, MAE_F=   59.82 meV / A
2025-04-29 19:46:54.941 INFO: Epoch 18: head: validation, loss=0.02511464, MAE_E= 2682.78 meV, MAE_F=   60.00 meV / A
2025-04-29 19:46:57.604 INFO: Epoch 19: head: train, loss=0.04785918, MAE_E= 8362.28 meV, MAE_F=   67.81 meV / A
2025-04-29 19:46:58.245 INFO: Epoch 19: head: validation, loss=0.05168015, MAE_E= 8356.96 meV, MAE_F=   68.44 meV / A
2025-04-29 19:47:00.704 INFO: Epoch 20: head: train, loss=0.04175039, MAE_E= 8069.63 meV, MAE_F=   65.71 meV / A
2025-04-29 19:47:01.336 INFO: Epoch 20: head: validation, loss=0.04527914, MAE_E= 8063.47 meV, MAE_F=   66.24 meV / A
2025-04-29 19:47:03.854 INFO: Epoch 21: head: train, loss=0.06352497, MAE_E=11860.13 meV, MAE_F=   64.18 meV / A
2025-04-29 19:47:04.594 INFO: Epoch 21: head: validation, loss=0.06789123, MAE_E=11856.13 meV, MAE_F=   64.44 meV / A
2025-04-29 19:47:07.086 INFO: Epoch 22: head: train, loss=0.03592857, MAE_E= 6645.61 meV, MAE_F=   57.69 meV / A
2025-04-29 19:47:07.737 INFO: Epoch 22: head: validation, loss=0.03850622, MAE_E= 6640.61 meV, MAE_F=   58.56 meV / A
2025-04-29 19:47:10.285 INFO: Epoch 23: head: train, loss=0.04936057, MAE_E= 5570.29 meV, MAE_F=   56.26 meV / A
2025-04-29 19:47:10.955 INFO: Epoch 23: head: validation, loss=0.05134356, MAE_E= 5564.82 meV, MAE_F=   56.97 meV / A
2025-04-29 19:47:13.614 INFO: Epoch 24: head: train, loss=0.11609673, MAE_E=17428.17 meV, MAE_F=   73.96 meV / A
2025-04-29 19:47:14.249 INFO: Epoch 24: head: validation, loss=0.12365761, MAE_E=17423.86 meV, MAE_F=   73.42 meV / A
2025-04-29 19:47:16.837 INFO: Epoch 25: head: train, loss=0.11166735, MAE_E=16246.73 meV, MAE_F=   65.39 meV / A
2025-04-29 19:47:17.485 INFO: Epoch 25: head: validation, loss=0.11911192, MAE_E=16242.10 meV, MAE_F=   65.61 meV / A
2025-04-29 19:47:19.994 INFO: Epoch 26: head: train, loss=0.07175981, MAE_E= 9369.45 meV, MAE_F=   70.85 meV / A
2025-04-29 19:47:20.714 INFO: Epoch 26: head: validation, loss=0.07671041, MAE_E= 9367.37 meV, MAE_F=   71.24 meV / A
2025-04-29 19:47:23.303 INFO: Epoch 27: head: train, loss=0.04549243, MAE_E= 6129.17 meV, MAE_F=   67.24 meV / A
2025-04-29 19:47:23.951 INFO: Epoch 27: head: validation, loss=0.04929121, MAE_E= 6124.76 meV, MAE_F=   68.60 meV / A
2025-04-29 19:47:26.518 INFO: Epoch 28: head: train, loss=0.04018300, MAE_E= 5277.55 meV, MAE_F=   63.19 meV / A
2025-04-29 19:47:27.172 INFO: Epoch 28: head: validation, loss=0.04344899, MAE_E= 5272.83 meV, MAE_F=   64.98 meV / A
2025-04-29 19:47:29.727 INFO: Epoch 29: head: train, loss=0.04858632, MAE_E= 4279.19 meV, MAE_F=   62.61 meV / A
2025-04-29 19:47:30.363 INFO: Epoch 29: head: validation, loss=0.05103707, MAE_E= 4275.48 meV, MAE_F=   63.64 meV / A
2025-04-29 19:47:32.949 INFO: Epoch 30: head: train, loss=0.06033899, MAE_E= 3870.72 meV, MAE_F=   73.81 meV / A
2025-04-29 19:47:33.568 INFO: Epoch 30: head: validation, loss=0.06382320, MAE_E= 3865.07 meV, MAE_F=   74.49 meV / A
2025-04-29 19:47:36.034 INFO: Epoch 31: head: train, loss=0.06579848, MAE_E= 3416.74 meV, MAE_F=   88.32 meV / A
2025-04-29 19:47:36.643 INFO: Epoch 31: head: validation, loss=0.07077313, MAE_E= 3414.01 meV, MAE_F=   89.45 meV / A
2025-04-29 19:47:36.643 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:47:36.643 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.7756], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:47:36.646 INFO: 
2025-04-29 19:47:36.646 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:47:36.646 INFO: eveluation
2025-04-29 19:47:36.646 INFO: The scale is [0.77560663] and shift is 0.0
2025-04-29 19:47:36.785 INFO: Energy Mean: -64251.382161458336, Variance: 0.11594009399414062
2025-04-29 19:47:37.080 INFO: Energy RMSE: 1.8828133344650269
2025-04-29 19:47:37.080 INFO: Energy R2: -29.576015676124253
2025-04-29 19:47:37.080 INFO: Energy MAE: 1.882421851158142
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:47:37.081 INFO: Forces RMSE: 0.31295331299969437
2025-04-29 19:47:37.081 INFO: Forces R2: 0.984309437371722
2025-04-29 19:47:39.327 INFO: Energy Mean: -64251.32180989583, Variance: 0.10694737328423394
2025-04-29 19:47:39.465 INFO: Loading checkpoint: results/latent_charge_embed/bi11-3_logs//sample_1//checkpoints/bi11-3_run-123_epoch-11.pt
2025-04-29 19:47:39.512 INFO: Loaded Stage one model from epoch 11 for evaluation
2025-04-29 19:47:39.512 INFO: Saving model to results/latent_charge_embed/bi11-3_logs/sample_1/checkpoints/bi11-3_run-123.model
2025-04-29 19:47:39.678 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi11-3_logs/sample_1/bi11-3_compiled.model
2025-04-29 19:47:39.768 INFO: Done
Loading saved bootstrap sample 2
Training model 2
Using latent charge and penalty 1
2025-04-29 19:47:40.186 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:47:40.187 INFO: MACE version: 0.3.10
2025-04-29 19:47:40.187 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:47:40.192 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:47:40.192 INFO: Using heads: ['default']
2025-04-29 19:47:40.192 INFO: =============    Processing head default     ===========
2025-04-29 19:47:40.192 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:47:40.200 INFO: Atomic Numbers used: [83]
2025-04-29 19:47:40.200 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5841.032546164773}}
2025-04-29 19:47:40.204 INFO: Atomic Energies used (z: eV) for head default: {83: -5841.032546164773}
2025-04-29 19:47:40.322 INFO: Computing average number of neighbors
2025-04-29 19:47:40.913 INFO: Average number of neighbors: 10.0
2025-04-29 19:47:40.914 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:47:40.914 INFO: ===========MODEL DETAILS===========
2025-04-29 19:47:40.915 INFO: Building model
2025-04-29 19:47:40.916 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:47:40.916 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:47:40.916 INFO: 8 radial and 5 basis functions
2025-04-29 19:47:40.916 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:47:40.916 INFO: Distance transform for radial basis functions: None
2025-04-29 19:47:40.916 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:47:41.462 INFO: Mean: 0.0002520096204835299, Std: [0.76089576]
0.0 [0.76089576]
2025-04-29 19:47:41.462 INFO: Scale: [0.76089576], Shift: 0.0
2025-04-29 19:47:42.766 INFO: Total number of parameters: 509618
2025-04-29 19:47:42.767 INFO: 
2025-04-29 19:47:42.767 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:47:42.767 INFO: Using ADAM as parameter optimizer
2025-04-29 19:47:42.767 INFO: Batch size: 32
2025-04-29 19:47:42.767 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:47:42.767 INFO: Number of gradient updates: 2250
2025-04-29 19:47:42.767 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:47:42.767 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:47:42.768 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:47:42.768 INFO: 
2025-04-29 19:47:42.768 INFO: ===========TRAINING===========
2025-04-29 19:47:42.768 INFO: Started training, reporting errors on validation set
2025-04-29 19:47:42.768 INFO: Loss metrics on validation set
2025-04-29 19:47:43.688 INFO: Initial: head: validation, loss=4.05354115, MAE_E=32092.97 meV, MAE_F=  621.26 meV / A
2025-04-29 19:47:46.208 INFO: Epoch 0: head: train, loss=0.39071732, MAE_E= 7446.62 meV, MAE_F=  206.85 meV / A
2025-04-29 19:47:47.008 INFO: Epoch 0: head: validation, loss=0.42196260, MAE_E= 7454.58 meV, MAE_F=  212.76 meV / A
2025-04-29 19:47:49.506 INFO: Epoch 1: head: train, loss=0.29119921, MAE_E= 2262.28 meV, MAE_F=  200.14 meV / A
2025-04-29 19:47:50.272 INFO: Epoch 1: head: validation, loss=0.32857114, MAE_E= 2246.96 meV, MAE_F=  208.37 meV / A
2025-04-29 19:47:52.910 INFO: Epoch 2: head: train, loss=0.16885724, MAE_E=  615.49 meV, MAE_F=  157.41 meV / A
2025-04-29 19:47:53.558 INFO: Epoch 2: head: validation, loss=0.18296395, MAE_E=  612.35 meV, MAE_F=  162.05 meV / A
2025-04-29 19:47:56.186 INFO: Epoch 3: head: train, loss=0.07265490, MAE_E=  972.53 meV, MAE_F=  108.12 meV / A
2025-04-29 19:47:56.830 INFO: Epoch 3: head: validation, loss=0.07524994, MAE_E=  978.06 meV, MAE_F=  110.27 meV / A
2025-04-29 19:47:59.461 INFO: Epoch 4: head: train, loss=0.07476327, MAE_E=  229.95 meV, MAE_F=   98.51 meV / A
2025-04-29 19:48:00.216 INFO: Epoch 4: head: validation, loss=0.07807268, MAE_E=  221.79 meV, MAE_F=  100.42 meV / A
2025-04-29 19:48:02.674 INFO: Epoch 5: head: train, loss=0.05801930, MAE_E=  543.84 meV, MAE_F=   99.69 meV / A
2025-04-29 19:48:03.398 INFO: Epoch 5: head: validation, loss=0.06105474, MAE_E=  543.54 meV, MAE_F=  101.34 meV / A
2025-04-29 19:48:05.968 INFO: Epoch 6: head: train, loss=0.05251966, MAE_E=  576.64 meV, MAE_F=   92.44 meV / A
2025-04-29 19:48:06.656 INFO: Epoch 6: head: validation, loss=0.06110673, MAE_E=  569.54 meV, MAE_F=   98.15 meV / A
2025-04-29 19:48:09.122 INFO: Epoch 7: head: train, loss=0.03836534, MAE_E=  231.11 meV, MAE_F=   79.65 meV / A
2025-04-29 19:48:09.848 INFO: Epoch 7: head: validation, loss=0.04129270, MAE_E=  228.86 meV, MAE_F=   83.16 meV / A
2025-04-29 19:48:12.320 INFO: Epoch 8: head: train, loss=0.03666089, MAE_E=  173.90 meV, MAE_F=   74.50 meV / A
2025-04-29 19:48:12.981 INFO: Epoch 8: head: validation, loss=0.03979439, MAE_E=  171.92 meV, MAE_F=   78.57 meV / A
2025-04-29 19:48:15.480 INFO: Epoch 9: head: train, loss=0.03413282, MAE_E=   91.03 meV, MAE_F=   73.57 meV / A
2025-04-29 19:48:16.149 INFO: Epoch 9: head: validation, loss=0.03821225, MAE_E=   85.34 meV, MAE_F=   78.28 meV / A
2025-04-29 19:48:18.655 INFO: Epoch 10: head: train, loss=0.02560870, MAE_E=  101.14 meV, MAE_F=   65.04 meV / A
2025-04-29 19:48:19.326 INFO: Epoch 10: head: validation, loss=0.02836644, MAE_E=   99.92 meV, MAE_F=   69.14 meV / A
2025-04-29 19:48:21.971 INFO: Epoch 11: head: train, loss=0.02254873, MAE_E=  148.47 meV, MAE_F=   61.42 meV / A
2025-04-29 19:48:22.636 INFO: Epoch 11: head: validation, loss=0.02472669, MAE_E=  148.36 meV, MAE_F=   64.99 meV / A
2025-04-29 19:48:25.310 INFO: Epoch 12: head: train, loss=0.01898450, MAE_E=  172.61 meV, MAE_F=   58.14 meV / A
2025-04-29 19:48:25.971 INFO: Epoch 12: head: validation, loss=0.02121101, MAE_E=  172.17 meV, MAE_F=   61.24 meV / A
2025-04-29 19:48:28.684 INFO: Epoch 13: head: train, loss=0.01686625, MAE_E=  147.48 meV, MAE_F=   55.31 meV / A
2025-04-29 19:48:29.330 INFO: Epoch 13: head: validation, loss=0.01912829, MAE_E=  147.13 meV, MAE_F=   58.45 meV / A
2025-04-29 19:48:31.913 INFO: Epoch 14: head: train, loss=0.01653991, MAE_E=  106.05 meV, MAE_F=   52.83 meV / A
2025-04-29 19:48:32.557 INFO: Epoch 14: head: validation, loss=0.01883523, MAE_E=  106.06 meV, MAE_F=   56.42 meV / A
2025-04-29 19:48:35.087 INFO: Epoch 15: head: train, loss=0.02215142, MAE_E=  347.64 meV, MAE_F=   62.54 meV / A
2025-04-29 19:48:35.794 INFO: Epoch 15: head: validation, loss=0.02413674, MAE_E=  349.19 meV, MAE_F=   64.79 meV / A
2025-04-29 19:48:38.391 INFO: Epoch 16: head: train, loss=0.02571406, MAE_E=  574.27 meV, MAE_F=   66.07 meV / A
2025-04-29 19:48:39.025 INFO: Epoch 16: head: validation, loss=0.02888870, MAE_E=  569.21 meV, MAE_F=   69.51 meV / A
2025-04-29 19:48:41.503 INFO: Epoch 17: head: train, loss=0.02973467, MAE_E=   98.92 meV, MAE_F=   73.61 meV / A
2025-04-29 19:48:42.222 INFO: Epoch 17: head: validation, loss=0.03291247, MAE_E=   90.72 meV, MAE_F=   76.69 meV / A
2025-04-29 19:48:44.875 INFO: Epoch 18: head: train, loss=0.03348101, MAE_E=  612.37 meV, MAE_F=   76.84 meV / A
2025-04-29 19:48:45.491 INFO: Epoch 18: head: validation, loss=0.03736807, MAE_E=  622.05 meV, MAE_F=   80.28 meV / A
2025-04-29 19:48:47.990 INFO: Epoch 19: head: train, loss=0.08580002, MAE_E= 1729.75 meV, MAE_F=  128.71 meV / A
2025-04-29 19:48:48.691 INFO: Epoch 19: head: validation, loss=0.08775718, MAE_E= 1726.40 meV, MAE_F=  128.95 meV / A
2025-04-29 19:48:51.217 INFO: Epoch 20: head: train, loss=0.13730536, MAE_E=   78.58 meV, MAE_F=  138.15 meV / A
2025-04-29 19:48:51.863 INFO: Epoch 20: head: validation, loss=0.13942937, MAE_E=   82.42 meV, MAE_F=  137.79 meV / A
2025-04-29 19:48:54.423 INFO: Epoch 21: head: train, loss=0.09672943, MAE_E=  126.85 meV, MAE_F=  113.54 meV / A
2025-04-29 19:48:55.085 INFO: Epoch 21: head: validation, loss=0.09890701, MAE_E=  124.31 meV, MAE_F=  114.49 meV / A
2025-04-29 19:48:57.621 INFO: Epoch 22: head: train, loss=0.06055480, MAE_E=  496.84 meV, MAE_F=   94.32 meV / A
2025-04-29 19:48:58.363 INFO: Epoch 22: head: validation, loss=0.06282787, MAE_E=  493.29 meV, MAE_F=   96.59 meV / A
2025-04-29 19:49:00.824 INFO: Epoch 23: head: train, loss=0.04356060, MAE_E=  127.13 meV, MAE_F=   84.43 meV / A
2025-04-29 19:49:01.449 INFO: Epoch 23: head: validation, loss=0.04611857, MAE_E=  123.75 meV, MAE_F=   86.94 meV / A
2025-04-29 19:49:03.983 INFO: Epoch 24: head: train, loss=0.03512455, MAE_E=  157.47 meV, MAE_F=   77.14 meV / A
2025-04-29 19:49:04.619 INFO: Epoch 24: head: validation, loss=0.03811224, MAE_E=  154.39 meV, MAE_F=   80.38 meV / A
2025-04-29 19:49:07.221 INFO: Epoch 25: head: train, loss=0.03337862, MAE_E=   51.74 meV, MAE_F=   72.57 meV / A
2025-04-29 19:49:07.950 INFO: Epoch 25: head: validation, loss=0.03616264, MAE_E=   49.00 meV, MAE_F=   75.77 meV / A
2025-04-29 19:49:10.436 INFO: Epoch 26: head: train, loss=0.02933054, MAE_E=   46.22 meV, MAE_F=   67.01 meV / A
2025-04-29 19:49:11.081 INFO: Epoch 26: head: validation, loss=0.03197965, MAE_E=   47.14 meV, MAE_F=   70.51 meV / A
2025-04-29 19:49:13.589 INFO: Epoch 27: head: train, loss=0.03399581, MAE_E=  259.46 meV, MAE_F=   72.78 meV / A
2025-04-29 19:49:14.266 INFO: Epoch 27: head: validation, loss=0.03684687, MAE_E=  254.21 meV, MAE_F=   75.89 meV / A
2025-04-29 19:49:16.759 INFO: Epoch 28: head: train, loss=0.05118075, MAE_E= 1004.30 meV, MAE_F=   91.90 meV / A
2025-04-29 19:49:17.478 INFO: Epoch 28: head: validation, loss=0.05488255, MAE_E= 1014.80 meV, MAE_F=   95.25 meV / A
2025-04-29 19:49:19.989 INFO: Epoch 29: head: train, loss=0.05015459, MAE_E=  433.76 meV, MAE_F=   93.92 meV / A
2025-04-29 19:49:20.688 INFO: Epoch 29: head: validation, loss=0.05362412, MAE_E=  443.86 meV, MAE_F=   97.30 meV / A
2025-04-29 19:49:23.177 INFO: Epoch 30: head: train, loss=0.04214304, MAE_E=   35.97 meV, MAE_F=   86.81 meV / A
2025-04-29 19:49:23.866 INFO: Epoch 30: head: validation, loss=0.04489909, MAE_E=   38.20 meV, MAE_F=   90.10 meV / A
2025-04-29 19:49:26.424 INFO: Epoch 31: head: train, loss=0.03642715, MAE_E=   30.13 meV, MAE_F=   80.34 meV / A
2025-04-29 19:49:27.076 INFO: Epoch 31: head: validation, loss=0.03952597, MAE_E=   35.88 meV, MAE_F=   84.08 meV / A
2025-04-29 19:49:29.560 INFO: Epoch 32: head: train, loss=0.03126361, MAE_E=   37.93 meV, MAE_F=   75.16 meV / A
2025-04-29 19:49:30.239 INFO: Epoch 32: head: validation, loss=0.03421391, MAE_E=   45.28 meV, MAE_F=   78.82 meV / A
2025-04-29 19:49:32.688 INFO: Epoch 33: head: train, loss=0.02665459, MAE_E=   70.81 meV, MAE_F=   68.79 meV / A
2025-04-29 19:49:33.344 INFO: Epoch 33: head: validation, loss=0.02949459, MAE_E=   75.91 meV, MAE_F=   72.43 meV / A
2025-04-29 19:49:35.809 INFO: Epoch 34: head: train, loss=0.03246001, MAE_E=  777.87 meV, MAE_F=   68.96 meV / A
2025-04-29 19:49:36.470 INFO: Epoch 34: head: validation, loss=0.03586686, MAE_E=  778.91 meV, MAE_F=   73.06 meV / A
2025-04-29 19:49:36.471 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:49:36.471 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.7609], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:49:36.474 INFO: 
2025-04-29 19:49:36.474 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:49:36.474 INFO: eveluation
2025-04-29 19:49:36.474 INFO: The scale is [0.76089576] and shift is 0.0
2025-04-29 19:49:36.607 INFO: Energy Mean: -64251.276779513886, Variance: 0.09509364186981581
2025-04-29 19:49:36.877 INFO: Energy RMSE: 4.495959758758545
2025-04-29 19:49:36.877 INFO: Energy R2: -211.56577555067173
2025-04-29 19:49:36.877 INFO: Energy MAE: 4.495790004730225
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:49:36.878 INFO: Forces RMSE: 0.3211269144727901
2025-04-29 19:49:36.878 INFO: Forces R2: 0.985553529349089
2025-04-29 19:49:37.400 INFO: Energy Mean: -64251.3580078125, Variance: 0.10383842892116968
2025-04-29 19:49:37.524 INFO: Loading checkpoint: results/latent_charge_embed/bi11-3_logs//sample_2//checkpoints/bi11-3_run-123_epoch-14.pt
2025-04-29 19:49:37.570 INFO: Loaded Stage one model from epoch 14 for evaluation
2025-04-29 19:49:37.571 INFO: Saving model to results/latent_charge_embed/bi11-3_logs/sample_2/checkpoints/bi11-3_run-123.model
2025-04-29 19:49:37.730 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi11-3_logs/sample_2/bi11-3_compiled.model
2025-04-29 19:49:37.821 INFO: Done
Loading saved bootstrap sample 3
Training model 3
Using latent charge and penalty 1
2025-04-29 19:49:38.243 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:49:38.243 INFO: MACE version: 0.3.10
2025-04-29 19:49:38.243 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:49:38.248 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:49:38.248 INFO: Using heads: ['default']
2025-04-29 19:49:38.248 INFO: =============    Processing head default     ===========
2025-04-29 19:49:38.248 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:49:38.256 INFO: Atomic Numbers used: [83]
2025-04-29 19:49:38.256 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5841.031917810923}}
2025-04-29 19:49:38.261 INFO: Atomic Energies used (z: eV) for head default: {83: -5841.031917810923}
2025-04-29 19:49:38.378 INFO: Computing average number of neighbors
2025-04-29 19:49:38.951 INFO: Average number of neighbors: 10.0
2025-04-29 19:49:38.952 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:49:38.952 INFO: ===========MODEL DETAILS===========
2025-04-29 19:49:38.953 INFO: Building model
2025-04-29 19:49:38.953 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:49:38.953 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:49:38.953 INFO: 8 radial and 5 basis functions
2025-04-29 19:49:38.954 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:49:38.954 INFO: Distance transform for radial basis functions: None
2025-04-29 19:49:38.954 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:49:39.626 INFO: Mean: 6.250358688883676e-05, Std: [0.7694964]
0.0 [0.7694964]
2025-04-29 19:49:39.626 INFO: Scale: [0.7694964], Shift: 0.0
2025-04-29 19:49:40.799 INFO: Total number of parameters: 509618
2025-04-29 19:49:40.799 INFO: 
2025-04-29 19:49:40.799 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:49:40.799 INFO: Using ADAM as parameter optimizer
2025-04-29 19:49:40.799 INFO: Batch size: 32
2025-04-29 19:49:40.799 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:49:40.799 INFO: Number of gradient updates: 2250
2025-04-29 19:49:40.799 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:49:40.799 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:49:40.801 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:49:40.801 INFO: 
2025-04-29 19:49:40.801 INFO: ===========TRAINING===========
2025-04-29 19:49:40.801 INFO: Started training, reporting errors on validation set
2025-04-29 19:49:40.801 INFO: Loss metrics on validation set
2025-04-29 19:49:41.763 INFO: Initial: head: validation, loss=3.77512360, MAE_E=32542.42 meV, MAE_F=  584.79 meV / A
2025-04-29 19:49:44.243 INFO: Epoch 0: head: train, loss=0.40108354, MAE_E= 7602.77 meV, MAE_F=  208.44 meV / A
2025-04-29 19:49:45.080 INFO: Epoch 0: head: validation, loss=0.36816878, MAE_E= 7587.83 meV, MAE_F=  200.84 meV / A
2025-04-29 19:49:47.816 INFO: Epoch 1: head: train, loss=0.40540294, MAE_E= 1370.31 meV, MAE_F=  224.80 meV / A
2025-04-29 19:49:48.514 INFO: Epoch 1: head: validation, loss=0.34941485, MAE_E= 1385.84 meV, MAE_F=  217.16 meV / A
2025-04-29 19:49:51.056 INFO: Epoch 2: head: train, loss=0.32730575, MAE_E= 3555.67 meV, MAE_F=  176.67 meV / A
2025-04-29 19:49:51.739 INFO: Epoch 2: head: validation, loss=0.28666643, MAE_E= 3566.63 meV, MAE_F=  170.93 meV / A
2025-04-29 19:49:54.271 INFO: Epoch 3: head: train, loss=0.16177891, MAE_E= 2297.21 meV, MAE_F=  152.01 meV / A
2025-04-29 19:49:54.968 INFO: Epoch 3: head: validation, loss=0.13178901, MAE_E= 2283.76 meV, MAE_F=  143.73 meV / A
2025-04-29 19:49:57.525 INFO: Epoch 4: head: train, loss=0.09976079, MAE_E= 4019.27 meV, MAE_F=  116.11 meV / A
2025-04-29 19:49:58.182 INFO: Epoch 4: head: validation, loss=0.08446903, MAE_E= 4009.12 meV, MAE_F=  111.53 meV / A
2025-04-29 19:50:00.787 INFO: Epoch 5: head: train, loss=0.05128884, MAE_E= 1027.98 meV, MAE_F=   94.53 meV / A
2025-04-29 19:50:01.459 INFO: Epoch 5: head: validation, loss=0.05150278, MAE_E= 1019.05 meV, MAE_F=   94.61 meV / A
2025-04-29 19:50:04.141 INFO: Epoch 6: head: train, loss=0.04709977, MAE_E= 1391.98 meV, MAE_F=   89.08 meV / A
2025-04-29 19:50:04.839 INFO: Epoch 6: head: validation, loss=0.04158192, MAE_E= 1383.21 meV, MAE_F=   86.45 meV / A
2025-04-29 19:50:07.497 INFO: Epoch 7: head: train, loss=0.02960103, MAE_E=  440.36 meV, MAE_F=   70.65 meV / A
2025-04-29 19:50:08.146 INFO: Epoch 7: head: validation, loss=0.02742789, MAE_E=  434.86 meV, MAE_F=   69.47 meV / A
2025-04-29 19:50:10.717 INFO: Epoch 8: head: train, loss=0.03769821, MAE_E= 2631.42 meV, MAE_F=   77.32 meV / A
2025-04-29 19:50:11.339 INFO: Epoch 8: head: validation, loss=0.03670343, MAE_E= 2634.65 meV, MAE_F=   76.88 meV / A
2025-04-29 19:50:13.946 INFO: Epoch 9: head: train, loss=0.04441773, MAE_E= 1669.32 meV, MAE_F=   77.25 meV / A
2025-04-29 19:50:14.633 INFO: Epoch 9: head: validation, loss=0.04649424, MAE_E= 1669.37 meV, MAE_F=   77.89 meV / A
2025-04-29 19:50:17.153 INFO: Epoch 10: head: train, loss=0.03525364, MAE_E=  933.60 meV, MAE_F=   73.94 meV / A
2025-04-29 19:50:17.821 INFO: Epoch 10: head: validation, loss=0.03578009, MAE_E=  935.59 meV, MAE_F=   73.90 meV / A
2025-04-29 19:50:20.437 INFO: Epoch 11: head: train, loss=0.14279609, MAE_E= 4877.21 meV, MAE_F=  151.70 meV / A
2025-04-29 19:50:21.096 INFO: Epoch 11: head: validation, loss=0.14202472, MAE_E= 4881.38 meV, MAE_F=  150.55 meV / A
2025-04-29 19:50:23.525 INFO: Epoch 12: head: train, loss=0.17818693, MAE_E= 1544.34 meV, MAE_F=  174.24 meV / A
2025-04-29 19:50:24.164 INFO: Epoch 12: head: validation, loss=0.17676460, MAE_E= 1550.83 meV, MAE_F=  172.87 meV / A
2025-04-29 19:50:26.721 INFO: Epoch 13: head: train, loss=0.06301827, MAE_E=  500.43 meV, MAE_F=   96.12 meV / A
2025-04-29 19:50:27.358 INFO: Epoch 13: head: validation, loss=0.05170083, MAE_E=  489.55 meV, MAE_F=   90.68 meV / A
2025-04-29 19:50:29.896 INFO: Epoch 14: head: train, loss=0.07467526, MAE_E=   51.21 meV, MAE_F=   95.83 meV / A
2025-04-29 19:50:30.648 INFO: Epoch 14: head: validation, loss=0.06373421, MAE_E=   44.41 meV, MAE_F=   89.94 meV / A
2025-04-29 19:50:33.315 INFO: Epoch 15: head: train, loss=0.08699957, MAE_E=  741.48 meV, MAE_F=  102.40 meV / A
2025-04-29 19:50:33.940 INFO: Epoch 15: head: validation, loss=0.08270363, MAE_E=  752.18 meV, MAE_F=   98.41 meV / A
2025-04-29 19:50:36.477 INFO: Epoch 16: head: train, loss=0.06236330, MAE_E= 1056.29 meV, MAE_F=   95.49 meV / A
2025-04-29 19:50:37.092 INFO: Epoch 16: head: validation, loss=0.05738464, MAE_E= 1066.24 meV, MAE_F=   90.94 meV / A
2025-04-29 19:50:39.693 INFO: Epoch 17: head: train, loss=0.10054697, MAE_E= 1199.67 meV, MAE_F=   91.96 meV / A
2025-04-29 19:50:40.369 INFO: Epoch 17: head: validation, loss=0.10005712, MAE_E= 1208.31 meV, MAE_F=   89.70 meV / A
2025-04-29 19:50:42.899 INFO: Epoch 18: head: train, loss=0.07867886, MAE_E=  982.23 meV, MAE_F=   84.58 meV / A
2025-04-29 19:50:43.578 INFO: Epoch 18: head: validation, loss=0.07927782, MAE_E=  988.57 meV, MAE_F=   83.01 meV / A
2025-04-29 19:50:46.198 INFO: Epoch 19: head: train, loss=0.06119255, MAE_E=  767.51 meV, MAE_F=   91.57 meV / A
2025-04-29 19:50:46.855 INFO: Epoch 19: head: validation, loss=0.06399815, MAE_E=  761.61 meV, MAE_F=   91.48 meV / A
2025-04-29 19:50:49.461 INFO: Epoch 20: head: train, loss=0.14175474, MAE_E= 1263.40 meV, MAE_F=  110.21 meV / A
2025-04-29 19:50:50.149 INFO: Epoch 20: head: validation, loss=0.13341513, MAE_E= 1252.56 meV, MAE_F=  105.19 meV / A
2025-04-29 19:50:52.653 INFO: Epoch 21: head: train, loss=0.12484753, MAE_E= 2036.26 meV, MAE_F=  122.11 meV / A
2025-04-29 19:50:53.311 INFO: Epoch 21: head: validation, loss=0.11761656, MAE_E= 2049.96 meV, MAE_F=  118.30 meV / A
2025-04-29 19:50:55.877 INFO: Epoch 22: head: train, loss=0.07205179, MAE_E=  518.34 meV, MAE_F=   98.80 meV / A
2025-04-29 19:50:56.532 INFO: Epoch 22: head: validation, loss=0.05921182, MAE_E=  506.51 meV, MAE_F=   92.59 meV / A
2025-04-29 19:50:59.045 INFO: Epoch 23: head: train, loss=0.05988282, MAE_E= 1743.75 meV, MAE_F=   93.11 meV / A
2025-04-29 19:50:59.753 INFO: Epoch 23: head: validation, loss=0.04860334, MAE_E= 1755.03 meV, MAE_F=   87.16 meV / A
2025-04-29 19:51:02.243 INFO: Epoch 24: head: train, loss=0.05599542, MAE_E= 1848.23 meV, MAE_F=   87.79 meV / A
2025-04-29 19:51:02.891 INFO: Epoch 24: head: validation, loss=0.04929012, MAE_E= 1856.19 meV, MAE_F=   82.83 meV / A
2025-04-29 19:51:05.436 INFO: Epoch 25: head: train, loss=0.05353132, MAE_E= 1282.74 meV, MAE_F=   81.83 meV / A
2025-04-29 19:51:06.177 INFO: Epoch 25: head: validation, loss=0.04946220, MAE_E= 1290.86 meV, MAE_F=   77.79 meV / A
2025-04-29 19:51:08.756 INFO: Epoch 26: head: train, loss=0.04663015, MAE_E= 1238.54 meV, MAE_F=   80.42 meV / A
2025-04-29 19:51:09.431 INFO: Epoch 26: head: validation, loss=0.04390166, MAE_E= 1246.09 meV, MAE_F=   77.13 meV / A
2025-04-29 19:51:12.029 INFO: Epoch 27: head: train, loss=0.03642594, MAE_E=  952.79 meV, MAE_F=   76.32 meV / A
2025-04-29 19:51:12.800 INFO: Epoch 27: head: validation, loss=0.03605664, MAE_E=  958.85 meV, MAE_F=   74.49 meV / A
2025-04-29 19:51:12.800 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:51:12.800 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.7695], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:51:12.803 INFO: 
2025-04-29 19:51:12.803 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:51:12.803 INFO: eveluation
2025-04-29 19:51:12.803 INFO: The scale is [0.7694964] and shift is 0.0
2025-04-29 19:51:12.947 INFO: Energy Mean: -64251.36163194444, Variance: 0.08651902187017746
2025-04-29 19:51:13.227 INFO: Energy RMSE: 0.16914257407188416
2025-04-29 19:51:13.228 INFO: Energy R2: 0.6693303782084857
2025-04-29 19:51:13.228 INFO: Energy MAE: 0.16553819179534912
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:51:13.229 INFO: Forces RMSE: 0.2923350359927171
2025-04-29 19:51:13.229 INFO: Forces R2: 0.9862661225117559
2025-04-29 19:51:13.785 INFO: Energy Mean: -64251.35109592014, Variance: 0.11323580694787297
2025-04-29 19:51:13.898 INFO: Loading checkpoint: results/latent_charge_embed/bi11-3_logs//sample_3//checkpoints/bi11-3_run-123_epoch-7.pt
2025-04-29 19:51:13.944 INFO: Loaded Stage one model from epoch 7 for evaluation
2025-04-29 19:51:13.944 INFO: Saving model to results/latent_charge_embed/bi11-3_logs/sample_3/checkpoints/bi11-3_run-123.model
2025-04-29 19:51:14.108 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi11-3_logs/sample_3/bi11-3_compiled.model
2025-04-29 19:51:14.196 INFO: Done
Loading saved bootstrap sample 4
Training model 4
Using latent charge and penalty 1
2025-04-29 19:51:14.605 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:51:14.605 INFO: MACE version: 0.3.10
2025-04-29 19:51:14.606 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:51:14.611 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:51:14.611 INFO: Using heads: ['default']
2025-04-29 19:51:14.611 INFO: =============    Processing head default     ===========
2025-04-29 19:51:14.611 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:51:14.620 INFO: Atomic Numbers used: [83]
2025-04-29 19:51:14.620 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5841.032740490848}}
2025-04-29 19:51:14.624 INFO: Atomic Energies used (z: eV) for head default: {83: -5841.032740490848}
2025-04-29 19:51:14.744 INFO: Computing average number of neighbors
2025-04-29 19:51:15.320 INFO: Average number of neighbors: 10.0
2025-04-29 19:51:15.320 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:51:15.320 INFO: ===========MODEL DETAILS===========
2025-04-29 19:51:15.322 INFO: Building model
2025-04-29 19:51:15.322 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:51:15.322 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:51:15.322 INFO: 8 radial and 5 basis functions
2025-04-29 19:51:15.322 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:51:15.322 INFO: Distance transform for radial basis functions: None
2025-04-29 19:51:15.322 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:51:15.906 INFO: Mean: 8.315129321278259e-05, Std: [0.75694559]
0.0 [0.75694559]
2025-04-29 19:51:15.907 INFO: Scale: [0.75694559], Shift: 0.0
2025-04-29 19:51:17.042 INFO: Total number of parameters: 509618
2025-04-29 19:51:17.042 INFO: 
2025-04-29 19:51:17.042 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:51:17.042 INFO: Using ADAM as parameter optimizer
2025-04-29 19:51:17.042 INFO: Batch size: 32
2025-04-29 19:51:17.042 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:51:17.042 INFO: Number of gradient updates: 2250
2025-04-29 19:51:17.042 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:51:17.042 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 19:51:17.044 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:51:17.044 INFO: 
2025-04-29 19:51:17.044 INFO: ===========TRAINING===========
2025-04-29 19:51:17.044 INFO: Started training, reporting errors on validation set
2025-04-29 19:51:17.044 INFO: Loss metrics on validation set
2025-04-29 19:51:17.949 INFO: Initial: head: validation, loss=3.78220378, MAE_E=32000.58 meV, MAE_F=  588.80 meV / A
2025-04-29 19:51:20.471 INFO: Epoch 0: head: train, loss=0.39582765, MAE_E= 7739.12 meV, MAE_F=  207.34 meV / A
2025-04-29 19:51:21.290 INFO: Epoch 0: head: validation, loss=0.41009611, MAE_E= 7732.00 meV, MAE_F=  207.35 meV / A
2025-04-29 19:51:23.824 INFO: Epoch 1: head: train, loss=0.36572769, MAE_E=  631.54 meV, MAE_F=  231.39 meV / A
2025-04-29 19:51:24.475 INFO: Epoch 1: head: validation, loss=0.38019966, MAE_E=  635.30 meV, MAE_F=  228.98 meV / A
2025-04-29 19:51:27.114 INFO: Epoch 2: head: train, loss=0.13705457, MAE_E= 2961.12 meV, MAE_F=  149.53 meV / A
2025-04-29 19:51:27.774 INFO: Epoch 2: head: validation, loss=0.14385124, MAE_E= 2969.18 meV, MAE_F=  150.49 meV / A
2025-04-29 19:51:30.453 INFO: Epoch 3: head: train, loss=0.14258036, MAE_E= 4865.52 meV, MAE_F=  142.41 meV / A
2025-04-29 19:51:31.113 INFO: Epoch 3: head: validation, loss=0.14671014, MAE_E= 4869.15 meV, MAE_F=  140.79 meV / A
2025-04-29 19:51:33.657 INFO: Epoch 4: head: train, loss=0.07866573, MAE_E=  904.54 meV, MAE_F=   96.82 meV / A
2025-04-29 19:51:34.323 INFO: Epoch 4: head: validation, loss=0.08347356, MAE_E=  897.45 meV, MAE_F=   97.50 meV / A
2025-04-29 19:51:36.971 INFO: Epoch 5: head: train, loss=0.11993087, MAE_E= 6439.97 meV, MAE_F=  118.71 meV / A
2025-04-29 19:51:37.586 INFO: Epoch 5: head: validation, loss=0.12317731, MAE_E= 6433.64 meV, MAE_F=  116.67 meV / A
2025-04-29 19:51:40.576 INFO: Epoch 6: head: train, loss=0.04955005, MAE_E= 1100.12 meV, MAE_F=   88.66 meV / A
2025-04-29 19:51:41.270 INFO: Epoch 6: head: validation, loss=0.05194634, MAE_E= 1092.06 meV, MAE_F=   88.11 meV / A
2025-04-29 19:51:43.914 INFO: Epoch 7: head: train, loss=0.04904783, MAE_E= 4594.16 meV, MAE_F=   90.24 meV / A
2025-04-29 19:51:44.591 INFO: Epoch 7: head: validation, loss=0.05319647, MAE_E= 4587.18 meV, MAE_F=   90.83 meV / A
2025-04-29 19:51:47.092 INFO: Epoch 8: head: train, loss=0.04943298, MAE_E=  189.51 meV, MAE_F=   98.61 meV / A
2025-04-29 19:51:47.759 INFO: Epoch 8: head: validation, loss=0.05524924, MAE_E=  200.64 meV, MAE_F=  100.04 meV / A
2025-04-29 19:51:50.450 INFO: Epoch 9: head: train, loss=0.04339265, MAE_E=  199.74 meV, MAE_F=   92.73 meV / A
2025-04-29 19:51:51.123 INFO: Epoch 9: head: validation, loss=0.04989249, MAE_E=  209.00 meV, MAE_F=   95.21 meV / A
2025-04-29 19:51:53.684 INFO: Epoch 10: head: train, loss=0.02908586, MAE_E=  813.14 meV, MAE_F=   72.28 meV / A
2025-04-29 19:51:54.340 INFO: Epoch 10: head: validation, loss=0.03292477, MAE_E=  804.79 meV, MAE_F=   74.03 meV / A
2025-04-29 19:51:56.911 INFO: Epoch 11: head: train, loss=0.04158970, MAE_E= 2852.18 meV, MAE_F=   83.72 meV / A
2025-04-29 19:51:57.583 INFO: Epoch 11: head: validation, loss=0.04419571, MAE_E= 2858.21 meV, MAE_F=   83.39 meV / A
2025-04-29 19:52:00.360 INFO: Epoch 12: head: train, loss=0.04431419, MAE_E=  233.77 meV, MAE_F=   74.48 meV / A
2025-04-29 19:52:01.005 INFO: Epoch 12: head: validation, loss=0.04609296, MAE_E=  226.05 meV, MAE_F=   73.80 meV / A
2025-04-29 19:52:03.585 INFO: Epoch 13: head: train, loss=0.02955002, MAE_E=  592.71 meV, MAE_F=   71.23 meV / A
2025-04-29 19:52:04.212 INFO: Epoch 13: head: validation, loss=0.03170365, MAE_E=  600.13 meV, MAE_F=   70.93 meV / A
2025-04-29 19:52:06.839 INFO: Epoch 14: head: train, loss=0.02679347, MAE_E=   32.70 meV, MAE_F=   66.53 meV / A
2025-04-29 19:52:07.446 INFO: Epoch 14: head: validation, loss=0.02945155, MAE_E=   37.34 meV, MAE_F=   67.33 meV / A
2025-04-29 19:52:10.163 INFO: Epoch 15: head: train, loss=0.02520866, MAE_E=  164.06 meV, MAE_F=   63.34 meV / A
2025-04-29 19:52:10.892 INFO: Epoch 15: head: validation, loss=0.02888799, MAE_E=  172.52 meV, MAE_F=   65.92 meV / A
2025-04-29 19:52:13.573 INFO: Epoch 16: head: train, loss=0.02527987, MAE_E=   25.89 meV, MAE_F=   60.48 meV / A
2025-04-29 19:52:14.260 INFO: Epoch 16: head: validation, loss=0.02833955, MAE_E=   27.48 meV, MAE_F=   62.58 meV / A
2025-04-29 19:52:16.927 INFO: Epoch 17: head: train, loss=0.02509619, MAE_E=  875.03 meV, MAE_F=   64.53 meV / A
2025-04-29 19:52:17.616 INFO: Epoch 17: head: validation, loss=0.02975831, MAE_E=  866.00 meV, MAE_F=   68.25 meV / A
2025-04-29 19:52:20.296 INFO: Epoch 18: head: train, loss=0.23175912, MAE_E=12354.84 meV, MAE_F=  141.82 meV / A
2025-04-29 19:52:20.995 INFO: Epoch 18: head: validation, loss=0.24655433, MAE_E=12364.30 meV, MAE_F=  144.81 meV / A
2025-04-29 19:52:23.487 INFO: Epoch 19: head: train, loss=0.30532176, MAE_E=15382.55 meV, MAE_F=  126.86 meV / A
2025-04-29 19:52:24.198 INFO: Epoch 19: head: validation, loss=0.31778890, MAE_E=15392.73 meV, MAE_F=  128.67 meV / A
2025-04-29 19:52:26.714 INFO: Epoch 20: head: train, loss=0.21545907, MAE_E=11318.47 meV, MAE_F=  123.71 meV / A
2025-04-29 19:52:27.390 INFO: Epoch 20: head: validation, loss=0.22486335, MAE_E=11327.98 meV, MAE_F=  125.05 meV / A
2025-04-29 19:52:29.986 INFO: Epoch 21: head: train, loss=0.19641428, MAE_E= 9298.05 meV, MAE_F=  113.63 meV / A
2025-04-29 19:52:30.644 INFO: Epoch 21: head: validation, loss=0.20418586, MAE_E= 9307.07 meV, MAE_F=  115.08 meV / A
2025-04-29 19:52:33.207 INFO: Epoch 22: head: train, loss=0.30407923, MAE_E= 8437.79 meV, MAE_F=  120.89 meV / A
2025-04-29 19:52:33.925 INFO: Epoch 22: head: validation, loss=0.31537644, MAE_E= 8448.17 meV, MAE_F=  124.17 meV / A
2025-04-29 19:52:36.565 INFO: Epoch 23: head: train, loss=0.25288295, MAE_E= 6718.25 meV, MAE_F=  114.18 meV / A
2025-04-29 19:52:37.226 INFO: Epoch 23: head: validation, loss=0.26372367, MAE_E= 6728.87 meV, MAE_F=  117.90 meV / A
2025-04-29 19:52:39.773 INFO: Epoch 24: head: train, loss=0.15974930, MAE_E= 4962.80 meV, MAE_F=   96.15 meV / A
2025-04-29 19:52:40.548 INFO: Epoch 24: head: validation, loss=0.16725899, MAE_E= 4972.30 meV, MAE_F=   99.27 meV / A
2025-04-29 19:52:43.253 INFO: Epoch 25: head: train, loss=0.09594053, MAE_E= 3594.59 meV, MAE_F=   82.14 meV / A
2025-04-29 19:52:44.032 INFO: Epoch 25: head: validation, loss=0.10172967, MAE_E= 3603.42 meV, MAE_F=   85.14 meV / A
2025-04-29 19:52:46.697 INFO: Epoch 26: head: train, loss=0.06260465, MAE_E= 2473.54 meV, MAE_F=   75.79 meV / A
2025-04-29 19:52:47.392 INFO: Epoch 26: head: validation, loss=0.06716289, MAE_E= 2481.30 meV, MAE_F=   78.34 meV / A
2025-04-29 19:52:50.075 INFO: Epoch 27: head: train, loss=0.04432248, MAE_E= 1678.44 meV, MAE_F=   71.76 meV / A
2025-04-29 19:52:50.817 INFO: Epoch 27: head: validation, loss=0.04852954, MAE_E= 1686.29 meV, MAE_F=   74.19 meV / A
2025-04-29 19:52:53.493 INFO: Epoch 28: head: train, loss=0.03305336, MAE_E= 1174.63 meV, MAE_F=   67.34 meV / A
2025-04-29 19:52:54.165 INFO: Epoch 28: head: validation, loss=0.03704754, MAE_E= 1182.61 meV, MAE_F=   69.99 meV / A
2025-04-29 19:52:56.732 INFO: Epoch 29: head: train, loss=0.02658423, MAE_E=  836.97 meV, MAE_F=   64.09 meV / A
2025-04-29 19:52:57.385 INFO: Epoch 29: head: validation, loss=0.03019521, MAE_E=  844.12 meV, MAE_F=   66.71 meV / A
2025-04-29 19:53:00.000 INFO: Epoch 30: head: train, loss=0.02288771, MAE_E=  599.81 meV, MAE_F=   61.35 meV / A
2025-04-29 19:53:00.752 INFO: Epoch 30: head: validation, loss=0.02629786, MAE_E=  607.23 meV, MAE_F=   64.09 meV / A
2025-04-29 19:53:03.348 INFO: Epoch 31: head: train, loss=0.02061493, MAE_E=  443.80 meV, MAE_F=   59.18 meV / A
2025-04-29 19:53:04.042 INFO: Epoch 31: head: validation, loss=0.02374789, MAE_E=  451.13 meV, MAE_F=   61.80 meV / A
2025-04-29 19:53:06.619 INFO: Epoch 32: head: train, loss=0.01924031, MAE_E=  353.53 meV, MAE_F=   57.52 meV / A
2025-04-29 19:53:07.352 INFO: Epoch 32: head: validation, loss=0.02202899, MAE_E=  360.23 meV, MAE_F=   59.90 meV / A
2025-04-29 19:53:09.858 INFO: Epoch 33: head: train, loss=0.01759978, MAE_E=  295.68 meV, MAE_F=   55.38 meV / A
2025-04-29 19:53:10.500 INFO: Epoch 33: head: validation, loss=0.02034067, MAE_E=  302.44 meV, MAE_F=   57.84 meV / A
2025-04-29 19:53:12.977 INFO: Epoch 34: head: train, loss=0.01654975, MAE_E=  257.72 meV, MAE_F=   54.03 meV / A
2025-04-29 19:53:13.633 INFO: Epoch 34: head: validation, loss=0.01902213, MAE_E=  263.84 meV, MAE_F=   56.34 meV / A
2025-04-29 19:53:16.126 INFO: Epoch 35: head: train, loss=0.01608848, MAE_E=  230.64 meV, MAE_F=   52.86 meV / A
2025-04-29 19:53:16.731 INFO: Epoch 35: head: validation, loss=0.01835645, MAE_E=  236.95 meV, MAE_F=   55.00 meV / A
2025-04-29 19:53:19.264 INFO: Epoch 36: head: train, loss=0.01753946, MAE_E=  123.53 meV, MAE_F=   51.98 meV / A
2025-04-29 19:53:20.025 INFO: Epoch 36: head: validation, loss=0.01963823, MAE_E=  129.28 meV, MAE_F=   53.76 meV / A
2025-04-29 19:53:22.518 INFO: Epoch 37: head: train, loss=0.03069952, MAE_E=  389.53 meV, MAE_F=   75.06 meV / A
2025-04-29 19:53:23.149 INFO: Epoch 37: head: validation, loss=0.03623398, MAE_E=  397.19 meV, MAE_F=   79.30 meV / A
2025-04-29 19:53:25.651 INFO: Epoch 38: head: train, loss=0.09056113, MAE_E= 1441.40 meV, MAE_F=  129.41 meV / A
2025-04-29 19:53:26.353 INFO: Epoch 38: head: validation, loss=0.10459034, MAE_E= 1451.59 meV, MAE_F=  134.90 meV / A
2025-04-29 19:53:28.981 INFO: Epoch 39: head: train, loss=0.09799853, MAE_E= 1396.31 meV, MAE_F=  135.90 meV / A
2025-04-29 19:53:29.660 INFO: Epoch 39: head: validation, loss=0.11231449, MAE_E= 1406.26 meV, MAE_F=  140.86 meV / A
2025-04-29 19:53:32.043 INFO: Epoch 40: head: train, loss=0.09000203, MAE_E= 1773.43 meV, MAE_F=  128.19 meV / A
2025-04-29 19:53:32.676 INFO: Epoch 40: head: validation, loss=0.10252329, MAE_E= 1782.57 meV, MAE_F=  132.26 meV / A
2025-04-29 19:53:35.083 INFO: Epoch 41: head: train, loss=0.07550093, MAE_E= 1882.80 meV, MAE_F=  114.73 meV / A
2025-04-29 19:53:35.738 INFO: Epoch 41: head: validation, loss=0.08597787, MAE_E= 1892.45 meV, MAE_F=  118.85 meV / A
2025-04-29 19:53:38.179 INFO: Epoch 42: head: train, loss=0.05382344, MAE_E= 2591.61 meV, MAE_F=   96.50 meV / A
2025-04-29 19:53:38.824 INFO: Epoch 42: head: validation, loss=0.06071643, MAE_E= 2599.81 meV, MAE_F=   99.63 meV / A
2025-04-29 19:53:41.327 INFO: Epoch 43: head: train, loss=0.07085854, MAE_E= 2180.59 meV, MAE_F=  110.94 meV / A
2025-04-29 19:53:41.979 INFO: Epoch 43: head: validation, loss=0.07916650, MAE_E= 2170.15 meV, MAE_F=  113.97 meV / A
2025-04-29 19:53:44.503 INFO: Epoch 44: head: train, loss=0.18726876, MAE_E= 4816.14 meV, MAE_F=  163.69 meV / A
2025-04-29 19:53:45.170 INFO: Epoch 44: head: validation, loss=0.20165669, MAE_E= 4804.07 meV, MAE_F=  166.84 meV / A
2025-04-29 19:53:47.593 INFO: Epoch 45: head: train, loss=0.18368825, MAE_E= 4026.48 meV, MAE_F=  178.08 meV / A
2025-04-29 19:53:48.373 INFO: Epoch 45: head: validation, loss=0.19933755, MAE_E= 4012.78 meV, MAE_F=  181.06 meV / A
2025-04-29 19:53:50.868 INFO: Epoch 46: head: train, loss=0.18857069, MAE_E= 4342.65 meV, MAE_F=  180.66 meV / A
2025-04-29 19:53:51.495 INFO: Epoch 46: head: validation, loss=0.20530641, MAE_E= 4328.01 meV, MAE_F=  184.10 meV / A
2025-04-29 19:53:54.013 INFO: Epoch 47: head: train, loss=0.17397644, MAE_E= 4103.80 meV, MAE_F=  172.80 meV / A
2025-04-29 19:53:54.663 INFO: Epoch 47: head: validation, loss=0.18921320, MAE_E= 4090.69 meV, MAE_F=  175.99 meV / A
2025-04-29 19:53:57.194 INFO: Epoch 48: head: train, loss=0.15078762, MAE_E= 3707.92 meV, MAE_F=  161.07 meV / A
2025-04-29 19:53:57.851 INFO: Epoch 48: head: validation, loss=0.16337613, MAE_E= 3695.54 meV, MAE_F=  163.52 meV / A
2025-04-29 19:54:00.504 INFO: Epoch 49: head: train, loss=0.12355002, MAE_E= 3296.41 meV, MAE_F=  148.20 meV / A
2025-04-29 19:54:01.125 INFO: Epoch 49: head: validation, loss=0.13572006, MAE_E= 3284.19 meV, MAE_F=  151.45 meV / A
2025-04-29 19:54:03.606 INFO: Epoch 50: head: train, loss=0.10491775, MAE_E= 3097.71 meV, MAE_F=  137.00 meV / A
2025-04-29 19:54:04.209 INFO: Epoch 50: head: validation, loss=0.11543635, MAE_E= 3085.87 meV, MAE_F=  140.02 meV / A
2025-04-29 19:54:06.680 INFO: Epoch 51: head: train, loss=0.08609604, MAE_E= 2620.42 meV, MAE_F=  125.31 meV / A
2025-04-29 19:54:07.332 INFO: Epoch 51: head: validation, loss=0.09542922, MAE_E= 2609.39 meV, MAE_F=  128.37 meV / A
2025-04-29 19:54:09.854 INFO: Epoch 52: head: train, loss=0.07493055, MAE_E= 2316.50 meV, MAE_F=  117.60 meV / A
2025-04-29 19:54:10.515 INFO: Epoch 52: head: validation, loss=0.08430497, MAE_E= 2303.62 meV, MAE_F=  121.46 meV / A
2025-04-29 19:54:13.027 INFO: Epoch 53: head: train, loss=0.06388834, MAE_E= 1964.06 meV, MAE_F=  109.89 meV / A
2025-04-29 19:54:13.714 INFO: Epoch 53: head: validation, loss=0.07222873, MAE_E= 1952.09 meV, MAE_F=  113.63 meV / A
2025-04-29 19:54:16.180 INFO: Epoch 54: head: train, loss=0.05191734, MAE_E= 1632.92 meV, MAE_F=   99.41 meV / A
2025-04-29 19:54:16.837 INFO: Epoch 54: head: validation, loss=0.05862605, MAE_E= 1622.21 meV, MAE_F=  102.50 meV / A
2025-04-29 19:54:19.342 INFO: Epoch 55: head: train, loss=0.06400905, MAE_E= 2144.22 meV, MAE_F=  110.10 meV / A
2025-04-29 19:54:20.104 INFO: Epoch 55: head: validation, loss=0.07278962, MAE_E= 2133.06 meV, MAE_F=  114.30 meV / A
2025-04-29 19:54:20.105 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:54:20.105 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.7569], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:54:20.109 INFO: 
2025-04-29 19:54:20.109 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:54:20.109 INFO: eveluation
2025-04-29 19:54:20.109 INFO: The scale is [0.75694559] and shift is 0.0
2025-04-29 19:54:20.248 INFO: Energy Mean: -64251.351822916666, Variance: 0.08483710394965278
2025-04-29 19:54:20.508 INFO: Energy RMSE: 4.5802388191223145
2025-04-29 19:54:20.508 INFO: Energy R2: -246.2807868109169
2025-04-29 19:54:20.508 INFO: Energy MAE: 4.577864646911621
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:54:20.509 INFO: Forces RMSE: 1.323367527521711
2025-04-29 19:54:20.509 INFO: Forces R2: 0.7238035560280884
2025-04-29 19:54:21.036 INFO: Energy Mean: -64251.3601453993, Variance: 0.1041147442805914
2025-04-29 19:54:21.157 INFO: Loading checkpoint: results/latent_charge_embed/bi11-3_logs//sample_4//checkpoints/bi11-3_run-123_epoch-35.pt
2025-04-29 19:54:21.204 INFO: Loaded Stage one model from epoch 35 for evaluation
2025-04-29 19:54:21.205 INFO: Saving model to results/latent_charge_embed/bi11-3_logs/sample_4/checkpoints/bi11-3_run-123.model
2025-04-29 19:54:21.368 INFO: Compiling model, saving metadata to results/latent_charge_embed/bi11-3_logs/sample_4/bi11-3_compiled.model
2025-04-29 19:54:21.457 INFO: Done

============================= JOB FEEDBACK =============================

Job ID: 3119736
Cluster: hk
User/Group: hv3694/hk-project-aimat2
Account: hk-project-aimat2
State: COMPLETED (exit code 0)
Partition: accelerated
Nodes: 1
Cores per node: 8
Nodelist: hkn0533
CPU Utilized: 00:19:59
CPU Efficiency: 21.11% of 01:34:40 core-walltime
Job Wall-clock time: 00:11:50
Starttime: Tue Apr 29 19:42:32 2025
Endtime: Tue Apr 29 19:54:22 2025
Memory Utilized: 2.00 GB
Memory Efficiency: 0.00% of 0.00 MB
Energy Consumed: 566244 Joule / 157.29 Watthours
Average node power draw: 797.52676056338 Watt
