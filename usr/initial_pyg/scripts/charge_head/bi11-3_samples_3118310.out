cuequivariance or cuequivariance_torch is not available. Cuequivariance acceleration will be disabled.
False
Results directory samples/ already exists. Exiting.
Reading data from:  ./raw/bi11-3_samples_parsed.csv
['./raw/bi11-3_samples_parsed.csv']
Reading data from:  ./raw/bi11-3_samples_parsed.csv
[-64251.033010993764]
(11, 3)
Loading saved bootstrap sample 0
Training model 0
Using latent charge and penalty 1
2025-04-29 14:20:59.094 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:20:59.095 INFO: MACE version: 0.3.10
2025-04-29 14:20:59.150 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:20:59.190 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:20:59.190 INFO: Using heads: ['default']
2025-04-29 14:20:59.190 INFO: =============    Processing head default     ===========
2025-04-29 14:20:59.190 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:20:59.198 INFO: Atomic Numbers used: [83]
2025-04-29 14:20:59.198 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.947697679924}}
2025-04-29 14:20:59.204 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.947697679924}
2025-04-29 14:20:59.323 INFO: Computing average number of neighbors
2025-04-29 14:21:01.564 INFO: Average number of neighbors: 9.993285123966942
2025-04-29 14:21:01.564 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:21:01.564 INFO: ===========MODEL DETAILS===========
2025-04-29 14:21:01.564 INFO: Building model
2025-04-29 14:21:01.564 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:21:01.564 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:21:01.564 INFO: 8 radial and 5 basis functions
2025-04-29 14:21:01.564 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:21:01.564 INFO: Distance transform for radial basis functions: None
2025-04-29 14:21:01.564 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:21:01.802 INFO: Mean: -0.0004194107252170237, Std: [0.5830243]
0.0 [0.5830243]
2025-04-29 14:21:01.803 INFO: Scale: [0.5830243], Shift: 0.0
2025-04-29 14:21:03.072 INFO: Total number of parameters: 509520
2025-04-29 14:21:03.072 INFO: 
2025-04-29 14:21:03.072 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:21:03.072 INFO: Using ADAM as parameter optimizer
2025-04-29 14:21:03.072 INFO: Batch size: 32
2025-04-29 14:21:03.072 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:21:03.072 INFO: Number of gradient updates: 2250
2025-04-29 14:21:03.072 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:21:03.073 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 14:21:03.074 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:21:03.074 INFO: 
2025-04-29 14:21:03.074 INFO: ===========TRAINING===========
2025-04-29 14:21:03.074 INFO: Started training, reporting errors on validation set
2025-04-29 14:21:03.074 INFO: Loss metrics on validation set
2025-04-29 14:21:05.614 INFO: Initial: head: validation, loss=24.95133095, MAE_E= 4494.56 meV, MAE_F=  381.26 meV / A
2025-04-29 14:21:17.601 INFO: Epoch 0: head: train, loss=1.38704717, MAE_E= 1736.54 meV, MAE_F=  365.23 meV / A
2025-04-29 14:21:18.381 INFO: Epoch 0: head: validation, loss=1.48679506, MAE_E= 1742.29 meV, MAE_F=  367.87 meV / A
2025-04-29 14:21:20.829 INFO: Epoch 1: head: train, loss=0.62165649, MAE_E= 1748.96 meV, MAE_F=  326.70 meV / A
2025-04-29 14:21:21.387 INFO: Epoch 1: head: validation, loss=0.72679189, MAE_E= 1760.02 meV, MAE_F=  332.37 meV / A
2025-04-29 14:21:23.690 INFO: Epoch 2: head: train, loss=0.54544480, MAE_E= 1885.63 meV, MAE_F=  313.03 meV / A
2025-04-29 14:21:24.420 INFO: Epoch 2: head: validation, loss=0.61794286, MAE_E= 1893.92 meV, MAE_F=  315.10 meV / A
2025-04-29 14:21:26.716 INFO: Epoch 3: head: train, loss=0.46835928, MAE_E= 2350.64 meV, MAE_F=  288.50 meV / A
2025-04-29 14:21:27.276 INFO: Epoch 3: head: validation, loss=0.51558996, MAE_E= 2350.52 meV, MAE_F=  287.83 meV / A
2025-04-29 14:21:29.605 INFO: Epoch 4: head: train, loss=0.40901353, MAE_E=  842.33 meV, MAE_F=  273.73 meV / A
2025-04-29 14:21:30.173 INFO: Epoch 4: head: validation, loss=0.44796247, MAE_E=  853.28 meV, MAE_F=  274.03 meV / A
2025-04-29 14:21:32.563 INFO: Epoch 5: head: train, loss=0.35842194, MAE_E=  302.46 meV, MAE_F=  260.42 meV / A
2025-04-29 14:21:33.121 INFO: Epoch 5: head: validation, loss=0.38010906, MAE_E=  293.80 meV, MAE_F=  257.99 meV / A
2025-04-29 14:21:35.408 INFO: Epoch 6: head: train, loss=0.32488751, MAE_E=  239.22 meV, MAE_F=  249.22 meV / A
2025-04-29 14:21:35.985 INFO: Epoch 6: head: validation, loss=0.34693141, MAE_E=  245.94 meV, MAE_F=  247.06 meV / A
2025-04-29 14:21:38.333 INFO: Epoch 7: head: train, loss=0.29177816, MAE_E=  364.23 meV, MAE_F=  237.28 meV / A
2025-04-29 14:21:38.874 INFO: Epoch 7: head: validation, loss=0.30725115, MAE_E=  378.81 meV, MAE_F=  233.59 meV / A
2025-04-29 14:21:41.197 INFO: Epoch 8: head: train, loss=0.26691089, MAE_E=  211.72 meV, MAE_F=  226.89 meV / A
2025-04-29 14:21:41.808 INFO: Epoch 8: head: validation, loss=0.28249898, MAE_E=  221.71 meV, MAE_F=  224.16 meV / A
2025-04-29 14:21:44.109 INFO: Epoch 9: head: train, loss=0.24077700, MAE_E=  216.06 meV, MAE_F=  215.59 meV / A
2025-04-29 14:21:44.690 INFO: Epoch 9: head: validation, loss=0.25635506, MAE_E=  219.96 meV, MAE_F=  213.22 meV / A
2025-04-29 14:21:47.015 INFO: Epoch 10: head: train, loss=0.21178999, MAE_E=  220.62 meV, MAE_F=  200.86 meV / A
2025-04-29 14:21:47.591 INFO: Epoch 10: head: validation, loss=0.22956188, MAE_E=  205.81 meV, MAE_F=  199.54 meV / A
2025-04-29 14:21:49.995 INFO: Epoch 11: head: train, loss=0.19387018, MAE_E=  214.11 meV, MAE_F=  192.06 meV / A
2025-04-29 14:21:50.587 INFO: Epoch 11: head: validation, loss=0.21448869, MAE_E=  197.05 meV, MAE_F=  192.27 meV / A
2025-04-29 14:21:53.096 INFO: Epoch 12: head: train, loss=0.34906996, MAE_E= 1299.71 meV, MAE_F=  254.62 meV / A
2025-04-29 14:21:53.728 INFO: Epoch 12: head: validation, loss=0.38387618, MAE_E= 1331.52 meV, MAE_F=  253.74 meV / A
2025-04-29 14:21:56.259 INFO: Epoch 13: head: train, loss=0.49944458, MAE_E=  984.08 meV, MAE_F=  301.06 meV / A
2025-04-29 14:21:56.794 INFO: Epoch 13: head: validation, loss=0.54467497, MAE_E=  976.56 meV, MAE_F=  300.36 meV / A
2025-04-29 14:21:59.065 INFO: Epoch 14: head: train, loss=0.57013608, MAE_E= 1182.00 meV, MAE_F=  314.00 meV / A
2025-04-29 14:21:59.620 INFO: Epoch 14: head: validation, loss=0.63010950, MAE_E= 1171.94 meV, MAE_F=  313.75 meV / A
2025-04-29 14:22:01.978 INFO: Epoch 15: head: train, loss=0.63280799, MAE_E=  965.70 meV, MAE_F=  326.41 meV / A
2025-04-29 14:22:02.524 INFO: Epoch 15: head: validation, loss=0.70562363, MAE_E=  962.80 meV, MAE_F=  327.14 meV / A
2025-04-29 14:22:04.891 INFO: Epoch 16: head: train, loss=0.53915238, MAE_E= 1609.22 meV, MAE_F=  306.46 meV / A
2025-04-29 14:22:05.562 INFO: Epoch 16: head: validation, loss=0.61691104, MAE_E= 1607.05 meV, MAE_F=  310.54 meV / A
2025-04-29 14:22:08.096 INFO: Epoch 17: head: train, loss=0.45877914, MAE_E=  739.74 meV, MAE_F=  286.65 meV / A
2025-04-29 14:22:08.774 INFO: Epoch 17: head: validation, loss=0.52813559, MAE_E=  732.15 meV, MAE_F=  291.08 meV / A
2025-04-29 14:22:11.191 INFO: Epoch 18: head: train, loss=0.40566340, MAE_E= 2327.20 meV, MAE_F=  272.93 meV / A
2025-04-29 14:22:11.725 INFO: Epoch 18: head: validation, loss=0.45927563, MAE_E= 2325.79 meV, MAE_F=  275.89 meV / A
2025-04-29 14:22:13.924 INFO: Epoch 19: head: train, loss=0.37555984, MAE_E=  977.63 meV, MAE_F=  265.63 meV / A
2025-04-29 14:22:14.567 INFO: Epoch 19: head: validation, loss=0.42072141, MAE_E=  977.34 meV, MAE_F=  267.83 meV / A
2025-04-29 14:22:16.871 INFO: Epoch 20: head: train, loss=0.36559981, MAE_E=  945.36 meV, MAE_F=  261.02 meV / A
2025-04-29 14:22:17.435 INFO: Epoch 20: head: validation, loss=0.40619422, MAE_E=  951.60 meV, MAE_F=  262.71 meV / A
2025-04-29 14:22:19.763 INFO: Epoch 21: head: train, loss=0.34148873, MAE_E=  949.64 meV, MAE_F=  253.39 meV / A
2025-04-29 14:22:20.417 INFO: Epoch 21: head: validation, loss=0.37419862, MAE_E=  944.19 meV, MAE_F=  253.83 meV / A
2025-04-29 14:22:22.946 INFO: Epoch 22: head: train, loss=0.31267854, MAE_E=  629.30 meV, MAE_F=  242.94 meV / A
2025-04-29 14:22:23.579 INFO: Epoch 22: head: validation, loss=0.34077939, MAE_E=  621.61 meV, MAE_F=  243.06 meV / A
2025-04-29 14:22:25.983 INFO: Epoch 23: head: train, loss=0.34420240, MAE_E=  791.03 meV, MAE_F=  252.59 meV / A
2025-04-29 14:22:26.545 INFO: Epoch 23: head: validation, loss=0.38187158, MAE_E=  801.32 meV, MAE_F=  254.39 meV / A
2025-04-29 14:22:28.855 INFO: Epoch 24: head: train, loss=0.37891120, MAE_E=  579.21 meV, MAE_F=  262.62 meV / A
2025-04-29 14:22:29.415 INFO: Epoch 24: head: validation, loss=0.42578008, MAE_E=  594.72 meV, MAE_F=  265.74 meV / A
2025-04-29 14:22:31.737 INFO: Epoch 25: head: train, loss=0.36287003, MAE_E=  390.20 meV, MAE_F=  257.61 meV / A
2025-04-29 14:22:32.400 INFO: Epoch 25: head: validation, loss=0.41030681, MAE_E=  388.37 meV, MAE_F=  261.44 meV / A
2025-04-29 14:22:34.739 INFO: Epoch 26: head: train, loss=0.32503453, MAE_E=  696.88 meV, MAE_F=  245.45 meV / A
2025-04-29 14:22:35.283 INFO: Epoch 26: head: validation, loss=0.36008640, MAE_E=  699.78 meV, MAE_F=  247.18 meV / A
2025-04-29 14:22:37.617 INFO: Epoch 27: head: train, loss=0.29728845, MAE_E=  378.20 meV, MAE_F=  235.93 meV / A
2025-04-29 14:22:38.208 INFO: Epoch 27: head: validation, loss=0.32808504, MAE_E=  375.70 meV, MAE_F=  237.07 meV / A
2025-04-29 14:22:40.572 INFO: Epoch 28: head: train, loss=0.30282724, MAE_E=  394.00 meV, MAE_F=  237.14 meV / A
2025-04-29 14:22:41.094 INFO: Epoch 28: head: validation, loss=0.33133850, MAE_E=  363.62 meV, MAE_F=  237.92 meV / A
2025-04-29 14:22:43.439 INFO: Epoch 29: head: train, loss=0.28887182, MAE_E=  389.32 meV, MAE_F=  232.36 meV / A
2025-04-29 14:22:44.086 INFO: Epoch 29: head: validation, loss=0.31415674, MAE_E=  376.13 meV, MAE_F=  232.33 meV / A
2025-04-29 14:22:46.510 INFO: Epoch 30: head: train, loss=0.26874462, MAE_E=  420.65 meV, MAE_F=  225.03 meV / A
2025-04-29 14:22:47.074 INFO: Epoch 30: head: validation, loss=0.29203427, MAE_E=  412.46 meV, MAE_F=  224.30 meV / A
2025-04-29 14:22:49.339 INFO: Epoch 31: head: train, loss=0.24875948, MAE_E=  312.58 meV, MAE_F=  217.17 meV / A
2025-04-29 14:22:50.002 INFO: Epoch 31: head: validation, loss=0.27011827, MAE_E=  292.26 meV, MAE_F=  215.90 meV / A
2025-04-29 14:22:50.002 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:22:50.002 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5830], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:22:50.021 INFO: 
2025-04-29 14:22:50.021 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:22:50.021 INFO: eveluation
2025-04-29 14:22:50.021 INFO: The scale is [0.5830243] and shift is 0.0
2025-04-29 14:22:50.153 INFO: Energy Mean: -64250.412890625, Variance: 0.16182164510091143
2025-04-29 14:22:50.410 INFO: Energy RMSE: 1.9646871089935303
2025-04-29 14:22:50.410 INFO: Energy R2: -22.85339335871515
2025-04-29 14:22:50.410 INFO: Energy MAE: 1.9505642652511597
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:22:50.411 INFO: Forces RMSE: 1.4454267369083569
2025-04-29 14:22:50.411 INFO: Forces R2: 0.45154050162980297
2025-04-29 14:22:50.931 INFO: Energy Mean: -64250.42467447917, Variance: 0.1520876185099284
2025-04-29 14:22:51.043 INFO: Loading checkpoint: results/charge_head/bi11-3_samples_logs//sample_0//checkpoints/bi11-3_samples_run-123_epoch-11.pt
2025-04-29 14:22:51.085 INFO: Loaded Stage one model from epoch 11 for evaluation
2025-04-29 14:22:51.085 INFO: Saving model to results/charge_head/bi11-3_samples_logs/sample_0/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:22:51.248 INFO: Compiling model, saving metadata to results/charge_head/bi11-3_samples_logs/sample_0/bi11-3_samples_compiled.model
2025-04-29 14:22:51.765 INFO: Done
Loading saved bootstrap sample 1
Training model 1
Using latent charge and penalty 1
2025-04-29 14:22:52.162 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:22:52.162 INFO: MACE version: 0.3.10
2025-04-29 14:22:52.162 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:22:52.167 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:22:52.167 INFO: Using heads: ['default']
2025-04-29 14:22:52.167 INFO: =============    Processing head default     ===========
2025-04-29 14:22:52.168 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:22:52.175 INFO: Atomic Numbers used: [83]
2025-04-29 14:22:52.175 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.9471699416035}}
2025-04-29 14:22:52.179 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.9471699416035}
2025-04-29 14:22:52.298 INFO: Computing average number of neighbors
2025-04-29 14:22:52.802 INFO: Average number of neighbors: 9.994834710743802
2025-04-29 14:22:52.803 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:22:52.803 INFO: ===========MODEL DETAILS===========
2025-04-29 14:22:52.805 INFO: Building model
2025-04-29 14:22:52.805 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:22:52.805 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:22:52.805 INFO: 8 radial and 5 basis functions
2025-04-29 14:22:52.805 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:22:52.805 INFO: Distance transform for radial basis functions: None
2025-04-29 14:22:52.805 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:22:53.300 INFO: Mean: 8.086457590943835e-05, Std: [0.59166257]
0.0 [0.59166257]
2025-04-29 14:22:53.301 INFO: Scale: [0.59166257], Shift: 0.0
2025-04-29 14:22:54.615 INFO: Total number of parameters: 509520
2025-04-29 14:22:54.615 INFO: 
2025-04-29 14:22:54.615 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:22:54.615 INFO: Using ADAM as parameter optimizer
2025-04-29 14:22:54.615 INFO: Batch size: 32
2025-04-29 14:22:54.615 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:22:54.615 INFO: Number of gradient updates: 2250
2025-04-29 14:22:54.615 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:22:54.615 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 14:22:54.616 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:22:54.616 INFO: 
2025-04-29 14:22:54.616 INFO: ===========TRAINING===========
2025-04-29 14:22:54.616 INFO: Started training, reporting errors on validation set
2025-04-29 14:22:54.617 INFO: Loss metrics on validation set
2025-04-29 14:22:55.508 INFO: Initial: head: validation, loss=24.88346805, MAE_E= 4540.09 meV, MAE_F=  383.27 meV / A
2025-04-29 14:22:58.222 INFO: Epoch 0: head: train, loss=1.43898993, MAE_E= 1347.75 meV, MAE_F=  378.83 meV / A
2025-04-29 14:22:59.066 INFO: Epoch 0: head: validation, loss=1.43994919, MAE_E= 1335.32 meV, MAE_F=  376.37 meV / A
2025-04-29 14:23:01.502 INFO: Epoch 1: head: train, loss=0.65914681, MAE_E= 6403.02 meV, MAE_F=  339.91 meV / A
2025-04-29 14:23:02.238 INFO: Epoch 1: head: validation, loss=0.68944127, MAE_E= 6377.46 meV, MAE_F=  342.42 meV / A
2025-04-29 14:23:04.842 INFO: Epoch 2: head: train, loss=0.54092423, MAE_E=11779.70 meV, MAE_F=  307.13 meV / A
2025-04-29 14:23:05.477 INFO: Epoch 2: head: validation, loss=0.58372413, MAE_E=11783.88 meV, MAE_F=  310.72 meV / A
2025-04-29 14:23:07.979 INFO: Epoch 3: head: train, loss=0.44633802, MAE_E= 4546.31 meV, MAE_F=  286.86 meV / A
2025-04-29 14:23:08.718 INFO: Epoch 3: head: validation, loss=0.48656843, MAE_E= 4564.54 meV, MAE_F=  293.03 meV / A
2025-04-29 14:23:11.295 INFO: Epoch 4: head: train, loss=0.42492053, MAE_E= 4443.74 meV, MAE_F=  284.85 meV / A
2025-04-29 14:23:12.008 INFO: Epoch 4: head: validation, loss=0.47473476, MAE_E= 4464.63 meV, MAE_F=  289.14 meV / A
2025-04-29 14:23:14.493 INFO: Epoch 5: head: train, loss=0.34979056, MAE_E= 1969.23 meV, MAE_F=  255.98 meV / A
2025-04-29 14:23:15.125 INFO: Epoch 5: head: validation, loss=0.39071508, MAE_E= 1986.39 meV, MAE_F=  259.02 meV / A
2025-04-29 14:23:17.642 INFO: Epoch 6: head: train, loss=0.31442010, MAE_E= 1051.23 meV, MAE_F=  244.91 meV / A
2025-04-29 14:23:18.274 INFO: Epoch 6: head: validation, loss=0.34577341, MAE_E= 1045.02 meV, MAE_F=  245.57 meV / A
2025-04-29 14:23:20.881 INFO: Epoch 7: head: train, loss=0.29273842, MAE_E=  302.26 meV, MAE_F=  237.46 meV / A
2025-04-29 14:23:21.492 INFO: Epoch 7: head: validation, loss=0.32174598, MAE_E=  297.70 meV, MAE_F=  237.93 meV / A
2025-04-29 14:23:24.064 INFO: Epoch 8: head: train, loss=0.27217292, MAE_E=  444.14 meV, MAE_F=  229.58 meV / A
2025-04-29 14:23:24.849 INFO: Epoch 8: head: validation, loss=0.29774927, MAE_E=  448.73 meV, MAE_F=  229.97 meV / A
2025-04-29 14:23:27.432 INFO: Epoch 9: head: train, loss=0.26296071, MAE_E=  505.70 meV, MAE_F=  224.79 meV / A
2025-04-29 14:23:28.087 INFO: Epoch 9: head: validation, loss=0.29057246, MAE_E=  493.54 meV, MAE_F=  226.14 meV / A
2025-04-29 14:23:30.565 INFO: Epoch 10: head: train, loss=0.24814659, MAE_E=  210.93 meV, MAE_F=  218.61 meV / A
2025-04-29 14:23:31.173 INFO: Epoch 10: head: validation, loss=0.27404310, MAE_E=  193.89 meV, MAE_F=  219.85 meV / A
2025-04-29 14:23:33.703 INFO: Epoch 11: head: train, loss=0.23677862, MAE_E=  195.29 meV, MAE_F=  213.24 meV / A
2025-04-29 14:23:34.378 INFO: Epoch 11: head: validation, loss=0.26143628, MAE_E=  183.46 meV, MAE_F=  214.60 meV / A
2025-04-29 14:23:36.821 INFO: Epoch 12: head: train, loss=0.22389830, MAE_E=  283.36 meV, MAE_F=  206.82 meV / A
2025-04-29 14:23:37.410 INFO: Epoch 12: head: validation, loss=0.24828445, MAE_E=  281.68 meV, MAE_F=  208.49 meV / A
2025-04-29 14:23:39.840 INFO: Epoch 13: head: train, loss=0.21013968, MAE_E=  196.95 meV, MAE_F=  199.81 meV / A
2025-04-29 14:23:40.452 INFO: Epoch 13: head: validation, loss=0.23234716, MAE_E=  194.05 meV, MAE_F=  201.49 meV / A
2025-04-29 14:23:42.910 INFO: Epoch 14: head: train, loss=0.19086690, MAE_E=  193.26 meV, MAE_F=  189.92 meV / A
2025-04-29 14:23:43.532 INFO: Epoch 14: head: validation, loss=0.21488561, MAE_E=  193.31 meV, MAE_F=  193.35 meV / A
2025-04-29 14:23:45.949 INFO: Epoch 15: head: train, loss=0.17653964, MAE_E=  188.88 meV, MAE_F=  181.90 meV / A
2025-04-29 14:23:46.692 INFO: Epoch 15: head: validation, loss=0.19789923, MAE_E=  189.48 meV, MAE_F=  185.37 meV / A
2025-04-29 14:23:49.208 INFO: Epoch 16: head: train, loss=0.16409430, MAE_E=  170.99 meV, MAE_F=  175.38 meV / A
2025-04-29 14:23:49.845 INFO: Epoch 16: head: validation, loss=0.18504001, MAE_E=  175.44 meV, MAE_F=  179.09 meV / A
2025-04-29 14:23:52.438 INFO: Epoch 17: head: train, loss=0.15715016, MAE_E=  167.95 meV, MAE_F=  171.54 meV / A
2025-04-29 14:23:53.075 INFO: Epoch 17: head: validation, loss=0.17776241, MAE_E=  174.60 meV, MAE_F=  175.22 meV / A
2025-04-29 14:23:55.522 INFO: Epoch 18: head: train, loss=0.15109836, MAE_E=  161.65 meV, MAE_F=  168.46 meV / A
2025-04-29 14:23:56.217 INFO: Epoch 18: head: validation, loss=0.17247770, MAE_E=  166.56 meV, MAE_F=  172.72 meV / A
2025-04-29 14:23:58.702 INFO: Epoch 19: head: train, loss=0.14533575, MAE_E=  152.08 meV, MAE_F=  165.39 meV / A
2025-04-29 14:23:59.334 INFO: Epoch 19: head: validation, loss=0.16640636, MAE_E=  165.47 meV, MAE_F=  169.32 meV / A
2025-04-29 14:24:01.746 INFO: Epoch 20: head: train, loss=0.14135533, MAE_E=  147.65 meV, MAE_F=  162.86 meV / A
2025-04-29 14:24:02.439 INFO: Epoch 20: head: validation, loss=0.16220975, MAE_E=  154.28 meV, MAE_F=  167.03 meV / A
2025-04-29 14:24:05.034 INFO: Epoch 21: head: train, loss=0.13664769, MAE_E=  142.90 meV, MAE_F=  160.07 meV / A
2025-04-29 14:24:05.777 INFO: Epoch 21: head: validation, loss=0.15689215, MAE_E=  149.51 meV, MAE_F=  164.41 meV / A
2025-04-29 14:24:08.375 INFO: Epoch 22: head: train, loss=0.13198679, MAE_E=  136.72 meV, MAE_F=  157.18 meV / A
2025-04-29 14:24:09.070 INFO: Epoch 22: head: validation, loss=0.15307421, MAE_E=  146.46 meV, MAE_F=  162.29 meV / A
2025-04-29 14:24:11.520 INFO: Epoch 23: head: train, loss=0.12863808, MAE_E=  138.61 meV, MAE_F=  154.84 meV / A
2025-04-29 14:24:12.135 INFO: Epoch 23: head: validation, loss=0.14859024, MAE_E=  141.52 meV, MAE_F=  159.71 meV / A
2025-04-29 14:24:14.718 INFO: Epoch 24: head: train, loss=0.12448913, MAE_E=  133.19 meV, MAE_F=  152.51 meV / A
2025-04-29 14:24:15.343 INFO: Epoch 24: head: validation, loss=0.14416250, MAE_E=  143.94 meV, MAE_F=  157.16 meV / A
2025-04-29 14:24:17.877 INFO: Epoch 25: head: train, loss=0.12065249, MAE_E=  128.73 meV, MAE_F=  149.73 meV / A
2025-04-29 14:24:18.534 INFO: Epoch 25: head: validation, loss=0.14041365, MAE_E=  141.49 meV, MAE_F=  154.82 meV / A
2025-04-29 14:24:21.236 INFO: Epoch 26: head: train, loss=0.11838725, MAE_E=  133.71 meV, MAE_F=  148.13 meV / A
2025-04-29 14:24:21.988 INFO: Epoch 26: head: validation, loss=0.13796775, MAE_E=  144.78 meV, MAE_F=  153.36 meV / A
2025-04-29 14:24:24.605 INFO: Epoch 27: head: train, loss=0.12834501, MAE_E=  239.11 meV, MAE_F=  155.97 meV / A
2025-04-29 14:24:25.208 INFO: Epoch 27: head: validation, loss=0.14897050, MAE_E=  241.44 meV, MAE_F=  160.86 meV / A
2025-04-29 14:24:27.881 INFO: Epoch 28: head: train, loss=0.16596337, MAE_E=  270.80 meV, MAE_F=  176.53 meV / A
2025-04-29 14:24:28.613 INFO: Epoch 28: head: validation, loss=0.18752171, MAE_E=  280.29 meV, MAE_F=  181.16 meV / A
2025-04-29 14:24:31.049 INFO: Epoch 29: head: train, loss=0.17795566, MAE_E=  459.31 meV, MAE_F=  183.18 meV / A
2025-04-29 14:24:31.640 INFO: Epoch 29: head: validation, loss=0.20503113, MAE_E=  442.22 meV, MAE_F=  189.66 meV / A
2025-04-29 14:24:34.163 INFO: Epoch 30: head: train, loss=0.24976278, MAE_E= 1405.39 meV, MAE_F=  213.83 meV / A
2025-04-29 14:24:34.820 INFO: Epoch 30: head: validation, loss=0.27874381, MAE_E= 1387.76 meV, MAE_F=  218.68 meV / A
2025-04-29 14:24:37.350 INFO: Epoch 31: head: train, loss=0.36684114, MAE_E= 1420.36 meV, MAE_F=  256.65 meV / A
2025-04-29 14:24:37.976 INFO: Epoch 31: head: validation, loss=0.39131105, MAE_E= 1414.60 meV, MAE_F=  258.36 meV / A
2025-04-29 14:24:40.403 INFO: Epoch 32: head: train, loss=0.36461926, MAE_E=  983.15 meV, MAE_F=  256.78 meV / A
2025-04-29 14:24:41.022 INFO: Epoch 32: head: validation, loss=0.39553724, MAE_E=  961.45 meV, MAE_F=  259.41 meV / A
2025-04-29 14:24:43.490 INFO: Epoch 33: head: train, loss=0.37570630, MAE_E=  693.33 meV, MAE_F=  259.43 meV / A
2025-04-29 14:24:44.122 INFO: Epoch 33: head: validation, loss=0.40613289, MAE_E=  662.76 meV, MAE_F=  262.08 meV / A
2025-04-29 14:24:46.638 INFO: Epoch 34: head: train, loss=0.36637018, MAE_E=  393.59 meV, MAE_F=  256.78 meV / A
2025-04-29 14:24:47.265 INFO: Epoch 34: head: validation, loss=0.40030216, MAE_E=  374.20 meV, MAE_F=  260.14 meV / A
2025-04-29 14:24:49.687 INFO: Epoch 35: head: train, loss=0.34913013, MAE_E=  352.85 meV, MAE_F=  251.25 meV / A
2025-04-29 14:24:50.331 INFO: Epoch 35: head: validation, loss=0.38236680, MAE_E=  339.86 meV, MAE_F=  254.16 meV / A
2025-04-29 14:24:52.668 INFO: Epoch 36: head: train, loss=0.32707389, MAE_E=  366.36 meV, MAE_F=  244.45 meV / A
2025-04-29 14:24:53.331 INFO: Epoch 36: head: validation, loss=0.36403007, MAE_E=  353.77 meV, MAE_F=  248.83 meV / A
2025-04-29 14:24:55.758 INFO: Epoch 37: head: train, loss=0.31156674, MAE_E=  315.42 meV, MAE_F=  239.49 meV / A
2025-04-29 14:24:56.422 INFO: Epoch 37: head: validation, loss=0.34783600, MAE_E=  307.92 meV, MAE_F=  243.64 meV / A
2025-04-29 14:24:58.936 INFO: Epoch 38: head: train, loss=0.29303392, MAE_E=  286.13 meV, MAE_F=  233.34 meV / A
2025-04-29 14:24:59.658 INFO: Epoch 38: head: validation, loss=0.33124669, MAE_E=  282.46 meV, MAE_F=  238.27 meV / A
2025-04-29 14:25:02.048 INFO: Epoch 39: head: train, loss=0.27436374, MAE_E=  272.89 meV, MAE_F=  226.68 meV / A
2025-04-29 14:25:02.661 INFO: Epoch 39: head: validation, loss=0.31332548, MAE_E=  263.88 meV, MAE_F=  232.36 meV / A
2025-04-29 14:25:05.088 INFO: Epoch 40: head: train, loss=0.26104785, MAE_E=  260.12 meV, MAE_F=  221.36 meV / A
2025-04-29 14:25:05.734 INFO: Epoch 40: head: validation, loss=0.29674562, MAE_E=  249.07 meV, MAE_F=  226.05 meV / A
2025-04-29 14:25:08.220 INFO: Epoch 41: head: train, loss=0.24384116, MAE_E=  250.20 meV, MAE_F=  214.55 meV / A
2025-04-29 14:25:08.849 INFO: Epoch 41: head: validation, loss=0.27963139, MAE_E=  237.20 meV, MAE_F=  219.44 meV / A
2025-04-29 14:25:11.242 INFO: Epoch 42: head: train, loss=0.22846316, MAE_E=  236.94 meV, MAE_F=  207.95 meV / A
2025-04-29 14:25:11.876 INFO: Epoch 42: head: validation, loss=0.26423973, MAE_E=  223.86 meV, MAE_F=  213.27 meV / A
2025-04-29 14:25:14.254 INFO: Epoch 43: head: train, loss=0.21688302, MAE_E=  224.14 meV, MAE_F=  202.40 meV / A
2025-04-29 14:25:14.870 INFO: Epoch 43: head: validation, loss=0.25082617, MAE_E=  213.26 meV, MAE_F=  207.56 meV / A
2025-04-29 14:25:17.178 INFO: Epoch 44: head: train, loss=0.20574320, MAE_E=  213.55 meV, MAE_F=  197.44 meV / A
2025-04-29 14:25:17.836 INFO: Epoch 44: head: validation, loss=0.23804108, MAE_E=  203.68 meV, MAE_F=  202.34 meV / A
2025-04-29 14:25:20.301 INFO: Epoch 45: head: train, loss=0.19575930, MAE_E=  202.68 meV, MAE_F=  192.48 meV / A
2025-04-29 14:25:21.030 INFO: Epoch 45: head: validation, loss=0.22660064, MAE_E=  194.54 meV, MAE_F=  197.42 meV / A
2025-04-29 14:25:23.622 INFO: Epoch 46: head: train, loss=0.18664444, MAE_E=  192.64 meV, MAE_F=  187.75 meV / A
2025-04-29 14:25:24.331 INFO: Epoch 46: head: validation, loss=0.21665841, MAE_E=  186.01 meV, MAE_F=  192.86 meV / A
2025-04-29 14:25:24.332 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:25:24.332 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5917], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:25:24.334 INFO: 
2025-04-29 14:25:24.334 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:25:24.334 INFO: eveluation
2025-04-29 14:25:24.335 INFO: The scale is [0.59166257] and shift is 0.0
2025-04-29 14:25:24.473 INFO: Energy Mean: -64250.433029513886, Variance: 0.12955612559377414
2025-04-29 14:25:24.772 INFO: Energy RMSE: 0.25895947217941284
2025-04-29 14:25:24.772 INFO: Energy R2: 0.48238646352743075
2025-04-29 14:25:24.772 INFO: Energy MAE: 0.16553819179534912
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:25:24.773 INFO: Forces RMSE: 0.7471692263483236
2025-04-29 14:25:24.773 INFO: Forces R2: 0.8438882731555326
2025-04-29 14:25:25.307 INFO: Energy Mean: -64250.418869357636, Variance: 0.14339980502187472
2025-04-29 14:25:25.430 INFO: Loading checkpoint: results/charge_head/bi11-3_samples_logs//sample_1//checkpoints/bi11-3_samples_run-123_epoch-26.pt
2025-04-29 14:25:25.476 INFO: Loaded Stage one model from epoch 26 for evaluation
2025-04-29 14:25:25.476 INFO: Saving model to results/charge_head/bi11-3_samples_logs/sample_1/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:25:25.640 INFO: Compiling model, saving metadata to results/charge_head/bi11-3_samples_logs/sample_1/bi11-3_samples_compiled.model
2025-04-29 14:25:26.140 INFO: Done
Loading saved bootstrap sample 2
Training model 2
Using latent charge and penalty 1
2025-04-29 14:25:26.558 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:25:26.558 INFO: MACE version: 0.3.10
2025-04-29 14:25:26.558 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:25:26.563 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:25:26.563 INFO: Using heads: ['default']
2025-04-29 14:25:26.563 INFO: =============    Processing head default     ===========
2025-04-29 14:25:26.563 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:25:26.572 INFO: Atomic Numbers used: [83]
2025-04-29 14:25:26.572 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.947439236111}}
2025-04-29 14:25:26.577 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.947439236111}
2025-04-29 14:25:26.842 INFO: Computing average number of neighbors
2025-04-29 14:25:27.379 INFO: Average number of neighbors: 9.990702479338843
2025-04-29 14:25:27.380 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:25:27.380 INFO: ===========MODEL DETAILS===========
2025-04-29 14:25:27.381 INFO: Building model
2025-04-29 14:25:27.382 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:25:27.382 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:25:27.382 INFO: 8 radial and 5 basis functions
2025-04-29 14:25:27.382 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:25:27.382 INFO: Distance transform for radial basis functions: None
2025-04-29 14:25:27.382 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:25:27.929 INFO: Mean: -0.00016939638030748032, Std: [0.60495738]
0.0 [0.60495738]
2025-04-29 14:25:27.930 INFO: Scale: [0.60495738], Shift: 0.0
2025-04-29 14:25:29.024 INFO: Total number of parameters: 509520
2025-04-29 14:25:29.024 INFO: 
2025-04-29 14:25:29.024 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:25:29.024 INFO: Using ADAM as parameter optimizer
2025-04-29 14:25:29.024 INFO: Batch size: 32
2025-04-29 14:25:29.024 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:25:29.025 INFO: Number of gradient updates: 2250
2025-04-29 14:25:29.025 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:25:29.025 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 14:25:29.026 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:25:29.026 INFO: 
2025-04-29 14:25:29.026 INFO: ===========TRAINING===========
2025-04-29 14:25:29.026 INFO: Started training, reporting errors on validation set
2025-04-29 14:25:29.026 INFO: Loss metrics on validation set
2025-04-29 14:25:29.924 INFO: Initial: head: validation, loss=25.14431501, MAE_E= 4688.61 meV, MAE_F=  411.14 meV / A
2025-04-29 14:25:32.386 INFO: Epoch 0: head: train, loss=1.44266746, MAE_E= 1579.01 meV, MAE_F=  369.65 meV / A
2025-04-29 14:25:33.165 INFO: Epoch 0: head: validation, loss=1.57435751, MAE_E= 1591.86 meV, MAE_F=  384.01 meV / A
2025-04-29 14:25:35.584 INFO: Epoch 1: head: train, loss=0.84431538, MAE_E=20893.03 meV, MAE_F=  354.65 meV / A
2025-04-29 14:25:36.229 INFO: Epoch 1: head: validation, loss=0.89795351, MAE_E=20871.29 meV, MAE_F=  359.86 meV / A
2025-04-29 14:25:38.780 INFO: Epoch 2: head: train, loss=0.52881852, MAE_E= 8392.13 meV, MAE_F=  294.70 meV / A
2025-04-29 14:25:39.427 INFO: Epoch 2: head: validation, loss=0.56601834, MAE_E= 8392.70 meV, MAE_F=  297.25 meV / A
2025-04-29 14:25:41.907 INFO: Epoch 3: head: train, loss=0.39390368, MAE_E= 2357.81 meV, MAE_F=  269.25 meV / A
2025-04-29 14:25:42.523 INFO: Epoch 3: head: validation, loss=0.40065861, MAE_E= 2337.96 meV, MAE_F=  266.83 meV / A
2025-04-29 14:25:44.958 INFO: Epoch 4: head: train, loss=0.36308572, MAE_E= 1785.08 meV, MAE_F=  258.60 meV / A
2025-04-29 14:25:45.577 INFO: Epoch 4: head: validation, loss=0.37290793, MAE_E= 1784.63 meV, MAE_F=  259.29 meV / A
2025-04-29 14:25:48.027 INFO: Epoch 5: head: train, loss=0.32330594, MAE_E=  440.13 meV, MAE_F=  247.43 meV / A
2025-04-29 14:25:48.665 INFO: Epoch 5: head: validation, loss=0.33294385, MAE_E=  406.93 meV, MAE_F=  247.14 meV / A
2025-04-29 14:25:51.139 INFO: Epoch 6: head: train, loss=0.29760503, MAE_E=  274.19 meV, MAE_F=  237.90 meV / A
2025-04-29 14:25:51.863 INFO: Epoch 6: head: validation, loss=0.30229577, MAE_E=  271.55 meV, MAE_F=  235.72 meV / A
2025-04-29 14:25:54.345 INFO: Epoch 7: head: train, loss=0.27046012, MAE_E=  300.86 meV, MAE_F=  227.77 meV / A
2025-04-29 14:25:54.982 INFO: Epoch 7: head: validation, loss=0.27551632, MAE_E=  303.49 meV, MAE_F=  225.11 meV / A
2025-04-29 14:25:57.598 INFO: Epoch 8: head: train, loss=0.24589308, MAE_E=  241.42 meV, MAE_F=  217.64 meV / A
2025-04-29 14:25:58.283 INFO: Epoch 8: head: validation, loss=0.25106135, MAE_E=  262.12 meV, MAE_F=  214.00 meV / A
2025-04-29 14:26:00.887 INFO: Epoch 9: head: train, loss=0.21431446, MAE_E=  239.67 meV, MAE_F=  203.27 meV / A
2025-04-29 14:26:01.521 INFO: Epoch 9: head: validation, loss=0.22215232, MAE_E=  264.53 meV, MAE_F=  201.05 meV / A
2025-04-29 14:26:04.122 INFO: Epoch 10: head: train, loss=0.18607953, MAE_E=  380.62 meV, MAE_F=  190.68 meV / A
2025-04-29 14:26:04.744 INFO: Epoch 10: head: validation, loss=0.19515051, MAE_E=  379.77 meV, MAE_F=  188.96 meV / A
2025-04-29 14:26:07.468 INFO: Epoch 11: head: train, loss=0.15790140, MAE_E=  245.78 meV, MAE_F=  175.13 meV / A
2025-04-29 14:26:08.100 INFO: Epoch 11: head: validation, loss=0.16634375, MAE_E=  247.22 meV, MAE_F=  173.59 meV / A
2025-04-29 14:26:10.787 INFO: Epoch 12: head: train, loss=0.14008299, MAE_E=  190.59 meV, MAE_F=  164.43 meV / A
2025-04-29 14:26:11.400 INFO: Epoch 12: head: validation, loss=0.14688248, MAE_E=  193.15 meV, MAE_F=  162.15 meV / A
2025-04-29 14:26:13.935 INFO: Epoch 13: head: train, loss=0.12888580, MAE_E=  175.44 meV, MAE_F=  156.91 meV / A
2025-04-29 14:26:14.647 INFO: Epoch 13: head: validation, loss=0.13582495, MAE_E=  177.04 meV, MAE_F=  155.22 meV / A
2025-04-29 14:26:17.099 INFO: Epoch 14: head: train, loss=0.12088415, MAE_E=  156.43 meV, MAE_F=  151.11 meV / A
2025-04-29 14:26:17.846 INFO: Epoch 14: head: validation, loss=0.12848580, MAE_E=  161.75 meV, MAE_F=  149.85 meV / A
2025-04-29 14:26:20.358 INFO: Epoch 15: head: train, loss=0.11609214, MAE_E=  134.37 meV, MAE_F=  147.50 meV / A
2025-04-29 14:26:21.015 INFO: Epoch 15: head: validation, loss=0.12292201, MAE_E=  140.87 meV, MAE_F=  146.25 meV / A
2025-04-29 14:26:23.523 INFO: Epoch 16: head: train, loss=0.11426300, MAE_E=  199.53 meV, MAE_F=  146.60 meV / A
2025-04-29 14:26:24.156 INFO: Epoch 16: head: validation, loss=0.12180985, MAE_E=  198.21 meV, MAE_F=  145.53 meV / A
2025-04-29 14:26:26.639 INFO: Epoch 17: head: train, loss=0.11031928, MAE_E=  135.78 meV, MAE_F=  143.63 meV / A
2025-04-29 14:26:27.252 INFO: Epoch 17: head: validation, loss=0.11666038, MAE_E=  139.49 meV, MAE_F=  142.52 meV / A
2025-04-29 14:26:29.734 INFO: Epoch 18: head: train, loss=0.10649315, MAE_E=  119.98 meV, MAE_F=  140.85 meV / A
2025-04-29 14:26:30.364 INFO: Epoch 18: head: validation, loss=0.11281161, MAE_E=  131.07 meV, MAE_F=  139.90 meV / A
2025-04-29 14:26:32.868 INFO: Epoch 19: head: train, loss=0.10396241, MAE_E=  135.00 meV, MAE_F=  138.99 meV / A
2025-04-29 14:26:33.600 INFO: Epoch 19: head: validation, loss=0.10974519, MAE_E=  135.57 meV, MAE_F=  137.79 meV / A
2025-04-29 14:26:36.083 INFO: Epoch 20: head: train, loss=0.10134220, MAE_E=  118.83 meV, MAE_F=  136.98 meV / A
2025-04-29 14:26:36.712 INFO: Epoch 20: head: validation, loss=0.10657666, MAE_E=  121.82 meV, MAE_F=  135.60 meV / A
2025-04-29 14:26:39.266 INFO: Epoch 21: head: train, loss=0.09920631, MAE_E=  132.98 meV, MAE_F=  135.22 meV / A
2025-04-29 14:26:39.989 INFO: Epoch 21: head: validation, loss=0.10420458, MAE_E=  134.35 meV, MAE_F=  133.95 meV / A
2025-04-29 14:26:42.617 INFO: Epoch 22: head: train, loss=0.09510609, MAE_E=  120.65 meV, MAE_F=  132.22 meV / A
2025-04-29 14:26:43.251 INFO: Epoch 22: head: validation, loss=0.10156980, MAE_E=  126.05 meV, MAE_F=  132.09 meV / A
2025-04-29 14:26:45.898 INFO: Epoch 23: head: train, loss=0.09458103, MAE_E=  126.79 meV, MAE_F=  131.58 meV / A
2025-04-29 14:26:46.541 INFO: Epoch 23: head: validation, loss=0.09914369, MAE_E=  129.82 meV, MAE_F=  130.38 meV / A
2025-04-29 14:26:49.021 INFO: Epoch 24: head: train, loss=0.09146335, MAE_E=  115.35 meV, MAE_F=  129.11 meV / A
2025-04-29 14:26:49.645 INFO: Epoch 24: head: validation, loss=0.09610223, MAE_E=  119.28 meV, MAE_F=  128.13 meV / A
2025-04-29 14:26:52.177 INFO: Epoch 25: head: train, loss=0.08934970, MAE_E=  116.32 meV, MAE_F=  127.25 meV / A
2025-04-29 14:26:52.803 INFO: Epoch 25: head: validation, loss=0.09348634, MAE_E=  118.84 meV, MAE_F=  126.17 meV / A
2025-04-29 14:26:55.310 INFO: Epoch 26: head: train, loss=0.08628676, MAE_E=  120.36 meV, MAE_F=  124.83 meV / A
2025-04-29 14:26:55.956 INFO: Epoch 26: head: validation, loss=0.09086975, MAE_E=  123.41 meV, MAE_F=  124.23 meV / A
2025-04-29 14:26:58.408 INFO: Epoch 27: head: train, loss=0.08423206, MAE_E=  116.01 meV, MAE_F=  123.00 meV / A
2025-04-29 14:26:59.046 INFO: Epoch 27: head: validation, loss=0.08886328, MAE_E=  121.05 meV, MAE_F=  122.79 meV / A
2025-04-29 14:27:01.518 INFO: Epoch 28: head: train, loss=0.08273691, MAE_E=  120.54 meV, MAE_F=  121.79 meV / A
2025-04-29 14:27:02.260 INFO: Epoch 28: head: validation, loss=0.08690420, MAE_E=  122.26 meV, MAE_F=  121.25 meV / A
2025-04-29 14:27:04.953 INFO: Epoch 29: head: train, loss=0.08039385, MAE_E=  115.15 meV, MAE_F=  119.87 meV / A
2025-04-29 14:27:05.685 INFO: Epoch 29: head: validation, loss=0.08487514, MAE_E=  119.53 meV, MAE_F=  119.70 meV / A
2025-04-29 14:27:08.311 INFO: Epoch 30: head: train, loss=0.07883970, MAE_E=  118.05 meV, MAE_F=  118.53 meV / A
2025-04-29 14:27:08.937 INFO: Epoch 30: head: validation, loss=0.08305517, MAE_E=  120.63 meV, MAE_F=  118.24 meV / A
2025-04-29 14:27:11.522 INFO: Epoch 31: head: train, loss=0.07421664, MAE_E=  110.24 meV, MAE_F=  114.88 meV / A
2025-04-29 14:27:12.248 INFO: Epoch 31: head: validation, loss=0.08133422, MAE_E=  118.62 meV, MAE_F=  116.82 meV / A
2025-04-29 14:27:15.035 INFO: Epoch 32: head: train, loss=0.07421696, MAE_E=  117.71 meV, MAE_F=  114.21 meV / A
2025-04-29 14:27:15.684 INFO: Epoch 32: head: validation, loss=0.07915916, MAE_E=  120.52 meV, MAE_F=  115.05 meV / A
2025-04-29 14:27:18.312 INFO: Epoch 33: head: train, loss=0.07173322, MAE_E=  120.04 meV, MAE_F=  112.00 meV / A
2025-04-29 14:27:19.023 INFO: Epoch 33: head: validation, loss=0.07728868, MAE_E=  123.19 meV, MAE_F=  113.47 meV / A
2025-04-29 14:27:21.648 INFO: Epoch 34: head: train, loss=0.07046597, MAE_E=  121.73 meV, MAE_F=  110.50 meV / A
2025-04-29 14:27:22.426 INFO: Epoch 34: head: validation, loss=0.07538794, MAE_E=  123.98 meV, MAE_F=  111.88 meV / A
2025-04-29 14:27:25.134 INFO: Epoch 35: head: train, loss=0.06850197, MAE_E=  125.29 meV, MAE_F=  108.69 meV / A
2025-04-29 14:27:25.874 INFO: Epoch 35: head: validation, loss=0.07355269, MAE_E=  125.92 meV, MAE_F=  110.19 meV / A
2025-04-29 14:27:28.612 INFO: Epoch 36: head: train, loss=0.06662966, MAE_E=  123.57 meV, MAE_F=  107.50 meV / A
2025-04-29 14:27:29.373 INFO: Epoch 36: head: validation, loss=0.07199867, MAE_E=  129.73 meV, MAE_F=  108.81 meV / A
2025-04-29 14:27:31.949 INFO: Epoch 37: head: train, loss=0.06498825, MAE_E=  122.82 meV, MAE_F=  105.62 meV / A
2025-04-29 14:27:32.587 INFO: Epoch 37: head: validation, loss=0.07042433, MAE_E=  125.30 meV, MAE_F=  107.25 meV / A
2025-04-29 14:27:35.186 INFO: Epoch 38: head: train, loss=0.06331112, MAE_E=  127.16 meV, MAE_F=  103.72 meV / A
2025-04-29 14:27:35.823 INFO: Epoch 38: head: validation, loss=0.06880237, MAE_E=  127.84 meV, MAE_F=  105.76 meV / A
2025-04-29 14:27:38.376 INFO: Epoch 39: head: train, loss=0.06174069, MAE_E=  136.61 meV, MAE_F=  102.33 meV / A
2025-04-29 14:27:39.023 INFO: Epoch 39: head: validation, loss=0.06743854, MAE_E=  136.56 meV, MAE_F=  104.52 meV / A
2025-04-29 14:27:41.556 INFO: Epoch 40: head: train, loss=0.05993337, MAE_E=  124.68 meV, MAE_F=  101.10 meV / A
2025-04-29 14:27:42.161 INFO: Epoch 40: head: validation, loss=0.06617313, MAE_E=  131.33 meV, MAE_F=  103.25 meV / A
2025-04-29 14:27:44.726 INFO: Epoch 41: head: train, loss=0.05959202, MAE_E=  142.87 meV, MAE_F=  100.18 meV / A
2025-04-29 14:27:45.470 INFO: Epoch 41: head: validation, loss=0.06497632, MAE_E=  142.32 meV, MAE_F=  102.05 meV / A
2025-04-29 14:27:48.052 INFO: Epoch 42: head: train, loss=0.05791456, MAE_E=  133.92 meV, MAE_F=   98.55 meV / A
2025-04-29 14:27:48.627 INFO: Epoch 42: head: validation, loss=0.06390571, MAE_E=  134.44 meV, MAE_F=  101.00 meV / A
2025-04-29 14:27:51.097 INFO: Epoch 43: head: train, loss=0.05785049, MAE_E=  133.48 meV, MAE_F=   98.64 meV / A
2025-04-29 14:27:51.837 INFO: Epoch 43: head: validation, loss=0.06308013, MAE_E=  133.19 meV, MAE_F=  100.27 meV / A
2025-04-29 14:27:54.307 INFO: Epoch 44: head: train, loss=0.05719345, MAE_E=  145.93 meV, MAE_F=   98.05 meV / A
2025-04-29 14:27:55.029 INFO: Epoch 44: head: validation, loss=0.06271913, MAE_E=  144.17 meV, MAE_F=  100.00 meV / A
2025-04-29 14:27:57.534 INFO: Epoch 45: head: train, loss=0.07449217, MAE_E=  353.10 meV, MAE_F=  116.58 meV / A
2025-04-29 14:27:58.166 INFO: Epoch 45: head: validation, loss=0.08021880, MAE_E=  351.50 meV, MAE_F=  116.43 meV / A
2025-04-29 14:28:00.592 INFO: Epoch 46: head: train, loss=0.24086826, MAE_E=  184.66 meV, MAE_F=  223.37 meV / A
2025-04-29 14:28:01.237 INFO: Epoch 46: head: validation, loss=0.25220700, MAE_E=  181.88 meV, MAE_F=  220.56 meV / A
2025-04-29 14:28:03.804 INFO: Epoch 47: head: train, loss=0.29191338, MAE_E= 1885.39 meV, MAE_F=  244.64 meV / A
2025-04-29 14:28:04.477 INFO: Epoch 47: head: validation, loss=0.30708282, MAE_E= 1900.65 meV, MAE_F=  242.36 meV / A
2025-04-29 14:28:06.908 INFO: Epoch 48: head: train, loss=0.27948812, MAE_E= 2262.32 meV, MAE_F=  236.60 meV / A
2025-04-29 14:28:07.553 INFO: Epoch 48: head: validation, loss=0.29276595, MAE_E= 2277.23 meV, MAE_F=  234.80 meV / A
2025-04-29 14:28:09.997 INFO: Epoch 49: head: train, loss=0.26446245, MAE_E= 2264.00 meV, MAE_F=  227.01 meV / A
2025-04-29 14:28:10.636 INFO: Epoch 49: head: validation, loss=0.27680396, MAE_E= 2276.32 meV, MAE_F=  226.47 meV / A
2025-04-29 14:28:13.060 INFO: Epoch 50: head: train, loss=0.27502547, MAE_E= 2451.74 meV, MAE_F=  229.03 meV / A
2025-04-29 14:28:13.680 INFO: Epoch 50: head: validation, loss=0.29061714, MAE_E= 2459.05 meV, MAE_F=  230.38 meV / A
2025-04-29 14:28:16.113 INFO: Epoch 51: head: train, loss=0.25618907, MAE_E= 2216.08 meV, MAE_F=  219.98 meV / A
2025-04-29 14:28:16.855 INFO: Epoch 51: head: validation, loss=0.26922537, MAE_E= 2223.75 meV, MAE_F=  221.05 meV / A
2025-04-29 14:28:19.314 INFO: Epoch 52: head: train, loss=0.24493701, MAE_E= 2126.39 meV, MAE_F=  213.37 meV / A
2025-04-29 14:28:19.937 INFO: Epoch 52: head: validation, loss=0.25665964, MAE_E= 2134.58 meV, MAE_F=  214.83 meV / A
2025-04-29 14:28:22.394 INFO: Epoch 53: head: train, loss=0.26127926, MAE_E= 1756.60 meV, MAE_F=  217.75 meV / A
2025-04-29 14:28:23.024 INFO: Epoch 53: head: validation, loss=0.27694850, MAE_E= 1758.15 meV, MAE_F=  220.55 meV / A
2025-04-29 14:28:25.395 INFO: Epoch 54: head: train, loss=0.27593620, MAE_E= 1814.82 meV, MAE_F=  223.52 meV / A
2025-04-29 14:28:26.007 INFO: Epoch 54: head: validation, loss=0.29855735, MAE_E= 1813.01 meV, MAE_F=  227.43 meV / A
2025-04-29 14:28:28.484 INFO: Epoch 55: head: train, loss=0.26819337, MAE_E= 1650.05 meV, MAE_F=  220.15 meV / A
2025-04-29 14:28:29.099 INFO: Epoch 55: head: validation, loss=0.28754778, MAE_E= 1650.41 meV, MAE_F=  224.18 meV / A
2025-04-29 14:28:31.587 INFO: Epoch 56: head: train, loss=0.26204606, MAE_E= 1411.10 meV, MAE_F=  217.68 meV / A
2025-04-29 14:28:32.242 INFO: Epoch 56: head: validation, loss=0.27689913, MAE_E= 1410.29 meV, MAE_F=  221.19 meV / A
2025-04-29 14:28:34.941 INFO: Epoch 57: head: train, loss=0.23928154, MAE_E= 1146.09 meV, MAE_F=  209.52 meV / A
2025-04-29 14:28:35.591 INFO: Epoch 57: head: validation, loss=0.25269792, MAE_E= 1143.84 meV, MAE_F=  212.30 meV / A
2025-04-29 14:28:38.062 INFO: Epoch 58: head: train, loss=0.21940736, MAE_E=  894.14 meV, MAE_F=  202.12 meV / A
2025-04-29 14:28:38.659 INFO: Epoch 58: head: validation, loss=0.23050074, MAE_E=  890.16 meV, MAE_F=  203.58 meV / A
2025-04-29 14:28:41.051 INFO: Epoch 59: head: train, loss=0.20057477, MAE_E=  761.67 meV, MAE_F=  193.95 meV / A
2025-04-29 14:28:41.816 INFO: Epoch 59: head: validation, loss=0.21117671, MAE_E=  754.41 meV, MAE_F=  195.56 meV / A
2025-04-29 14:28:44.323 INFO: Epoch 60: head: train, loss=0.19124962, MAE_E=  597.20 meV, MAE_F=  189.43 meV / A
2025-04-29 14:28:44.977 INFO: Epoch 60: head: validation, loss=0.20213307, MAE_E=  582.11 meV, MAE_F=  191.56 meV / A
2025-04-29 14:28:47.428 INFO: Epoch 61: head: train, loss=0.19679896, MAE_E=  948.76 meV, MAE_F=  191.24 meV / A
2025-04-29 14:28:48.101 INFO: Epoch 61: head: validation, loss=0.20774301, MAE_E=  943.87 meV, MAE_F=  193.80 meV / A
2025-04-29 14:28:50.583 INFO: Epoch 62: head: train, loss=0.19020650, MAE_E=  338.82 meV, MAE_F=  188.20 meV / A
2025-04-29 14:28:51.324 INFO: Epoch 62: head: validation, loss=0.20030114, MAE_E=  325.94 meV, MAE_F=  190.59 meV / A
2025-04-29 14:28:53.818 INFO: Epoch 63: head: train, loss=0.17978504, MAE_E=  227.39 meV, MAE_F=  183.33 meV / A
2025-04-29 14:28:54.570 INFO: Epoch 63: head: validation, loss=0.18952133, MAE_E=  236.69 meV, MAE_F=  185.68 meV / A
2025-04-29 14:28:56.991 INFO: Epoch 64: head: train, loss=0.17262768, MAE_E=  317.81 meV, MAE_F=  179.37 meV / A
2025-04-29 14:28:57.621 INFO: Epoch 64: head: validation, loss=0.18366608, MAE_E=  311.33 meV, MAE_F=  182.73 meV / A
2025-04-29 14:28:57.622 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:28:57.622 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.6050], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:28:57.625 INFO: 
2025-04-29 14:28:57.625 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:28:57.625 INFO: eveluation
2025-04-29 14:28:57.626 INFO: The scale is [0.60495738] and shift is 0.0
2025-04-29 14:28:57.759 INFO: Energy Mean: -64250.395703125, Variance: 0.12024042765299478
2025-04-29 14:28:58.039 INFO: Energy RMSE: 1.3771659135818481
2025-04-29 14:28:58.039 INFO: Energy R2: -14.773279983598583
2025-04-29 14:28:58.039 INFO: Energy MAE: 1.3330295085906982
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:28:58.040 INFO: Forces RMSE: 0.6824415698941587
2025-04-29 14:28:58.040 INFO: Forces R2: 0.8958186990241781
2025-04-29 14:28:58.567 INFO: Energy Mean: -64250.421831597225, Variance: 0.16448160618911553
2025-04-29 14:28:58.705 INFO: Loading checkpoint: results/charge_head/bi11-3_samples_logs//sample_2//checkpoints/bi11-3_samples_run-123_epoch-44.pt
2025-04-29 14:28:58.748 INFO: Loaded Stage one model from epoch 44 for evaluation
2025-04-29 14:28:58.749 INFO: Saving model to results/charge_head/bi11-3_samples_logs/sample_2/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:28:58.906 INFO: Compiling model, saving metadata to results/charge_head/bi11-3_samples_logs/sample_2/bi11-3_samples_compiled.model
2025-04-29 14:28:59.564 INFO: Done
Loading saved bootstrap sample 3
Training model 3
Using latent charge and penalty 1
2025-04-29 14:28:59.978 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:28:59.978 INFO: MACE version: 0.3.10
2025-04-29 14:28:59.978 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:28:59.983 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:28:59.983 INFO: Using heads: ['default']
2025-04-29 14:28:59.983 INFO: =============    Processing head default     ===========
2025-04-29 14:28:59.983 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:28:59.991 INFO: Atomic Numbers used: [83]
2025-04-29 14:28:59.991 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.943625710226}}
2025-04-29 14:28:59.996 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.943625710226}
2025-04-29 14:29:00.116 INFO: Computing average number of neighbors
2025-04-29 14:29:00.689 INFO: Average number of neighbors: 9.993801652892563
2025-04-29 14:29:00.690 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:29:00.690 INFO: ===========MODEL DETAILS===========
2025-04-29 14:29:00.691 INFO: Building model
2025-04-29 14:29:00.691 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:29:00.692 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:29:00.692 INFO: 8 radial and 5 basis functions
2025-04-29 14:29:00.692 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:29:00.692 INFO: Distance transform for radial basis functions: None
2025-04-29 14:29:00.692 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:29:01.263 INFO: Mean: -0.00013114992252065926, Std: [0.58461786]
0.0 [0.58461786]
2025-04-29 14:29:01.263 INFO: Scale: [0.58461786], Shift: 0.0
2025-04-29 14:29:02.363 INFO: Total number of parameters: 509520
2025-04-29 14:29:02.363 INFO: 
2025-04-29 14:29:02.363 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:29:02.363 INFO: Using ADAM as parameter optimizer
2025-04-29 14:29:02.363 INFO: Batch size: 32
2025-04-29 14:29:02.363 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:29:02.363 INFO: Number of gradient updates: 2250
2025-04-29 14:29:02.363 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:29:02.363 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 14:29:02.365 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:29:02.365 INFO: 
2025-04-29 14:29:02.365 INFO: ===========TRAINING===========
2025-04-29 14:29:02.365 INFO: Started training, reporting errors on validation set
2025-04-29 14:29:02.365 INFO: Loss metrics on validation set
2025-04-29 14:29:03.236 INFO: Initial: head: validation, loss=25.08019003, MAE_E= 4441.88 meV, MAE_F=  398.05 meV / A
2025-04-29 14:29:05.644 INFO: Epoch 0: head: train, loss=1.40279190, MAE_E= 1150.83 meV, MAE_F=  369.57 meV / A
2025-04-29 14:29:06.392 INFO: Epoch 0: head: validation, loss=1.54497453, MAE_E= 1089.91 meV, MAE_F=  376.51 meV / A
2025-04-29 14:29:08.882 INFO: Epoch 1: head: train, loss=0.75472471, MAE_E= 9292.54 meV, MAE_F=  358.96 meV / A
2025-04-29 14:29:09.507 INFO: Epoch 1: head: validation, loss=0.79258608, MAE_E= 9447.75 meV, MAE_F=  350.76 meV / A
2025-04-29 14:29:12.197 INFO: Epoch 2: head: train, loss=0.56333091, MAE_E= 3957.29 meV, MAE_F=  308.09 meV / A
2025-04-29 14:29:12.816 INFO: Epoch 2: head: validation, loss=0.61053224, MAE_E= 3842.78 meV, MAE_F=  306.36 meV / A
2025-04-29 14:29:15.431 INFO: Epoch 3: head: train, loss=0.41792038, MAE_E= 2953.26 meV, MAE_F=  277.22 meV / A
2025-04-29 14:29:16.061 INFO: Epoch 3: head: validation, loss=0.42205967, MAE_E= 2841.90 meV, MAE_F=  271.90 meV / A
2025-04-29 14:29:18.572 INFO: Epoch 4: head: train, loss=0.72468418, MAE_E=11198.53 meV, MAE_F=  338.69 meV / A
2025-04-29 14:29:19.235 INFO: Epoch 4: head: validation, loss=0.86705008, MAE_E=11254.51 meV, MAE_F=  354.12 meV / A
2025-04-29 14:29:21.681 INFO: Epoch 5: head: train, loss=0.77781228, MAE_E=  424.55 meV, MAE_F=  355.72 meV / A
2025-04-29 14:29:22.324 INFO: Epoch 5: head: validation, loss=0.92770308, MAE_E=  383.44 meV, MAE_F=  368.75 meV / A
2025-04-29 14:29:24.909 INFO: Epoch 6: head: train, loss=0.73513225, MAE_E= 2125.73 meV, MAE_F=  353.36 meV / A
2025-04-29 14:29:25.695 INFO: Epoch 6: head: validation, loss=0.87344462, MAE_E= 2069.33 meV, MAE_F=  364.91 meV / A
2025-04-29 14:29:28.209 INFO: Epoch 7: head: train, loss=0.67102332, MAE_E=  718.32 meV, MAE_F=  338.91 meV / A
2025-04-29 14:29:28.859 INFO: Epoch 7: head: validation, loss=0.76959819, MAE_E=  727.50 meV, MAE_F=  344.29 meV / A
2025-04-29 14:29:31.393 INFO: Epoch 8: head: train, loss=0.58605218, MAE_E=  823.62 meV, MAE_F=  318.84 meV / A
2025-04-29 14:29:32.125 INFO: Epoch 8: head: validation, loss=0.64163843, MAE_E=  856.50 meV, MAE_F=  318.02 meV / A
2025-04-29 14:29:34.787 INFO: Epoch 9: head: train, loss=0.52424560, MAE_E=  530.70 meV, MAE_F=  303.23 meV / A
2025-04-29 14:29:35.537 INFO: Epoch 9: head: validation, loss=0.55847227, MAE_E=  474.84 meV, MAE_F=  300.06 meV / A
2025-04-29 14:29:38.148 INFO: Epoch 10: head: train, loss=0.46088973, MAE_E=  579.49 meV, MAE_F=  286.69 meV / A
2025-04-29 14:29:38.900 INFO: Epoch 10: head: validation, loss=0.48261601, MAE_E=  540.20 meV, MAE_F=  283.10 meV / A
2025-04-29 14:29:41.588 INFO: Epoch 11: head: train, loss=0.40563154, MAE_E=  636.62 meV, MAE_F=  272.48 meV / A
2025-04-29 14:29:42.346 INFO: Epoch 11: head: validation, loss=0.42172775, MAE_E=  517.00 meV, MAE_F=  269.08 meV / A
2025-04-29 14:29:45.134 INFO: Epoch 12: head: train, loss=0.36177073, MAE_E=  421.20 meV, MAE_F=  259.60 meV / A
2025-04-29 14:29:45.881 INFO: Epoch 12: head: validation, loss=0.37691556, MAE_E=  318.26 meV, MAE_F=  257.50 meV / A
2025-04-29 14:29:48.590 INFO: Epoch 13: head: train, loss=0.32847088, MAE_E=  516.68 meV, MAE_F=  249.25 meV / A
2025-04-29 14:29:49.245 INFO: Epoch 13: head: validation, loss=0.34593349, MAE_E=  500.29 meV, MAE_F=  248.63 meV / A
2025-04-29 14:29:51.716 INFO: Epoch 14: head: train, loss=0.30190655, MAE_E=  549.50 meV, MAE_F=  239.47 meV / A
2025-04-29 14:29:52.332 INFO: Epoch 14: head: validation, loss=0.32153949, MAE_E=  539.22 meV, MAE_F=  240.56 meV / A
2025-04-29 14:29:54.964 INFO: Epoch 15: head: train, loss=0.28584903, MAE_E=  366.52 meV, MAE_F=  233.09 meV / A
2025-04-29 14:29:55.726 INFO: Epoch 15: head: validation, loss=0.30666310, MAE_E=  317.59 meV, MAE_F=  234.92 meV / A
2025-04-29 14:29:58.224 INFO: Epoch 16: head: train, loss=0.27142579, MAE_E=  370.90 meV, MAE_F=  227.01 meV / A
2025-04-29 14:29:58.858 INFO: Epoch 16: head: validation, loss=0.29264930, MAE_E=  336.39 meV, MAE_F=  229.51 meV / A
2025-04-29 14:30:01.362 INFO: Epoch 17: head: train, loss=0.25776532, MAE_E=  361.95 meV, MAE_F=  221.67 meV / A
2025-04-29 14:30:02.119 INFO: Epoch 17: head: validation, loss=0.27841947, MAE_E=  326.69 meV, MAE_F=  224.60 meV / A
2025-04-29 14:30:04.606 INFO: Epoch 18: head: train, loss=0.24402366, MAE_E=  318.13 meV, MAE_F=  215.81 meV / A
2025-04-29 14:30:05.379 INFO: Epoch 18: head: validation, loss=0.26395320, MAE_E=  267.89 meV, MAE_F=  219.15 meV / A
2025-04-29 14:30:07.870 INFO: Epoch 19: head: train, loss=0.22887579, MAE_E=  328.04 meV, MAE_F=  209.34 meV / A
2025-04-29 14:30:08.608 INFO: Epoch 19: head: validation, loss=0.24852324, MAE_E=  274.48 meV, MAE_F=  213.28 meV / A
2025-04-29 14:30:11.143 INFO: Epoch 20: head: train, loss=0.21577011, MAE_E=  339.17 meV, MAE_F=  203.60 meV / A
2025-04-29 14:30:11.777 INFO: Epoch 20: head: validation, loss=0.23298039, MAE_E=  286.07 meV, MAE_F=  206.96 meV / A
2025-04-29 14:30:14.331 INFO: Epoch 21: head: train, loss=0.20024338, MAE_E=  324.54 meV, MAE_F=  196.29 meV / A
2025-04-29 14:30:14.980 INFO: Epoch 21: head: validation, loss=0.21504300, MAE_E=  280.40 meV, MAE_F=  199.14 meV / A
2025-04-29 14:30:17.603 INFO: Epoch 22: head: train, loss=0.18466301, MAE_E=  306.33 meV, MAE_F=  188.20 meV / A
2025-04-29 14:30:18.313 INFO: Epoch 22: head: validation, loss=0.19741757, MAE_E=  260.99 meV, MAE_F=  190.71 meV / A
2025-04-29 14:30:20.868 INFO: Epoch 23: head: train, loss=0.17105143, MAE_E=  275.64 meV, MAE_F=  181.39 meV / A
2025-04-29 14:30:21.529 INFO: Epoch 23: head: validation, loss=0.18329824, MAE_E=  237.40 meV, MAE_F=  183.84 meV / A
2025-04-29 14:30:24.011 INFO: Epoch 24: head: train, loss=0.16305071, MAE_E=  258.82 meV, MAE_F=  176.29 meV / A
2025-04-29 14:30:24.695 INFO: Epoch 24: head: validation, loss=0.17167990, MAE_E=  218.11 meV, MAE_F=  177.81 meV / A
2025-04-29 14:30:27.325 INFO: Epoch 25: head: train, loss=0.15536527, MAE_E=  237.74 meV, MAE_F=  171.62 meV / A
2025-04-29 14:30:28.011 INFO: Epoch 25: head: validation, loss=0.16165932, MAE_E=  196.73 meV, MAE_F=  172.23 meV / A
2025-04-29 14:30:30.512 INFO: Epoch 26: head: train, loss=0.14791274, MAE_E=  222.02 meV, MAE_F=  167.13 meV / A
2025-04-29 14:30:31.254 INFO: Epoch 26: head: validation, loss=0.15255780, MAE_E=  182.63 meV, MAE_F=  166.94 meV / A
2025-04-29 14:30:33.812 INFO: Epoch 27: head: train, loss=0.14003878, MAE_E=  197.29 meV, MAE_F=  162.56 meV / A
2025-04-29 14:30:34.585 INFO: Epoch 27: head: validation, loss=0.14509253, MAE_E=  166.85 meV, MAE_F=  162.40 meV / A
2025-04-29 14:30:37.040 INFO: Epoch 28: head: train, loss=0.13477386, MAE_E=  188.26 meV, MAE_F=  158.93 meV / A
2025-04-29 14:30:37.665 INFO: Epoch 28: head: validation, loss=0.13844907, MAE_E=  154.76 meV, MAE_F=  158.07 meV / A
2025-04-29 14:30:40.166 INFO: Epoch 29: head: train, loss=0.13119331, MAE_E=  188.83 meV, MAE_F=  156.53 meV / A
2025-04-29 14:30:40.794 INFO: Epoch 29: head: validation, loss=0.13335746, MAE_E=  152.66 meV, MAE_F=  154.70 meV / A
2025-04-29 14:30:43.231 INFO: Epoch 30: head: train, loss=0.12722789, MAE_E=  176.25 meV, MAE_F=  153.84 meV / A
2025-04-29 14:30:43.858 INFO: Epoch 30: head: validation, loss=0.12837654, MAE_E=  140.86 meV, MAE_F=  151.40 meV / A
2025-04-29 14:30:46.468 INFO: Epoch 31: head: train, loss=0.12320290, MAE_E=  166.60 meV, MAE_F=  151.22 meV / A
2025-04-29 14:30:47.131 INFO: Epoch 31: head: validation, loss=0.12391471, MAE_E=  135.76 meV, MAE_F=  148.44 meV / A
2025-04-29 14:30:49.584 INFO: Epoch 32: head: train, loss=0.12548418, MAE_E=  383.02 meV, MAE_F=  153.22 meV / A
2025-04-29 14:30:50.207 INFO: Epoch 32: head: validation, loss=0.12644042, MAE_E=  337.95 meV, MAE_F=  149.85 meV / A
2025-04-29 14:30:52.663 INFO: Epoch 33: head: train, loss=0.16070072, MAE_E=  376.71 meV, MAE_F=  174.86 meV / A
2025-04-29 14:30:53.269 INFO: Epoch 33: head: validation, loss=0.16041192, MAE_E=  326.65 meV, MAE_F=  171.43 meV / A
2025-04-29 14:30:55.663 INFO: Epoch 34: head: train, loss=0.22735321, MAE_E=  245.56 meV, MAE_F=  206.62 meV / A
2025-04-29 14:30:56.289 INFO: Epoch 34: head: validation, loss=0.22606119, MAE_E=  199.71 meV, MAE_F=  201.92 meV / A
2025-04-29 14:30:58.832 INFO: Epoch 35: head: train, loss=0.23679142, MAE_E=  457.57 meV, MAE_F=  211.56 meV / A
2025-04-29 14:30:59.491 INFO: Epoch 35: head: validation, loss=0.23673687, MAE_E=  482.52 meV, MAE_F=  206.86 meV / A
2025-04-29 14:31:02.127 INFO: Epoch 36: head: train, loss=0.49728806, MAE_E= 1050.13 meV, MAE_F=  291.99 meV / A
2025-04-29 14:31:02.815 INFO: Epoch 36: head: validation, loss=0.54976776, MAE_E= 1092.80 meV, MAE_F=  289.70 meV / A
2025-04-29 14:31:05.274 INFO: Epoch 37: head: train, loss=0.77332986, MAE_E=  899.39 meV, MAE_F=  351.00 meV / A
2025-04-29 14:31:05.864 INFO: Epoch 37: head: validation, loss=0.88428209, MAE_E=  932.99 meV, MAE_F=  349.77 meV / A
2025-04-29 14:31:08.287 INFO: Epoch 38: head: train, loss=0.84872348, MAE_E=  611.73 meV, MAE_F=  362.14 meV / A
2025-04-29 14:31:08.916 INFO: Epoch 38: head: validation, loss=0.99092936, MAE_E=  604.72 meV, MAE_F=  364.72 meV / A
2025-04-29 14:31:11.552 INFO: Epoch 39: head: train, loss=0.80234866, MAE_E=  355.35 meV, MAE_F=  352.63 meV / A
2025-04-29 14:31:12.329 INFO: Epoch 39: head: validation, loss=0.94786394, MAE_E=  292.23 meV, MAE_F=  356.55 meV / A
2025-04-29 14:31:15.065 INFO: Epoch 40: head: train, loss=0.75649192, MAE_E=  536.38 meV, MAE_F=  342.13 meV / A
2025-04-29 14:31:15.808 INFO: Epoch 40: head: validation, loss=0.87041399, MAE_E=  459.08 meV, MAE_F=  343.50 meV / A
2025-04-29 14:31:18.319 INFO: Epoch 41: head: train, loss=0.71246120, MAE_E=  599.35 meV, MAE_F=  332.95 meV / A
2025-04-29 14:31:18.945 INFO: Epoch 41: head: validation, loss=0.82073996, MAE_E=  586.15 meV, MAE_F=  335.41 meV / A
2025-04-29 14:31:21.379 INFO: Epoch 42: head: train, loss=0.65355688, MAE_E=  519.88 meV, MAE_F=  321.61 meV / A
2025-04-29 14:31:22.120 INFO: Epoch 42: head: validation, loss=0.75196873, MAE_E=  443.32 meV, MAE_F=  324.67 meV / A
2025-04-29 14:31:24.643 INFO: Epoch 43: head: train, loss=0.59120729, MAE_E=  371.07 meV, MAE_F=  308.61 meV / A
2025-04-29 14:31:25.345 INFO: Epoch 43: head: validation, loss=0.67431806, MAE_E=  296.54 meV, MAE_F=  311.34 meV / A
2025-04-29 14:31:27.828 INFO: Epoch 44: head: train, loss=0.52562464, MAE_E=  363.64 meV, MAE_F=  294.72 meV / A
2025-04-29 14:31:28.576 INFO: Epoch 44: head: validation, loss=0.58816560, MAE_E=  289.88 meV, MAE_F=  295.65 meV / A
2025-04-29 14:31:30.996 INFO: Epoch 45: head: train, loss=0.51555041, MAE_E= 1898.19 meV, MAE_F=  293.39 meV / A
2025-04-29 14:31:31.636 INFO: Epoch 45: head: validation, loss=0.56648444, MAE_E= 1803.94 meV, MAE_F=  292.10 meV / A
2025-04-29 14:31:34.180 INFO: Epoch 46: head: train, loss=0.55739594, MAE_E= 3833.08 meV, MAE_F=  301.78 meV / A
2025-04-29 14:31:34.840 INFO: Epoch 46: head: validation, loss=0.61755796, MAE_E= 3743.95 meV, MAE_F=  300.88 meV / A
2025-04-29 14:31:37.343 INFO: Epoch 47: head: train, loss=0.55960675, MAE_E= 4579.74 meV, MAE_F=  301.30 meV / A
2025-04-29 14:31:38.002 INFO: Epoch 47: head: validation, loss=0.62844152, MAE_E= 4499.77 meV, MAE_F=  302.03 meV / A
2025-04-29 14:31:40.554 INFO: Epoch 48: head: train, loss=0.53266421, MAE_E= 3714.78 meV, MAE_F=  296.10 meV / A
2025-04-29 14:31:41.217 INFO: Epoch 48: head: validation, loss=0.58803364, MAE_E= 3632.77 meV, MAE_F=  294.45 meV / A
2025-04-29 14:31:43.628 INFO: Epoch 49: head: train, loss=0.47073788, MAE_E= 2691.66 meV, MAE_F=  281.43 meV / A
2025-04-29 14:31:44.269 INFO: Epoch 49: head: validation, loss=0.51478550, MAE_E= 2609.15 meV, MAE_F=  279.54 meV / A
2025-04-29 14:31:46.685 INFO: Epoch 50: head: train, loss=0.42062574, MAE_E=  902.81 meV, MAE_F=  268.12 meV / A
2025-04-29 14:31:47.329 INFO: Epoch 50: head: validation, loss=0.45027243, MAE_E=  816.12 meV, MAE_F=  265.19 meV / A
2025-04-29 14:31:49.914 INFO: Epoch 51: head: train, loss=0.39770474, MAE_E= 1576.07 meV, MAE_F=  261.74 meV / A
2025-04-29 14:31:50.588 INFO: Epoch 51: head: validation, loss=0.42126090, MAE_E= 1490.47 meV, MAE_F=  258.02 meV / A
2025-04-29 14:31:50.588 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:31:50.589 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5846], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:31:50.591 INFO: 
2025-04-29 14:31:50.591 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:31:50.591 INFO: eveluation
2025-04-29 14:31:50.592 INFO: The scale is [0.58461786] and shift is 0.0
2025-04-29 14:31:50.730 INFO: Energy Mean: -64250.434071180556, Variance: 0.1148901461377556
2025-04-29 14:31:50.993 INFO: Energy RMSE: 1.9762160778045654
2025-04-29 14:31:50.993 INFO: Energy R2: -32.99273475777856
2025-04-29 14:31:50.993 INFO: Energy MAE: 1.961241364479065
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:31:50.994 INFO: Forces RMSE: 0.9119072336161688
2025-04-29 14:31:50.994 INFO: Forces R2: 0.8003078508089819
2025-04-29 14:31:51.521 INFO: Energy Mean: -64250.3798828125, Variance: 0.200196901957194
2025-04-29 14:31:51.631 INFO: Loading checkpoint: results/charge_head/bi11-3_samples_logs//sample_3//checkpoints/bi11-3_samples_run-123_epoch-31.pt
2025-04-29 14:31:51.672 INFO: Loaded Stage one model from epoch 31 for evaluation
2025-04-29 14:31:51.673 INFO: Saving model to results/charge_head/bi11-3_samples_logs/sample_3/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:31:52.003 INFO: Compiling model, saving metadata to results/charge_head/bi11-3_samples_logs/sample_3/bi11-3_samples_compiled.model
2025-04-29 14:31:52.509 INFO: Done
Loading saved bootstrap sample 4
Training model 4
Using latent charge and penalty 1
2025-04-29 14:31:52.925 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:31:52.925 INFO: MACE version: 0.3.10
2025-04-29 14:31:52.926 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:31:52.931 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:31:52.931 INFO: Using heads: ['default']
2025-04-29 14:31:52.931 INFO: =============    Processing head default     ===========
2025-04-29 14:31:52.931 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:31:52.940 INFO: Atomic Numbers used: [83]
2025-04-29 14:31:52.940 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.950555358269}}
2025-04-29 14:31:52.944 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.950555358269}
2025-04-29 14:31:53.066 INFO: Computing average number of neighbors
2025-04-29 14:31:53.629 INFO: Average number of neighbors: 9.992768595041323
2025-04-29 14:31:53.629 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:31:53.629 INFO: ===========MODEL DETAILS===========
2025-04-29 14:31:53.631 INFO: Building model
2025-04-29 14:31:53.631 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:31:53.631 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:31:53.632 INFO: 8 radial and 5 basis functions
2025-04-29 14:31:53.632 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:31:53.632 INFO: Distance transform for radial basis functions: None
2025-04-29 14:31:53.632 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:31:54.282 INFO: Mean: 0.000435709187408337, Std: [0.59789193]
0.0 [0.59789193]
2025-04-29 14:31:54.282 INFO: Scale: [0.59789193], Shift: 0.0
2025-04-29 14:31:55.431 INFO: Total number of parameters: 509520
2025-04-29 14:31:55.431 INFO: 
2025-04-29 14:31:55.431 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:31:55.431 INFO: Using ADAM as parameter optimizer
2025-04-29 14:31:55.431 INFO: Batch size: 32
2025-04-29 14:31:55.431 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:31:55.431 INFO: Number of gradient updates: 2250
2025-04-29 14:31:55.431 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:31:55.431 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=1.000)
2025-04-29 14:31:55.433 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:31:55.433 INFO: 
2025-04-29 14:31:55.434 INFO: ===========TRAINING===========
2025-04-29 14:31:55.434 INFO: Started training, reporting errors on validation set
2025-04-29 14:31:55.434 INFO: Loss metrics on validation set
2025-04-29 14:31:56.363 INFO: Initial: head: validation, loss=24.96664014, MAE_E= 4615.40 meV, MAE_F=  392.10 meV / A
2025-04-29 14:31:59.041 INFO: Epoch 0: head: train, loss=1.41030358, MAE_E= 1864.60 meV, MAE_F=  365.54 meV / A
2025-04-29 14:31:59.811 INFO: Epoch 0: head: validation, loss=1.46442913, MAE_E= 1888.88 meV, MAE_F=  367.51 meV / A
2025-04-29 14:32:02.328 INFO: Epoch 1: head: train, loss=0.63725883, MAE_E= 1758.79 meV, MAE_F=  327.21 meV / A
2025-04-29 14:32:02.970 INFO: Epoch 1: head: validation, loss=0.70464799, MAE_E= 1713.65 meV, MAE_F=  327.23 meV / A
2025-04-29 14:32:05.437 INFO: Epoch 2: head: train, loss=0.43562122, MAE_E= 1407.43 meV, MAE_F=  281.18 meV / A
2025-04-29 14:32:06.071 INFO: Epoch 2: head: validation, loss=0.50310210, MAE_E= 1436.65 meV, MAE_F=  286.97 meV / A
2025-04-29 14:32:08.523 INFO: Epoch 3: head: train, loss=0.38435513, MAE_E= 1198.72 meV, MAE_F=  268.15 meV / A
2025-04-29 14:32:09.184 INFO: Epoch 3: head: validation, loss=0.42962051, MAE_E= 1235.11 meV, MAE_F=  269.98 meV / A
2025-04-29 14:32:11.794 INFO: Epoch 4: head: train, loss=0.50537805, MAE_E= 2343.06 meV, MAE_F=  303.97 meV / A
2025-04-29 14:32:12.438 INFO: Epoch 4: head: validation, loss=0.55291469, MAE_E= 2358.69 meV, MAE_F=  305.29 meV / A
2025-04-29 14:32:14.976 INFO: Epoch 5: head: train, loss=0.39148295, MAE_E=  497.35 meV, MAE_F=  268.24 meV / A
2025-04-29 14:32:15.773 INFO: Epoch 5: head: validation, loss=0.44141426, MAE_E=  511.44 meV, MAE_F=  272.38 meV / A
2025-04-29 14:32:18.251 INFO: Epoch 6: head: train, loss=0.32300357, MAE_E=  557.12 meV, MAE_F=  246.96 meV / A
2025-04-29 14:32:19.002 INFO: Epoch 6: head: validation, loss=0.36724613, MAE_E=  566.25 meV, MAE_F=  252.42 meV / A
2025-04-29 14:32:21.625 INFO: Epoch 7: head: train, loss=0.29043467, MAE_E=  231.35 meV, MAE_F=  235.65 meV / A
2025-04-29 14:32:22.247 INFO: Epoch 7: head: validation, loss=0.33122149, MAE_E=  253.22 meV, MAE_F=  241.95 meV / A
2025-04-29 14:32:24.912 INFO: Epoch 8: head: train, loss=0.27212692, MAE_E=  240.89 meV, MAE_F=  228.41 meV / A
2025-04-29 14:32:25.669 INFO: Epoch 8: head: validation, loss=0.30888204, MAE_E=  253.91 meV, MAE_F=  233.86 meV / A
2025-04-29 14:32:28.195 INFO: Epoch 9: head: train, loss=0.25337135, MAE_E=  205.21 meV, MAE_F=  220.93 meV / A
2025-04-29 14:32:28.840 INFO: Epoch 9: head: validation, loss=0.28657930, MAE_E=  226.40 meV, MAE_F=  225.50 meV / A
2025-04-29 14:32:31.440 INFO: Epoch 10: head: train, loss=0.23016173, MAE_E=  170.37 meV, MAE_F=  209.76 meV / A
2025-04-29 14:32:32.101 INFO: Epoch 10: head: validation, loss=0.26532283, MAE_E=  182.84 meV, MAE_F=  215.48 meV / A
2025-04-29 14:32:34.745 INFO: Epoch 11: head: train, loss=0.20790586, MAE_E=  167.26 meV, MAE_F=  198.48 meV / A
2025-04-29 14:32:35.409 INFO: Epoch 11: head: validation, loss=0.24096226, MAE_E=  176.96 meV, MAE_F=  203.59 meV / A
2025-04-29 14:32:37.936 INFO: Epoch 12: head: train, loss=0.19194365, MAE_E=  474.23 meV, MAE_F=  190.36 meV / A
2025-04-29 14:32:38.560 INFO: Epoch 12: head: validation, loss=0.22506207, MAE_E=  476.51 meV, MAE_F=  195.75 meV / A
2025-04-29 14:32:41.076 INFO: Epoch 13: head: train, loss=0.17379081, MAE_E=  157.04 meV, MAE_F=  181.65 meV / A
2025-04-29 14:32:41.699 INFO: Epoch 13: head: validation, loss=0.20265308, MAE_E=  169.33 meV, MAE_F=  187.14 meV / A
2025-04-29 14:32:44.296 INFO: Epoch 14: head: train, loss=0.35928854, MAE_E=  250.73 meV, MAE_F=  250.77 meV / A
2025-04-29 14:32:44.946 INFO: Epoch 14: head: validation, loss=0.39109763, MAE_E=  253.09 meV, MAE_F=  253.96 meV / A
2025-04-29 14:32:47.370 INFO: Epoch 15: head: train, loss=0.39837444, MAE_E=  330.96 meV, MAE_F=  255.28 meV / A
2025-04-29 14:32:48.119 INFO: Epoch 15: head: validation, loss=0.42515713, MAE_E=  367.36 meV, MAE_F=  256.58 meV / A
2025-04-29 14:32:50.578 INFO: Epoch 16: head: train, loss=0.32086750, MAE_E=  251.72 meV, MAE_F=  234.76 meV / A
2025-04-29 14:32:51.234 INFO: Epoch 16: head: validation, loss=0.35138856, MAE_E=  268.33 meV, MAE_F=  236.32 meV / A
2025-04-29 14:32:53.762 INFO: Epoch 17: head: train, loss=0.32793829, MAE_E=  531.37 meV, MAE_F=  237.36 meV / A
2025-04-29 14:32:54.446 INFO: Epoch 17: head: validation, loss=0.36429989, MAE_E=  536.14 meV, MAE_F=  241.15 meV / A
2025-04-29 14:32:57.033 INFO: Epoch 18: head: train, loss=0.32626380, MAE_E= 1453.56 meV, MAE_F=  241.26 meV / A
2025-04-29 14:32:57.675 INFO: Epoch 18: head: validation, loss=0.37060511, MAE_E= 1445.22 meV, MAE_F=  245.45 meV / A
2025-04-29 14:33:00.130 INFO: Epoch 19: head: train, loss=0.28345341, MAE_E= 1801.80 meV, MAE_F=  229.28 meV / A
2025-04-29 14:33:00.779 INFO: Epoch 19: head: validation, loss=0.32379982, MAE_E= 1796.55 meV, MAE_F=  233.92 meV / A
2025-04-29 14:33:03.319 INFO: Epoch 20: head: train, loss=0.22607053, MAE_E= 2582.56 meV, MAE_F=  207.75 meV / A
2025-04-29 14:33:03.981 INFO: Epoch 20: head: validation, loss=0.26134109, MAE_E= 2582.18 meV, MAE_F=  214.06 meV / A
2025-04-29 14:33:06.493 INFO: Epoch 21: head: train, loss=0.22289828, MAE_E= 4395.23 meV, MAE_F=  203.99 meV / A
2025-04-29 14:33:07.239 INFO: Epoch 21: head: validation, loss=0.25607830, MAE_E= 4383.80 meV, MAE_F=  210.01 meV / A
2025-04-29 14:33:09.667 INFO: Epoch 22: head: train, loss=0.19876060, MAE_E=  419.07 meV, MAE_F=  194.81 meV / A
2025-04-29 14:33:10.323 INFO: Epoch 22: head: validation, loss=0.22632674, MAE_E=  423.92 meV, MAE_F=  199.79 meV / A
2025-04-29 14:33:12.836 INFO: Epoch 23: head: train, loss=0.23278585, MAE_E= 5242.54 meV, MAE_F=  207.03 meV / A
2025-04-29 14:33:13.573 INFO: Epoch 23: head: validation, loss=0.26519243, MAE_E= 5249.18 meV, MAE_F=  213.02 meV / A
2025-04-29 14:33:16.177 INFO: Epoch 24: head: train, loss=0.23582841, MAE_E= 3289.11 meV, MAE_F=  210.66 meV / A
2025-04-29 14:33:16.900 INFO: Epoch 24: head: validation, loss=0.26928898, MAE_E= 3309.91 meV, MAE_F=  217.01 meV / A
2025-04-29 14:33:19.441 INFO: Epoch 25: head: train, loss=0.22884818, MAE_E= 1651.40 meV, MAE_F=  208.74 meV / A
2025-04-29 14:33:20.166 INFO: Epoch 25: head: validation, loss=0.26252458, MAE_E= 1669.14 meV, MAE_F=  215.61 meV / A
2025-04-29 14:33:22.816 INFO: Epoch 26: head: train, loss=0.21795870, MAE_E= 1355.77 meV, MAE_F=  203.20 meV / A
2025-04-29 14:33:23.571 INFO: Epoch 26: head: validation, loss=0.24898374, MAE_E= 1367.36 meV, MAE_F=  209.62 meV / A
2025-04-29 14:33:26.223 INFO: Epoch 27: head: train, loss=0.20332685, MAE_E=  906.84 meV, MAE_F=  196.10 meV / A
2025-04-29 14:33:26.935 INFO: Epoch 27: head: validation, loss=0.23102347, MAE_E=  920.10 meV, MAE_F=  201.36 meV / A
2025-04-29 14:33:29.359 INFO: Epoch 28: head: train, loss=0.19245847, MAE_E= 1025.71 meV, MAE_F=  190.48 meV / A
2025-04-29 14:33:30.041 INFO: Epoch 28: head: validation, loss=0.22184421, MAE_E= 1041.83 meV, MAE_F=  196.20 meV / A
2025-04-29 14:33:32.522 INFO: Epoch 29: head: train, loss=0.18729122, MAE_E=  627.97 meV, MAE_F=  188.46 meV / A
2025-04-29 14:33:33.164 INFO: Epoch 29: head: validation, loss=0.21385533, MAE_E=  639.87 meV, MAE_F=  192.74 meV / A
2025-04-29 14:33:35.657 INFO: Epoch 30: head: train, loss=0.20435140, MAE_E= 1029.28 meV, MAE_F=  195.83 meV / A
2025-04-29 14:33:36.309 INFO: Epoch 30: head: validation, loss=0.23869053, MAE_E= 1049.99 meV, MAE_F=  201.64 meV / A
2025-04-29 14:33:38.924 INFO: Epoch 31: head: train, loss=0.21522190, MAE_E=  796.77 meV, MAE_F=  201.57 meV / A
2025-04-29 14:33:39.685 INFO: Epoch 31: head: validation, loss=0.25058069, MAE_E=  816.17 meV, MAE_F=  206.88 meV / A
2025-04-29 14:33:42.369 INFO: Epoch 32: head: train, loss=0.21354280, MAE_E=  401.68 meV, MAE_F=  201.30 meV / A
2025-04-29 14:33:43.103 INFO: Epoch 32: head: validation, loss=0.24697421, MAE_E=  414.23 meV, MAE_F=  206.24 meV / A
2025-04-29 14:33:45.710 INFO: Epoch 33: head: train, loss=0.20147779, MAE_E=  447.77 meV, MAE_F=  195.38 meV / A
2025-04-29 14:33:46.416 INFO: Epoch 33: head: validation, loss=0.23336106, MAE_E=  460.27 meV, MAE_F=  200.70 meV / A
2025-04-29 14:33:46.417 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:33:46.417 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5979], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:33:46.420 INFO: 
2025-04-29 14:33:46.420 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:33:46.420 INFO: eveluation
2025-04-29 14:33:46.420 INFO: The scale is [0.59789193] and shift is 0.0
2025-04-29 14:33:46.562 INFO: Energy Mean: -64250.447265625, Variance: 0.17664735582139757
2025-04-29 14:33:46.822 INFO: Energy RMSE: 0.2890305519104004
2025-04-29 14:33:46.822 INFO: Energy R2: 0.5270880312426667
2025-04-29 14:33:46.822 INFO: Energy MAE: 0.17712673544883728
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:33:46.823 INFO: Forces RMSE: 0.780042121082065
2025-04-29 14:33:46.823 INFO: Forces R2: 0.8410526463153623
2025-04-29 14:33:47.396 INFO: Energy Mean: -64250.45610894097, Variance: 0.14680764645705988
2025-04-29 14:33:47.522 INFO: Loading checkpoint: results/charge_head/bi11-3_samples_logs//sample_4//checkpoints/bi11-3_samples_run-123_epoch-13.pt
2025-04-29 14:33:47.571 INFO: Loaded Stage one model from epoch 13 for evaluation
2025-04-29 14:33:47.571 INFO: Saving model to results/charge_head/bi11-3_samples_logs/sample_4/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:33:47.736 INFO: Compiling model, saving metadata to results/charge_head/bi11-3_samples_logs/sample_4/bi11-3_samples_compiled.model
2025-04-29 14:33:48.505 INFO: Done

============================= JOB FEEDBACK =============================

Job ID: 3118310
Cluster: hk
User/Group: hv3694/hk-project-aimat2
Account: hk-project-aimat2
State: COMPLETED (exit code 0)
Partition: accelerated
Nodes: 1
Cores per node: 8
Nodelist: hkn0633
CPU Utilized: 00:22:45
CPU Efficiency: 21.27% of 01:46:56 core-walltime
Job Wall-clock time: 00:13:22
Starttime: Tue Apr 29 14:20:27 2025
Endtime: Tue Apr 29 14:33:49 2025
Memory Utilized: 1.85 GB
Memory Efficiency: 0.00% of 0.00 MB
Energy Consumed: 603593 Joule / 167.664722222222 Watthours
Average node power draw: 752.609725685786 Watt
