cuequivariance or cuequivariance_torch is not available. Cuequivariance acceleration will be disabled.
False
Results directory samples/ already exists. Exiting.
Reading data from:  ./raw/bi11-3_samples_parsed.csv
['./raw/bi11-3_samples_parsed.csv']
Reading data from:  ./raw/bi11-3_samples_parsed.csv
[-64251.033010993764]
(11, 3)
Loading saved bootstrap sample 0
Training model 0
Using latent charge and penalty 10
2025-04-29 19:43:05.471 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:43:05.471 INFO: MACE version: 0.3.10
2025-04-29 19:43:05.549 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:43:05.646 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:43:05.646 INFO: Using heads: ['default']
2025-04-29 19:43:05.646 INFO: =============    Processing head default     ===========
2025-04-29 19:43:05.646 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:43:05.654 INFO: Atomic Numbers used: [83]
2025-04-29 19:43:05.654 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.9503639914765}}
2025-04-29 19:43:05.661 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.9503639914765}
2025-04-29 19:43:05.780 INFO: Computing average number of neighbors
2025-04-29 19:43:08.131 INFO: Average number of neighbors: 9.992252066115702
2025-04-29 19:43:08.132 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:43:08.132 INFO: ===========MODEL DETAILS===========
2025-04-29 19:43:08.132 INFO: Building model
2025-04-29 19:43:08.132 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:43:08.132 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:43:08.132 INFO: 8 radial and 5 basis functions
2025-04-29 19:43:08.132 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:43:08.132 INFO: Distance transform for radial basis functions: None
2025-04-29 19:43:08.132 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:43:08.437 INFO: Mean: -0.00022981501887225358, Std: [0.57783606]
0.0 [0.57783606]
2025-04-29 19:43:08.438 INFO: Scale: [0.57783606], Shift: 0.0
2025-04-29 19:43:09.746 INFO: Total number of parameters: 509618
2025-04-29 19:43:09.746 INFO: 
2025-04-29 19:43:09.746 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:43:09.746 INFO: Using ADAM as parameter optimizer
2025-04-29 19:43:09.746 INFO: Batch size: 32
2025-04-29 19:43:09.746 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:43:09.746 INFO: Number of gradient updates: 2250
2025-04-29 19:43:09.746 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:43:09.746 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 19:43:09.748 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:43:09.748 INFO: 
2025-04-29 19:43:09.748 INFO: ===========TRAINING===========
2025-04-29 19:43:09.748 INFO: Started training, reporting errors on validation set
2025-04-29 19:43:09.748 INFO: Loss metrics on validation set
2025-04-29 19:43:12.382 INFO: Initial: head: validation, loss=14.90533035, MAE_E=24623.51 meV, MAE_F=  408.48 meV / A
2025-04-29 19:43:24.356 INFO: Epoch 0: head: train, loss=2.09543749, MAE_E= 7122.68 meV, MAE_F=  368.64 meV / A
2025-04-29 19:43:25.030 INFO: Epoch 0: head: validation, loss=2.16294814, MAE_E= 7197.88 meV, MAE_F=  365.93 meV / A
2025-04-29 19:43:27.289 INFO: Epoch 1: head: train, loss=4.83601339, MAE_E= 2645.18 meV, MAE_F=  388.94 meV / A
2025-04-29 19:43:27.837 INFO: Epoch 1: head: validation, loss=4.95201533, MAE_E= 2564.85 meV, MAE_F=  398.83 meV / A
2025-04-29 19:43:30.018 INFO: Epoch 2: head: train, loss=0.66958079, MAE_E=  401.99 meV, MAE_F=  323.54 meV / A
2025-04-29 19:43:30.573 INFO: Epoch 2: head: validation, loss=0.75300247, MAE_E=  424.12 meV, MAE_F=  328.73 meV / A
2025-04-29 19:43:32.837 INFO: Epoch 3: head: train, loss=0.51612283, MAE_E=  480.95 meV, MAE_F=  295.77 meV / A
2025-04-29 19:43:33.383 INFO: Epoch 3: head: validation, loss=0.59485421, MAE_E=  483.82 meV, MAE_F=  306.01 meV / A
2025-04-29 19:43:35.645 INFO: Epoch 4: head: train, loss=0.40477378, MAE_E=  479.65 meV, MAE_F=  267.54 meV / A
2025-04-29 19:43:36.196 INFO: Epoch 4: head: validation, loss=0.46165278, MAE_E=  552.13 meV, MAE_F=  276.37 meV / A
2025-04-29 19:43:38.478 INFO: Epoch 5: head: train, loss=0.36524013, MAE_E= 1347.41 meV, MAE_F=  259.42 meV / A
2025-04-29 19:43:39.010 INFO: Epoch 5: head: validation, loss=0.41783730, MAE_E= 1429.07 meV, MAE_F=  267.43 meV / A
2025-04-29 19:43:41.290 INFO: Epoch 6: head: train, loss=0.41154519, MAE_E= 2318.19 meV, MAE_F=  270.32 meV / A
2025-04-29 19:43:41.817 INFO: Epoch 6: head: validation, loss=0.46333463, MAE_E= 2385.46 meV, MAE_F=  274.91 meV / A
2025-04-29 19:43:44.116 INFO: Epoch 7: head: train, loss=0.85994097, MAE_E= 1959.43 meV, MAE_F=  346.75 meV / A
2025-04-29 19:43:44.697 INFO: Epoch 7: head: validation, loss=0.90990725, MAE_E= 2028.07 meV, MAE_F=  346.50 meV / A
2025-04-29 19:43:46.924 INFO: Epoch 8: head: train, loss=0.56320366, MAE_E= 2126.62 meV, MAE_F=  317.09 meV / A
2025-04-29 19:43:47.443 INFO: Epoch 8: head: validation, loss=0.60657413, MAE_E= 2190.12 meV, MAE_F=  317.76 meV / A
2025-04-29 19:43:49.697 INFO: Epoch 9: head: train, loss=0.38594076, MAE_E= 1033.68 meV, MAE_F=  264.84 meV / A
2025-04-29 19:43:50.231 INFO: Epoch 9: head: validation, loss=0.43037335, MAE_E= 1095.32 meV, MAE_F=  269.97 meV / A
2025-04-29 19:43:52.396 INFO: Epoch 10: head: train, loss=0.32526551, MAE_E=  284.80 meV, MAE_F=  248.62 meV / A
2025-04-29 19:43:52.911 INFO: Epoch 10: head: validation, loss=0.36275918, MAE_E=  271.82 meV, MAE_F=  252.54 meV / A
2025-04-29 19:43:55.114 INFO: Epoch 11: head: train, loss=0.28379430, MAE_E=  264.20 meV, MAE_F=  235.17 meV / A
2025-04-29 19:43:55.659 INFO: Epoch 11: head: validation, loss=0.32029495, MAE_E=  303.66 meV, MAE_F=  239.69 meV / A
2025-04-29 19:43:57.932 INFO: Epoch 12: head: train, loss=0.25736402, MAE_E=  204.21 meV, MAE_F=  221.66 meV / A
2025-04-29 19:43:58.508 INFO: Epoch 12: head: validation, loss=0.29089660, MAE_E=  235.25 meV, MAE_F=  226.30 meV / A
2025-04-29 19:44:00.872 INFO: Epoch 13: head: train, loss=0.23646458, MAE_E=  223.93 meV, MAE_F=  211.40 meV / A
2025-04-29 19:44:01.421 INFO: Epoch 13: head: validation, loss=0.26916045, MAE_E=  214.09 meV, MAE_F=  216.70 meV / A
2025-04-29 19:44:03.797 INFO: Epoch 14: head: train, loss=0.25257372, MAE_E=  888.87 meV, MAE_F=  218.28 meV / A
2025-04-29 19:44:04.405 INFO: Epoch 14: head: validation, loss=0.28741666, MAE_E=  937.21 meV, MAE_F=  223.16 meV / A
2025-04-29 19:44:06.711 INFO: Epoch 15: head: train, loss=0.48482119, MAE_E= 2946.95 meV, MAE_F=  274.48 meV / A
2025-04-29 19:44:07.299 INFO: Epoch 15: head: validation, loss=0.52557285, MAE_E= 2980.37 meV, MAE_F=  276.89 meV / A
2025-04-29 19:44:09.638 INFO: Epoch 16: head: train, loss=0.84012227, MAE_E= 3895.46 meV, MAE_F=  296.11 meV / A
2025-04-29 19:44:10.191 INFO: Epoch 16: head: validation, loss=0.87716363, MAE_E= 3922.07 meV, MAE_F=  297.84 meV / A
2025-04-29 19:44:12.423 INFO: Epoch 17: head: train, loss=0.60547697, MAE_E= 2653.12 meV, MAE_F=  289.57 meV / A
2025-04-29 19:44:12.943 INFO: Epoch 17: head: validation, loss=0.65800923, MAE_E= 2701.31 meV, MAE_F=  291.07 meV / A
2025-04-29 19:44:15.113 INFO: Epoch 18: head: train, loss=0.57199012, MAE_E=  841.05 meV, MAE_F=  289.69 meV / A
2025-04-29 19:44:15.639 INFO: Epoch 18: head: validation, loss=0.62734849, MAE_E=  903.95 meV, MAE_F=  291.03 meV / A
2025-04-29 19:44:17.875 INFO: Epoch 19: head: train, loss=0.50454568, MAE_E=  567.47 meV, MAE_F=  286.90 meV / A
2025-04-29 19:44:18.420 INFO: Epoch 19: head: validation, loss=0.56906343, MAE_E=  635.60 meV, MAE_F=  292.12 meV / A
2025-04-29 19:44:20.626 INFO: Epoch 20: head: train, loss=0.48034215, MAE_E=  509.57 meV, MAE_F=  279.91 meV / A
2025-04-29 19:44:21.150 INFO: Epoch 20: head: validation, loss=0.54565176, MAE_E=  582.68 meV, MAE_F=  287.22 meV / A
2025-04-29 19:44:23.369 INFO: Epoch 21: head: train, loss=0.41982207, MAE_E=  481.26 meV, MAE_F=  266.87 meV / A
2025-04-29 19:44:23.946 INFO: Epoch 21: head: validation, loss=0.48022677, MAE_E=  463.33 meV, MAE_F=  274.86 meV / A
2025-04-29 19:44:26.196 INFO: Epoch 22: head: train, loss=0.36441416, MAE_E=  366.76 meV, MAE_F=  252.06 meV / A
2025-04-29 19:44:26.707 INFO: Epoch 22: head: validation, loss=0.41753917, MAE_E=  378.59 meV, MAE_F=  260.84 meV / A
2025-04-29 19:44:28.946 INFO: Epoch 23: head: train, loss=0.36666213, MAE_E=  746.28 meV, MAE_F=  241.88 meV / A
2025-04-29 19:44:29.437 INFO: Epoch 23: head: validation, loss=0.41679586, MAE_E=  822.94 meV, MAE_F=  251.21 meV / A
2025-04-29 19:44:31.682 INFO: Epoch 24: head: train, loss=1.07420155, MAE_E=  319.95 meV, MAE_F=  283.20 meV / A
2025-04-29 19:44:32.233 INFO: Epoch 24: head: validation, loss=1.13770222, MAE_E=  342.06 meV, MAE_F=  294.02 meV / A
2025-04-29 19:44:34.472 INFO: Epoch 25: head: train, loss=0.84244415, MAE_E=  577.23 meV, MAE_F=  284.48 meV / A
2025-04-29 19:44:35.004 INFO: Epoch 25: head: validation, loss=0.90372192, MAE_E=  659.26 meV, MAE_F=  294.78 meV / A
2025-04-29 19:44:37.233 INFO: Epoch 26: head: train, loss=0.71527069, MAE_E= 1801.59 meV, MAE_F=  283.97 meV / A
2025-04-29 19:44:37.747 INFO: Epoch 26: head: validation, loss=0.77942098, MAE_E= 1875.36 meV, MAE_F=  289.26 meV / A
2025-04-29 19:44:40.001 INFO: Epoch 27: head: train, loss=0.74925427, MAE_E= 1787.38 meV, MAE_F=  303.08 meV / A
2025-04-29 19:44:40.498 INFO: Epoch 27: head: validation, loss=0.80689300, MAE_E= 1851.76 meV, MAE_F=  304.67 meV / A
2025-04-29 19:44:42.693 INFO: Epoch 28: head: train, loss=0.65319649, MAE_E= 1328.10 meV, MAE_F=  298.48 meV / A
2025-04-29 19:44:43.229 INFO: Epoch 28: head: validation, loss=0.70886391, MAE_E= 1387.74 meV, MAE_F=  299.78 meV / A
2025-04-29 19:44:45.443 INFO: Epoch 29: head: train, loss=0.51518658, MAE_E= 1214.58 meV, MAE_F=  279.31 meV / A
2025-04-29 19:44:46.021 INFO: Epoch 29: head: validation, loss=0.57188582, MAE_E= 1276.13 meV, MAE_F=  283.24 meV / A
2025-04-29 19:44:48.286 INFO: Epoch 30: head: train, loss=0.52123580, MAE_E=  970.75 meV, MAE_F=  273.19 meV / A
2025-04-29 19:44:48.814 INFO: Epoch 30: head: validation, loss=0.58192367, MAE_E= 1036.81 meV, MAE_F=  278.03 meV / A
2025-04-29 19:44:51.062 INFO: Epoch 31: head: train, loss=0.48353873, MAE_E= 1069.52 meV, MAE_F=  264.95 meV / A
2025-04-29 19:44:51.572 INFO: Epoch 31: head: validation, loss=0.53777741, MAE_E= 1137.73 meV, MAE_F=  270.81 meV / A
2025-04-29 19:44:53.807 INFO: Epoch 32: head: train, loss=0.42283398, MAE_E=  935.28 meV, MAE_F=  252.55 meV / A
2025-04-29 19:44:54.341 INFO: Epoch 32: head: validation, loss=0.47230820, MAE_E=  997.60 meV, MAE_F=  259.16 meV / A
2025-04-29 19:44:56.560 INFO: Epoch 33: head: train, loss=0.36756186, MAE_E=  666.75 meV, MAE_F=  248.88 meV / A
2025-04-29 19:44:57.062 INFO: Epoch 33: head: validation, loss=0.41343961, MAE_E=  726.05 meV, MAE_F=  254.78 meV / A
2025-04-29 19:44:57.062 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:44:57.062 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5778], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:44:57.086 INFO: 
2025-04-29 19:44:57.086 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:44:57.086 INFO: eveluation
2025-04-29 19:44:57.086 INFO: The scale is [0.57783606] and shift is 0.0
2025-04-29 19:44:57.218 INFO: Energy Mean: -64250.39019097222, Variance: 0.12033638659818673
2025-04-29 19:44:57.523 INFO: Energy RMSE: 0.3399282991886139
2025-04-29 19:44:57.523 INFO: Energy R2: 0.03976467589945831
2025-04-29 19:44:57.523 INFO: Energy MAE: 0.2541232705116272
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:44:57.525 INFO: Forces RMSE: 1.0130553685286312
2025-04-29 19:44:57.525 INFO: Forces R2: 0.7211595524417524
2025-04-29 19:44:58.043 INFO: Energy Mean: -64250.45400390625, Variance: 0.1257701778411865
2025-04-29 19:44:58.156 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_0//checkpoints/bi11-3_samples_run-123_epoch-13.pt
2025-04-29 19:44:58.205 INFO: Loaded Stage one model from epoch 13 for evaluation
2025-04-29 19:44:58.205 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_0/checkpoints/bi11-3_samples_run-123.model
2025-04-29 19:44:58.369 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_0/bi11-3_samples_compiled.model
2025-04-29 19:44:58.467 INFO: Done
Loading saved bootstrap sample 1
Training model 1
Using latent charge and penalty 10
2025-04-29 19:44:58.872 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:44:58.872 INFO: MACE version: 0.3.10
2025-04-29 19:44:58.872 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:44:58.882 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:44:58.882 INFO: Using heads: ['default']
2025-04-29 19:44:58.882 INFO: =============    Processing head default     ===========
2025-04-29 19:44:58.882 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:44:58.890 INFO: Atomic Numbers used: [83]
2025-04-29 19:44:58.890 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.942795138891}}
2025-04-29 19:44:58.894 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.942795138891}
2025-04-29 19:44:59.016 INFO: Computing average number of neighbors
2025-04-29 19:44:59.472 INFO: Average number of neighbors: 9.993801652892563
2025-04-29 19:44:59.472 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:44:59.474 INFO: ===========MODEL DETAILS===========
2025-04-29 19:44:59.474 INFO: Building model
2025-04-29 19:44:59.474 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:44:59.474 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:44:59.474 INFO: 8 radial and 5 basis functions
2025-04-29 19:44:59.474 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:44:59.474 INFO: Distance transform for radial basis functions: None
2025-04-29 19:44:59.474 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:44:59.906 INFO: Mean: 0.0003285922107915968, Std: [0.61334617]
0.0 [0.61334617]
2025-04-29 19:44:59.906 INFO: Scale: [0.61334617], Shift: 0.0
2025-04-29 19:45:01.185 INFO: Total number of parameters: 509618
2025-04-29 19:45:01.185 INFO: 
2025-04-29 19:45:01.185 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:45:01.185 INFO: Using ADAM as parameter optimizer
2025-04-29 19:45:01.185 INFO: Batch size: 32
2025-04-29 19:45:01.185 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:45:01.185 INFO: Number of gradient updates: 2250
2025-04-29 19:45:01.185 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:45:01.185 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 19:45:01.186 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:45:01.186 INFO: 
2025-04-29 19:45:01.187 INFO: ===========TRAINING===========
2025-04-29 19:45:01.187 INFO: Started training, reporting errors on validation set
2025-04-29 19:45:01.187 INFO: Loss metrics on validation set
2025-04-29 19:45:02.056 INFO: Initial: head: validation, loss=14.88860502, MAE_E=26178.86 meV, MAE_F=  407.82 meV / A
2025-04-29 19:45:04.466 INFO: Epoch 0: head: train, loss=2.17883842, MAE_E= 7547.37 meV, MAE_F=  375.77 meV / A
2025-04-29 19:45:05.208 INFO: Epoch 0: head: validation, loss=2.11931195, MAE_E= 7579.88 meV, MAE_F=  367.61 meV / A
2025-04-29 19:45:07.640 INFO: Epoch 1: head: train, loss=4.91671855, MAE_E=  613.01 meV, MAE_F=  387.93 meV / A
2025-04-29 19:45:08.209 INFO: Epoch 1: head: validation, loss=4.94577244, MAE_E=  537.52 meV, MAE_F=  397.76 meV / A
2025-04-29 19:45:10.516 INFO: Epoch 2: head: train, loss=0.73536965, MAE_E=  800.16 meV, MAE_F=  330.00 meV / A
2025-04-29 19:45:11.069 INFO: Epoch 2: head: validation, loss=0.70937193, MAE_E=  765.79 meV, MAE_F=  331.86 meV / A
2025-04-29 19:45:13.442 INFO: Epoch 3: head: train, loss=0.47579872, MAE_E=  541.84 meV, MAE_F=  290.82 meV / A
2025-04-29 19:45:14.002 INFO: Epoch 3: head: validation, loss=0.50579802, MAE_E=  564.32 meV, MAE_F=  296.25 meV / A
2025-04-29 19:45:16.455 INFO: Epoch 4: head: train, loss=0.37381555, MAE_E=  789.92 meV, MAE_F=  261.51 meV / A
2025-04-29 19:45:17.117 INFO: Epoch 4: head: validation, loss=0.41854834, MAE_E=  855.15 meV, MAE_F=  268.90 meV / A
2025-04-29 19:45:19.583 INFO: Epoch 5: head: train, loss=0.33098033, MAE_E=  394.98 meV, MAE_F=  251.65 meV / A
2025-04-29 19:45:20.244 INFO: Epoch 5: head: validation, loss=0.36833028, MAE_E=  420.50 meV, MAE_F=  257.15 meV / A
2025-04-29 19:45:22.650 INFO: Epoch 6: head: train, loss=0.50756880, MAE_E= 4688.99 meV, MAE_F=  306.73 meV / A
2025-04-29 19:45:23.249 INFO: Epoch 6: head: validation, loss=0.56617783, MAE_E= 4750.36 meV, MAE_F=  318.76 meV / A
2025-04-29 19:45:25.654 INFO: Epoch 7: head: train, loss=0.66196342, MAE_E=  999.52 meV, MAE_F=  333.58 meV / A
2025-04-29 19:45:26.297 INFO: Epoch 7: head: validation, loss=0.68359423, MAE_E= 1018.19 meV, MAE_F=  329.22 meV / A
2025-04-29 19:45:28.768 INFO: Epoch 8: head: train, loss=0.54970229, MAE_E= 1256.47 meV, MAE_F=  312.18 meV / A
2025-04-29 19:45:29.390 INFO: Epoch 8: head: validation, loss=0.60106294, MAE_E= 1237.95 meV, MAE_F=  313.09 meV / A
2025-04-29 19:45:31.855 INFO: Epoch 9: head: train, loss=0.44856051, MAE_E= 1327.09 meV, MAE_F=  273.02 meV / A
2025-04-29 19:45:32.447 INFO: Epoch 9: head: validation, loss=0.49870670, MAE_E= 1301.86 meV, MAE_F=  280.06 meV / A
2025-04-29 19:45:34.855 INFO: Epoch 10: head: train, loss=0.42801652, MAE_E= 1456.30 meV, MAE_F=  272.81 meV / A
2025-04-29 19:45:35.463 INFO: Epoch 10: head: validation, loss=0.46149717, MAE_E= 1448.51 meV, MAE_F=  276.09 meV / A
2025-04-29 19:45:37.894 INFO: Epoch 11: head: train, loss=0.64907966, MAE_E= 1636.38 meV, MAE_F=  265.62 meV / A
2025-04-29 19:45:38.534 INFO: Epoch 11: head: validation, loss=0.68842815, MAE_E= 1630.25 meV, MAE_F=  272.03 meV / A
2025-04-29 19:45:40.896 INFO: Epoch 12: head: train, loss=0.63631922, MAE_E=  747.34 meV, MAE_F=  280.24 meV / A
2025-04-29 19:45:41.591 INFO: Epoch 12: head: validation, loss=0.66548243, MAE_E=  733.52 meV, MAE_F=  283.30 meV / A
2025-04-29 19:45:44.084 INFO: Epoch 13: head: train, loss=0.62369723, MAE_E=  484.42 meV, MAE_F=  256.60 meV / A
2025-04-29 19:45:44.738 INFO: Epoch 13: head: validation, loss=0.66236711, MAE_E=  469.73 meV, MAE_F=  263.73 meV / A
2025-04-29 19:45:47.117 INFO: Epoch 14: head: train, loss=0.44497906, MAE_E=  271.47 meV, MAE_F=  246.79 meV / A
2025-04-29 19:45:47.697 INFO: Epoch 14: head: validation, loss=0.48150650, MAE_E=  265.70 meV, MAE_F=  253.10 meV / A
2025-04-29 19:45:50.165 INFO: Epoch 15: head: train, loss=0.37297230, MAE_E=  332.27 meV, MAE_F=  244.26 meV / A
2025-04-29 19:45:50.818 INFO: Epoch 15: head: validation, loss=0.40683824, MAE_E=  338.54 meV, MAE_F=  249.79 meV / A
2025-04-29 19:45:53.258 INFO: Epoch 16: head: train, loss=0.30744461, MAE_E=  261.46 meV, MAE_F=  234.71 meV / A
2025-04-29 19:45:53.888 INFO: Epoch 16: head: validation, loss=0.33989827, MAE_E=  276.72 meV, MAE_F=  240.81 meV / A
2025-04-29 19:45:56.433 INFO: Epoch 17: head: train, loss=0.31204912, MAE_E=  199.85 meV, MAE_F=  232.89 meV / A
2025-04-29 19:45:57.036 INFO: Epoch 17: head: validation, loss=0.34333486, MAE_E=  222.05 meV, MAE_F=  239.14 meV / A
2025-04-29 19:45:59.416 INFO: Epoch 18: head: train, loss=0.28744226, MAE_E=  213.03 meV, MAE_F=  228.78 meV / A
2025-04-29 19:46:00.019 INFO: Epoch 18: head: validation, loss=0.31877321, MAE_E=  235.91 meV, MAE_F=  235.04 meV / A
2025-04-29 19:46:02.369 INFO: Epoch 19: head: train, loss=0.28100688, MAE_E=  197.85 meV, MAE_F=  228.31 meV / A
2025-04-29 19:46:02.929 INFO: Epoch 19: head: validation, loss=0.30877301, MAE_E=  221.70 meV, MAE_F=  232.99 meV / A
2025-04-29 19:46:05.313 INFO: Epoch 20: head: train, loss=0.27355809, MAE_E=  196.08 meV, MAE_F=  224.79 meV / A
2025-04-29 19:46:05.912 INFO: Epoch 20: head: validation, loss=0.29968331, MAE_E=  220.05 meV, MAE_F=  229.35 meV / A
2025-04-29 19:46:08.341 INFO: Epoch 21: head: train, loss=0.26013979, MAE_E=  213.84 meV, MAE_F=  221.66 meV / A
2025-04-29 19:46:08.982 INFO: Epoch 21: head: validation, loss=0.28626996, MAE_E=  237.11 meV, MAE_F=  226.36 meV / A
2025-04-29 19:46:11.421 INFO: Epoch 22: head: train, loss=0.25128825, MAE_E=  216.83 meV, MAE_F=  220.39 meV / A
2025-04-29 19:46:12.040 INFO: Epoch 22: head: validation, loss=0.27495586, MAE_E=  237.04 meV, MAE_F=  223.91 meV / A
2025-04-29 19:46:14.403 INFO: Epoch 23: head: train, loss=0.24603131, MAE_E=  209.13 meV, MAE_F=  218.24 meV / A
2025-04-29 19:46:14.999 INFO: Epoch 23: head: validation, loss=0.26879465, MAE_E=  229.24 meV, MAE_F=  221.65 meV / A
2025-04-29 19:46:17.370 INFO: Epoch 24: head: train, loss=0.24316915, MAE_E=  211.81 meV, MAE_F=  216.49 meV / A
2025-04-29 19:46:17.957 INFO: Epoch 24: head: validation, loss=0.26439022, MAE_E=  230.23 meV, MAE_F=  219.19 meV / A
2025-04-29 19:46:20.483 INFO: Epoch 25: head: train, loss=0.23659569, MAE_E=  260.35 meV, MAE_F=  214.14 meV / A
2025-04-29 19:46:21.053 INFO: Epoch 25: head: validation, loss=0.25678104, MAE_E=  269.24 meV, MAE_F=  216.38 meV / A
2025-04-29 19:46:23.477 INFO: Epoch 26: head: train, loss=0.23042359, MAE_E=  206.26 meV, MAE_F=  211.12 meV / A
2025-04-29 19:46:24.053 INFO: Epoch 26: head: validation, loss=0.24886092, MAE_E=  215.55 meV, MAE_F=  213.18 meV / A
2025-04-29 19:46:26.467 INFO: Epoch 27: head: train, loss=0.22271986, MAE_E=  232.56 meV, MAE_F=  208.55 meV / A
2025-04-29 19:46:27.086 INFO: Epoch 27: head: validation, loss=0.23767583, MAE_E=  241.14 meV, MAE_F=  209.33 meV / A
2025-04-29 19:46:29.547 INFO: Epoch 28: head: train, loss=0.22351803, MAE_E=  230.09 meV, MAE_F=  207.71 meV / A
2025-04-29 19:46:30.132 INFO: Epoch 28: head: validation, loss=0.23870720, MAE_E=  240.26 meV, MAE_F=  209.37 meV / A
2025-04-29 19:46:32.546 INFO: Epoch 29: head: train, loss=0.23289746, MAE_E=  169.04 meV, MAE_F=  207.99 meV / A
2025-04-29 19:46:33.134 INFO: Epoch 29: head: validation, loss=0.24973684, MAE_E=  173.96 meV, MAE_F=  210.96 meV / A
2025-04-29 19:46:35.537 INFO: Epoch 30: head: train, loss=0.24085642, MAE_E=  183.31 meV, MAE_F=  210.02 meV / A
2025-04-29 19:46:36.100 INFO: Epoch 30: head: validation, loss=0.25934020, MAE_E=  177.73 meV, MAE_F=  213.36 meV / A
2025-04-29 19:46:38.549 INFO: Epoch 31: head: train, loss=0.23370867, MAE_E=  221.09 meV, MAE_F=  208.99 meV / A
2025-04-29 19:46:39.117 INFO: Epoch 31: head: validation, loss=0.25118886, MAE_E=  213.02 meV, MAE_F=  211.67 meV / A
2025-04-29 19:46:41.548 INFO: Epoch 32: head: train, loss=0.22813943, MAE_E=  167.54 meV, MAE_F=  204.69 meV / A
2025-04-29 19:46:42.121 INFO: Epoch 32: head: validation, loss=0.24277041, MAE_E=  166.58 meV, MAE_F=  206.32 meV / A
2025-04-29 19:46:44.535 INFO: Epoch 33: head: train, loss=0.22386059, MAE_E=  167.94 meV, MAE_F=  201.08 meV / A
2025-04-29 19:46:45.203 INFO: Epoch 33: head: validation, loss=0.23715596, MAE_E=  161.25 meV, MAE_F=  202.04 meV / A
2025-04-29 19:46:47.570 INFO: Epoch 34: head: train, loss=0.20802467, MAE_E=  196.75 meV, MAE_F=  197.20 meV / A
2025-04-29 19:46:48.140 INFO: Epoch 34: head: validation, loss=0.21994817, MAE_E=  180.67 meV, MAE_F=  197.78 meV / A
2025-04-29 19:46:50.616 INFO: Epoch 35: head: train, loss=0.31555998, MAE_E=  297.39 meV, MAE_F=  199.34 meV / A
2025-04-29 19:46:51.209 INFO: Epoch 35: head: validation, loss=0.32942711, MAE_E=  270.74 meV, MAE_F=  200.80 meV / A
2025-04-29 19:46:53.660 INFO: Epoch 36: head: train, loss=0.33918804, MAE_E=  252.61 meV, MAE_F=  204.64 meV / A
2025-04-29 19:46:54.318 INFO: Epoch 36: head: validation, loss=0.34837514, MAE_E=  223.73 meV, MAE_F=  204.36 meV / A
2025-04-29 19:46:56.759 INFO: Epoch 37: head: train, loss=0.36053051, MAE_E=  272.41 meV, MAE_F=  207.51 meV / A
2025-04-29 19:46:57.425 INFO: Epoch 37: head: validation, loss=0.38012784, MAE_E=  284.77 meV, MAE_F=  210.29 meV / A
2025-04-29 19:46:59.796 INFO: Epoch 38: head: train, loss=0.31797987, MAE_E=  225.23 meV, MAE_F=  206.22 meV / A
2025-04-29 19:47:00.367 INFO: Epoch 38: head: validation, loss=0.33382283, MAE_E=  221.16 meV, MAE_F=  207.72 meV / A
2025-04-29 19:47:02.693 INFO: Epoch 39: head: train, loss=0.29733910, MAE_E=  276.65 meV, MAE_F=  204.20 meV / A
2025-04-29 19:47:03.268 INFO: Epoch 39: head: validation, loss=0.31096721, MAE_E=  262.12 meV, MAE_F=  205.09 meV / A
2025-04-29 19:47:05.619 INFO: Epoch 40: head: train, loss=0.27525931, MAE_E=  409.20 meV, MAE_F=  201.53 meV / A
2025-04-29 19:47:06.282 INFO: Epoch 40: head: validation, loss=0.28884275, MAE_E=  397.53 meV, MAE_F=  202.76 meV / A
2025-04-29 19:47:08.705 INFO: Epoch 41: head: train, loss=0.24949724, MAE_E=  470.27 meV, MAE_F=  198.99 meV / A
2025-04-29 19:47:09.390 INFO: Epoch 41: head: validation, loss=0.26182458, MAE_E=  465.17 meV, MAE_F=  200.02 meV / A
2025-04-29 19:47:11.826 INFO: Epoch 42: head: train, loss=0.22555762, MAE_E=  372.38 meV, MAE_F=  195.67 meV / A
2025-04-29 19:47:12.428 INFO: Epoch 42: head: validation, loss=0.23871697, MAE_E=  365.68 meV, MAE_F=  197.53 meV / A
2025-04-29 19:47:14.800 INFO: Epoch 43: head: train, loss=0.20885266, MAE_E=  294.43 meV, MAE_F=  192.59 meV / A
2025-04-29 19:47:15.428 INFO: Epoch 43: head: validation, loss=0.22048413, MAE_E=  290.25 meV, MAE_F=  194.26 meV / A
2025-04-29 19:47:17.842 INFO: Epoch 44: head: train, loss=0.19553498, MAE_E=  224.07 meV, MAE_F=  189.07 meV / A
2025-04-29 19:47:18.464 INFO: Epoch 44: head: validation, loss=0.20649607, MAE_E=  214.56 meV, MAE_F=  190.74 meV / A
2025-04-29 19:47:20.930 INFO: Epoch 45: head: train, loss=0.18766286, MAE_E=  185.62 meV, MAE_F=  186.88 meV / A
2025-04-29 19:47:21.508 INFO: Epoch 45: head: validation, loss=0.19647187, MAE_E=  171.84 meV, MAE_F=  187.90 meV / A
2025-04-29 19:47:23.879 INFO: Epoch 46: head: train, loss=0.17858329, MAE_E=  191.35 meV, MAE_F=  183.19 meV / A
2025-04-29 19:47:24.469 INFO: Epoch 46: head: validation, loss=0.18739828, MAE_E=  175.73 meV, MAE_F=  184.54 meV / A
2025-04-29 19:47:26.820 INFO: Epoch 47: head: train, loss=0.17426666, MAE_E=  171.91 meV, MAE_F=  181.15 meV / A
2025-04-29 19:47:27.403 INFO: Epoch 47: head: validation, loss=0.18165411, MAE_E=  158.70 meV, MAE_F=  181.81 meV / A
2025-04-29 19:47:29.785 INFO: Epoch 48: head: train, loss=0.17091718, MAE_E=  313.72 meV, MAE_F=  178.91 meV / A
2025-04-29 19:47:30.368 INFO: Epoch 48: head: validation, loss=0.17684222, MAE_E=  310.73 meV, MAE_F=  179.24 meV / A
2025-04-29 19:47:32.703 INFO: Epoch 49: head: train, loss=0.16736645, MAE_E=  492.94 meV, MAE_F=  176.98 meV / A
2025-04-29 19:47:33.268 INFO: Epoch 49: head: validation, loss=0.17401877, MAE_E=  493.68 meV, MAE_F=  177.89 meV / A
2025-04-29 19:47:35.638 INFO: Epoch 50: head: train, loss=0.16325526, MAE_E=  346.35 meV, MAE_F=  174.48 meV / A
2025-04-29 19:47:36.218 INFO: Epoch 50: head: validation, loss=0.17024725, MAE_E=  338.95 meV, MAE_F=  175.71 meV / A
2025-04-29 19:47:38.661 INFO: Epoch 51: head: train, loss=0.15978571, MAE_E=  348.52 meV, MAE_F=  172.49 meV / A
2025-04-29 19:47:39.235 INFO: Epoch 51: head: validation, loss=0.16585059, MAE_E=  340.97 meV, MAE_F=  173.24 meV / A
2025-04-29 19:47:41.635 INFO: Epoch 52: head: train, loss=0.15484638, MAE_E=  264.40 meV, MAE_F=  169.61 meV / A
2025-04-29 19:47:42.317 INFO: Epoch 52: head: validation, loss=0.16169947, MAE_E=  255.43 meV, MAE_F=  171.13 meV / A
2025-04-29 19:47:44.807 INFO: Epoch 53: head: train, loss=0.27378028, MAE_E= 1372.35 meV, MAE_F=  203.92 meV / A
2025-04-29 19:47:45.412 INFO: Epoch 53: head: validation, loss=0.28417032, MAE_E= 1344.50 meV, MAE_F=  204.93 meV / A
2025-04-29 19:47:47.925 INFO: Epoch 54: head: train, loss=0.65274250, MAE_E= 2598.12 meV, MAE_F=  260.53 meV / A
2025-04-29 19:47:48.596 INFO: Epoch 54: head: validation, loss=0.67144178, MAE_E= 2540.94 meV, MAE_F=  261.21 meV / A
2025-04-29 19:47:51.066 INFO: Epoch 55: head: train, loss=0.64230022, MAE_E= 2957.74 meV, MAE_F=  293.76 meV / A
2025-04-29 19:47:51.728 INFO: Epoch 55: head: validation, loss=0.66805559, MAE_E= 2895.97 meV, MAE_F=  294.58 meV / A
2025-04-29 19:47:54.181 INFO: Epoch 56: head: train, loss=0.66665940, MAE_E= 2277.06 meV, MAE_F=  299.24 meV / A
2025-04-29 19:47:54.758 INFO: Epoch 56: head: validation, loss=0.70004304, MAE_E= 2201.60 meV, MAE_F=  302.58 meV / A
2025-04-29 19:47:57.163 INFO: Epoch 57: head: train, loss=0.58257135, MAE_E= 1911.26 meV, MAE_F=  297.37 meV / A
2025-04-29 19:47:57.761 INFO: Epoch 57: head: validation, loss=0.61541796, MAE_E= 1832.90 meV, MAE_F=  300.84 meV / A
2025-04-29 19:48:00.072 INFO: Epoch 58: head: train, loss=0.57166942, MAE_E= 1968.11 meV, MAE_F=  287.02 meV / A
2025-04-29 19:48:00.707 INFO: Epoch 58: head: validation, loss=0.60463971, MAE_E= 1901.42 meV, MAE_F=  291.92 meV / A
2025-04-29 19:48:03.068 INFO: Epoch 59: head: train, loss=0.54838375, MAE_E= 1823.22 meV, MAE_F=  278.60 meV / A
2025-04-29 19:48:03.641 INFO: Epoch 59: head: validation, loss=0.58320883, MAE_E= 1754.30 meV, MAE_F=  284.44 meV / A
2025-04-29 19:48:05.993 INFO: Epoch 60: head: train, loss=0.50890784, MAE_E= 1472.01 meV, MAE_F=  269.38 meV / A
2025-04-29 19:48:06.584 INFO: Epoch 60: head: validation, loss=0.54306639, MAE_E= 1414.72 meV, MAE_F=  275.98 meV / A
2025-04-29 19:48:09.069 INFO: Epoch 61: head: train, loss=0.46074013, MAE_E= 1267.04 meV, MAE_F=  261.11 meV / A
2025-04-29 19:48:09.706 INFO: Epoch 61: head: validation, loss=0.49597366, MAE_E= 1210.48 meV, MAE_F=  268.34 meV / A
2025-04-29 19:48:12.179 INFO: Epoch 62: head: train, loss=0.40824307, MAE_E= 1148.65 meV, MAE_F=  253.17 meV / A
2025-04-29 19:48:12.813 INFO: Epoch 62: head: validation, loss=0.44430503, MAE_E= 1103.54 meV, MAE_F=  261.29 meV / A
2025-04-29 19:48:15.327 INFO: Epoch 63: head: train, loss=0.37902850, MAE_E= 1080.53 meV, MAE_F=  247.03 meV / A
2025-04-29 19:48:15.997 INFO: Epoch 63: head: validation, loss=0.41298878, MAE_E= 1035.68 meV, MAE_F=  254.66 meV / A
2025-04-29 19:48:18.336 INFO: Epoch 64: head: train, loss=0.34563435, MAE_E=  943.12 meV, MAE_F=  241.06 meV / A
2025-04-29 19:48:18.945 INFO: Epoch 64: head: validation, loss=0.37844249, MAE_E=  898.28 meV, MAE_F=  248.37 meV / A
2025-04-29 19:48:21.313 INFO: Epoch 65: head: train, loss=0.31776622, MAE_E=  817.68 meV, MAE_F=  234.66 meV / A
2025-04-29 19:48:21.899 INFO: Epoch 65: head: validation, loss=0.35005249, MAE_E=  777.82 meV, MAE_F=  242.31 meV / A
2025-04-29 19:48:24.233 INFO: Epoch 66: head: train, loss=0.30053608, MAE_E=  769.98 meV, MAE_F=  229.38 meV / A
2025-04-29 19:48:24.908 INFO: Epoch 66: head: validation, loss=0.33022152, MAE_E=  728.72 meV, MAE_F=  236.41 meV / A
2025-04-29 19:48:27.256 INFO: Epoch 67: head: train, loss=0.28160210, MAE_E=  723.61 meV, MAE_F=  224.45 meV / A
2025-04-29 19:48:27.907 INFO: Epoch 67: head: validation, loss=0.30915486, MAE_E=  680.75 meV, MAE_F=  230.92 meV / A
2025-04-29 19:48:30.343 INFO: Epoch 68: head: train, loss=0.26791817, MAE_E=  644.15 meV, MAE_F=  219.77 meV / A
2025-04-29 19:48:30.907 INFO: Epoch 68: head: validation, loss=0.29335547, MAE_E=  602.27 meV, MAE_F=  225.60 meV / A
2025-04-29 19:48:33.246 INFO: Epoch 69: head: train, loss=0.24999566, MAE_E=  594.42 meV, MAE_F=  213.59 meV / A
2025-04-29 19:48:33.808 INFO: Epoch 69: head: validation, loss=0.27713481, MAE_E=  546.06 meV, MAE_F=  220.02 meV / A
2025-04-29 19:48:36.082 INFO: Epoch 70: head: train, loss=0.24723218, MAE_E=  660.69 meV, MAE_F=  212.71 meV / A
2025-04-29 19:48:36.659 INFO: Epoch 70: head: validation, loss=0.27229212, MAE_E=  612.06 meV, MAE_F=  218.83 meV / A
2025-04-29 19:48:39.061 INFO: Epoch 71: head: train, loss=0.24847361, MAE_E=  514.29 meV, MAE_F=  213.90 meV / A
2025-04-29 19:48:39.631 INFO: Epoch 71: head: validation, loss=0.27363075, MAE_E=  468.71 meV, MAE_F=  219.61 meV / A
2025-04-29 19:48:42.126 INFO: Epoch 72: head: train, loss=0.24533854, MAE_E=  497.68 meV, MAE_F=  212.92 meV / A
2025-04-29 19:48:42.727 INFO: Epoch 72: head: validation, loss=0.26904967, MAE_E=  452.28 meV, MAE_F=  218.30 meV / A
2025-04-29 19:48:42.728 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:48:42.728 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.6133], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:48:42.731 INFO: 
2025-04-29 19:48:42.731 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:48:42.731 INFO: eveluation
2025-04-29 19:48:42.731 INFO: The scale is [0.61334617] and shift is 0.0
2025-04-29 19:48:42.869 INFO: Energy Mean: -64250.365494791666, Variance: 0.13094246758355035
2025-04-29 19:48:43.142 INFO: Energy RMSE: 0.48129040002822876
2025-04-29 19:48:43.142 INFO: Energy R2: -0.7690246696328422
2025-04-29 19:48:43.142 INFO: Energy MAE: 0.4375433921813965
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:48:43.143 INFO: Forces RMSE: 0.8703746709000684
2025-04-29 19:48:43.143 INFO: Forces R2: 0.7872589748199648
2025-04-29 19:48:43.664 INFO: Energy Mean: -64250.37074652778, Variance: 0.15063328872492285
2025-04-29 19:48:43.783 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_1//checkpoints/bi11-3_samples_run-123_epoch-52.pt
2025-04-29 19:48:43.833 INFO: Loaded Stage one model from epoch 52 for evaluation
2025-04-29 19:48:43.834 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_1/checkpoints/bi11-3_samples_run-123.model
2025-04-29 19:48:43.993 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_1/bi11-3_samples_compiled.model
2025-04-29 19:48:44.082 INFO: Done
Loading saved bootstrap sample 2
Training model 2
Using latent charge and penalty 10
2025-04-29 19:48:44.495 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:48:44.495 INFO: MACE version: 0.3.10
2025-04-29 19:48:44.495 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:48:44.500 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:48:44.501 INFO: Using heads: ['default']
2025-04-29 19:48:44.501 INFO: =============    Processing head default     ===========
2025-04-29 19:48:44.501 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:48:44.508 INFO: Atomic Numbers used: [83]
2025-04-29 19:48:44.508 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.947529987373}}
2025-04-29 19:48:44.513 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.947529987373}
2025-04-29 19:48:44.633 INFO: Computing average number of neighbors
2025-04-29 19:48:45.141 INFO: Average number of neighbors: 9.996384297520661
2025-04-29 19:48:45.141 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:48:45.143 INFO: ===========MODEL DETAILS===========
2025-04-29 19:48:45.143 INFO: Building model
2025-04-29 19:48:45.143 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:48:45.143 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:48:45.143 INFO: 8 radial and 5 basis functions
2025-04-29 19:48:45.143 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:48:45.143 INFO: Distance transform for radial basis functions: None
2025-04-29 19:48:45.143 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:48:45.637 INFO: Mean: -0.0005770148220544193, Std: [0.61547296]
0.0 [0.61547296]
2025-04-29 19:48:45.637 INFO: Scale: [0.61547296], Shift: 0.0
2025-04-29 19:48:46.902 INFO: Total number of parameters: 509618
2025-04-29 19:48:46.902 INFO: 
2025-04-29 19:48:46.902 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:48:46.902 INFO: Using ADAM as parameter optimizer
2025-04-29 19:48:46.902 INFO: Batch size: 32
2025-04-29 19:48:46.902 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:48:46.902 INFO: Number of gradient updates: 2250
2025-04-29 19:48:46.902 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:48:46.902 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 19:48:46.904 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:48:46.904 INFO: 
2025-04-29 19:48:46.904 INFO: ===========TRAINING===========
2025-04-29 19:48:46.904 INFO: Started training, reporting errors on validation set
2025-04-29 19:48:46.904 INFO: Loss metrics on validation set
2025-04-29 19:48:47.786 INFO: Initial: head: validation, loss=14.85165101, MAE_E=26241.60 meV, MAE_F=  406.14 meV / A
2025-04-29 19:48:50.203 INFO: Epoch 0: head: train, loss=2.18038164, MAE_E= 7636.93 meV, MAE_F=  386.03 meV / A
2025-04-29 19:48:50.929 INFO: Epoch 0: head: validation, loss=2.07700920, MAE_E= 7669.52 meV, MAE_F=  363.62 meV / A
2025-04-29 19:48:53.310 INFO: Epoch 1: head: train, loss=4.90290082, MAE_E=  582.19 meV, MAE_F=  384.81 meV / A
2025-04-29 19:48:53.897 INFO: Epoch 1: head: validation, loss=4.93433404, MAE_E=  473.96 meV, MAE_F=  389.79 meV / A
2025-04-29 19:48:56.227 INFO: Epoch 2: head: train, loss=0.73206190, MAE_E=  646.02 meV, MAE_F=  340.80 meV / A
2025-04-29 19:48:56.918 INFO: Epoch 2: head: validation, loss=0.68913507, MAE_E=  528.75 meV, MAE_F=  325.15 meV / A
2025-04-29 19:48:59.413 INFO: Epoch 3: head: train, loss=0.48944769, MAE_E=  486.06 meV, MAE_F=  293.19 meV / A
2025-04-29 19:49:00.078 INFO: Epoch 3: head: validation, loss=0.53458726, MAE_E=  587.38 meV, MAE_F=  303.85 meV / A
2025-04-29 19:49:02.565 INFO: Epoch 4: head: train, loss=0.38176803, MAE_E=  440.74 meV, MAE_F=  263.86 meV / A
2025-04-29 19:49:03.221 INFO: Epoch 4: head: validation, loss=0.41088562, MAE_E=  542.13 meV, MAE_F=  268.59 meV / A
2025-04-29 19:49:05.680 INFO: Epoch 5: head: train, loss=0.38135072, MAE_E=  331.44 meV, MAE_F=  250.40 meV / A
2025-04-29 19:49:06.350 INFO: Epoch 5: head: validation, loss=0.40763293, MAE_E=  380.86 meV, MAE_F=  255.68 meV / A
2025-04-29 19:49:08.848 INFO: Epoch 6: head: train, loss=0.41318226, MAE_E= 1652.81 meV, MAE_F=  270.83 meV / A
2025-04-29 19:49:09.464 INFO: Epoch 6: head: validation, loss=0.42680902, MAE_E= 1697.12 meV, MAE_F=  273.32 meV / A
2025-04-29 19:49:11.841 INFO: Epoch 7: head: train, loss=0.51992124, MAE_E= 2405.56 meV, MAE_F=  245.52 meV / A
2025-04-29 19:49:12.446 INFO: Epoch 7: head: validation, loss=0.54902516, MAE_E= 2432.46 meV, MAE_F=  251.56 meV / A
2025-04-29 19:49:14.875 INFO: Epoch 8: head: train, loss=0.35219861, MAE_E= 3516.16 meV, MAE_F=  250.09 meV / A
2025-04-29 19:49:15.461 INFO: Epoch 8: head: validation, loss=0.36927711, MAE_E= 3526.55 meV, MAE_F=  250.70 meV / A
2025-04-29 19:49:17.891 INFO: Epoch 9: head: train, loss=0.43208431, MAE_E= 3670.92 meV, MAE_F=  254.08 meV / A
2025-04-29 19:49:18.543 INFO: Epoch 9: head: validation, loss=0.44708104, MAE_E= 3689.87 meV, MAE_F=  255.33 meV / A
2025-04-29 19:49:20.885 INFO: Epoch 10: head: train, loss=2.54252515, MAE_E=  377.42 meV, MAE_F=  315.92 meV / A
2025-04-29 19:49:21.532 INFO: Epoch 10: head: validation, loss=2.50524584, MAE_E=  428.00 meV, MAE_F=  302.08 meV / A
2025-04-29 19:49:23.964 INFO: Epoch 11: head: train, loss=1.19703657, MAE_E= 1131.48 meV, MAE_F=  318.50 meV / A
2025-04-29 19:49:24.617 INFO: Epoch 11: head: validation, loss=1.17050825, MAE_E= 1047.44 meV, MAE_F=  308.13 meV / A
2025-04-29 19:49:27.010 INFO: Epoch 12: head: train, loss=0.63173441, MAE_E=  691.72 meV, MAE_F=  291.34 meV / A
2025-04-29 19:49:27.623 INFO: Epoch 12: head: validation, loss=0.63335819, MAE_E=  570.26 meV, MAE_F=  288.72 meV / A
2025-04-29 19:49:30.106 INFO: Epoch 13: head: train, loss=0.47802686, MAE_E=  347.19 meV, MAE_F=  262.80 meV / A
2025-04-29 19:49:30.768 INFO: Epoch 13: head: validation, loss=0.49891581, MAE_E=  335.61 meV, MAE_F=  266.51 meV / A
2025-04-29 19:49:33.210 INFO: Epoch 14: head: train, loss=0.34831318, MAE_E=  296.36 meV, MAE_F=  243.31 meV / A
2025-04-29 19:49:33.822 INFO: Epoch 14: head: validation, loss=0.37649369, MAE_E=  288.43 meV, MAE_F=  249.46 meV / A
2025-04-29 19:49:36.176 INFO: Epoch 15: head: train, loss=0.27243726, MAE_E=  328.01 meV, MAE_F=  227.20 meV / A
2025-04-29 19:49:36.783 INFO: Epoch 15: head: validation, loss=0.29689754, MAE_E=  269.30 meV, MAE_F=  232.40 meV / A
2025-04-29 19:49:39.165 INFO: Epoch 16: head: train, loss=0.29361830, MAE_E=  336.57 meV, MAE_F=  225.81 meV / A
2025-04-29 19:49:39.747 INFO: Epoch 16: head: validation, loss=0.32171554, MAE_E=  278.04 meV, MAE_F=  233.00 meV / A
2025-04-29 19:49:42.134 INFO: Epoch 17: head: train, loss=0.28317200, MAE_E=  293.61 meV, MAE_F=  224.14 meV / A
2025-04-29 19:49:42.746 INFO: Epoch 17: head: validation, loss=0.31029463, MAE_E=  269.18 meV, MAE_F=  230.69 meV / A
2025-04-29 19:49:45.132 INFO: Epoch 18: head: train, loss=0.25512555, MAE_E=  246.44 meV, MAE_F=  215.34 meV / A
2025-04-29 19:49:45.765 INFO: Epoch 18: head: validation, loss=0.27786949, MAE_E=  261.00 meV, MAE_F=  219.19 meV / A
2025-04-29 19:49:48.297 INFO: Epoch 19: head: train, loss=0.22482752, MAE_E=  225.83 meV, MAE_F=  203.98 meV / A
2025-04-29 19:49:48.933 INFO: Epoch 19: head: validation, loss=0.24479936, MAE_E=  183.71 meV, MAE_F=  206.91 meV / A
2025-04-29 19:49:51.354 INFO: Epoch 20: head: train, loss=0.20505951, MAE_E=  329.67 meV, MAE_F=  197.44 meV / A
2025-04-29 19:49:52.039 INFO: Epoch 20: head: validation, loss=0.22612980, MAE_E=  355.44 meV, MAE_F=  201.29 meV / A
2025-04-29 19:49:54.590 INFO: Epoch 21: head: train, loss=0.22166897, MAE_E=  281.05 meV, MAE_F=  200.60 meV / A
2025-04-29 19:49:55.236 INFO: Epoch 21: head: validation, loss=0.24607735, MAE_E=  327.94 meV, MAE_F=  205.96 meV / A
2025-04-29 19:49:57.705 INFO: Epoch 22: head: train, loss=0.21919715, MAE_E=  365.27 meV, MAE_F=  199.68 meV / A
2025-04-29 19:49:58.305 INFO: Epoch 22: head: validation, loss=0.24595411, MAE_E=  425.58 meV, MAE_F=  206.45 meV / A
2025-04-29 19:50:00.669 INFO: Epoch 23: head: train, loss=0.22587581, MAE_E=  245.21 meV, MAE_F=  199.01 meV / A
2025-04-29 19:50:01.267 INFO: Epoch 23: head: validation, loss=0.24989420, MAE_E=  235.33 meV, MAE_F=  205.33 meV / A
2025-04-29 19:50:03.595 INFO: Epoch 24: head: train, loss=0.29949844, MAE_E=  271.40 meV, MAE_F=  228.12 meV / A
2025-04-29 19:50:04.255 INFO: Epoch 24: head: validation, loss=0.32652468, MAE_E=  295.82 meV, MAE_F=  235.60 meV / A
2025-04-29 19:50:06.691 INFO: Epoch 25: head: train, loss=0.28966647, MAE_E=  522.71 meV, MAE_F=  228.53 meV / A
2025-04-29 19:50:07.352 INFO: Epoch 25: head: validation, loss=0.31336259, MAE_E=  546.96 meV, MAE_F=  234.50 meV / A
2025-04-29 19:50:09.809 INFO: Epoch 26: head: train, loss=0.27612565, MAE_E=  247.62 meV, MAE_F=  225.18 meV / A
2025-04-29 19:50:10.414 INFO: Epoch 26: head: validation, loss=0.29813558, MAE_E=  273.45 meV, MAE_F=  230.39 meV / A
2025-04-29 19:50:12.772 INFO: Epoch 27: head: train, loss=0.26354650, MAE_E= 1474.00 meV, MAE_F=  216.08 meV / A
2025-04-29 19:50:13.371 INFO: Epoch 27: head: validation, loss=0.28394114, MAE_E= 1489.38 meV, MAE_F=  219.71 meV / A
2025-04-29 19:50:15.752 INFO: Epoch 28: head: train, loss=0.38487796, MAE_E= 2805.32 meV, MAE_F=  256.16 meV / A
2025-04-29 19:50:16.353 INFO: Epoch 28: head: validation, loss=0.39671996, MAE_E= 2809.10 meV, MAE_F=  252.45 meV / A
2025-04-29 19:50:18.769 INFO: Epoch 29: head: train, loss=0.37852115, MAE_E= 1889.92 meV, MAE_F=  255.02 meV / A
2025-04-29 19:50:19.402 INFO: Epoch 29: head: validation, loss=0.38854492, MAE_E= 1894.06 meV, MAE_F=  250.42 meV / A
2025-04-29 19:50:21.756 INFO: Epoch 30: head: train, loss=0.51023621, MAE_E= 2156.32 meV, MAE_F=  274.54 meV / A
2025-04-29 19:50:22.368 INFO: Epoch 30: head: validation, loss=0.53983367, MAE_E= 2186.96 meV, MAE_F=  275.65 meV / A
2025-04-29 19:50:24.727 INFO: Epoch 31: head: train, loss=0.64994495, MAE_E= 2328.79 meV, MAE_F=  315.83 meV / A
2025-04-29 19:50:25.329 INFO: Epoch 31: head: validation, loss=0.71539133, MAE_E= 2386.86 meV, MAE_F=  324.29 meV / A
2025-04-29 19:50:27.773 INFO: Epoch 32: head: train, loss=0.65314324, MAE_E= 1616.45 meV, MAE_F=  308.84 meV / A
2025-04-29 19:50:28.361 INFO: Epoch 32: head: validation, loss=0.72923450, MAE_E= 1689.31 meV, MAE_F=  321.73 meV / A
2025-04-29 19:50:30.687 INFO: Epoch 33: head: train, loss=0.53621008, MAE_E= 1048.01 meV, MAE_F=  283.06 meV / A
2025-04-29 19:50:31.292 INFO: Epoch 33: head: validation, loss=0.60299830, MAE_E= 1119.69 meV, MAE_F=  296.57 meV / A
2025-04-29 19:50:33.691 INFO: Epoch 34: head: train, loss=0.43030084, MAE_E=  315.90 meV, MAE_F=  259.03 meV / A
2025-04-29 19:50:34.298 INFO: Epoch 34: head: validation, loss=0.47154419, MAE_E=  359.98 meV, MAE_F=  268.44 meV / A
2025-04-29 19:50:36.755 INFO: Epoch 35: head: train, loss=0.35772744, MAE_E=  340.72 meV, MAE_F=  245.75 meV / A
2025-04-29 19:50:37.393 INFO: Epoch 35: head: validation, loss=0.39029158, MAE_E=  381.39 meV, MAE_F=  253.85 meV / A
2025-04-29 19:50:39.763 INFO: Epoch 36: head: train, loss=0.32017419, MAE_E=  255.20 meV, MAE_F=  236.64 meV / A
2025-04-29 19:50:40.371 INFO: Epoch 36: head: validation, loss=0.34636705, MAE_E=  260.03 meV, MAE_F=  242.91 meV / A
2025-04-29 19:50:42.732 INFO: Epoch 37: head: train, loss=0.29101726, MAE_E=  255.72 meV, MAE_F=  229.89 meV / A
2025-04-29 19:50:43.389 INFO: Epoch 37: head: validation, loss=0.31182724, MAE_E=  219.45 meV, MAE_F=  234.82 meV / A
2025-04-29 19:50:45.758 INFO: Epoch 38: head: train, loss=0.27240788, MAE_E=  230.43 meV, MAE_F=  224.67 meV / A
2025-04-29 19:50:46.398 INFO: Epoch 38: head: validation, loss=0.29210503, MAE_E=  234.94 meV, MAE_F=  228.93 meV / A
2025-04-29 19:50:48.778 INFO: Epoch 39: head: train, loss=0.26286346, MAE_E=  223.03 meV, MAE_F=  221.49 meV / A
2025-04-29 19:50:49.403 INFO: Epoch 39: head: validation, loss=0.28010697, MAE_E=  221.73 meV, MAE_F=  224.49 meV / A
2025-04-29 19:50:51.731 INFO: Epoch 40: head: train, loss=0.25547850, MAE_E=  231.99 meV, MAE_F=  218.42 meV / A
2025-04-29 19:50:52.413 INFO: Epoch 40: head: validation, loss=0.27064294, MAE_E=  224.13 meV, MAE_F=  220.73 meV / A
2025-04-29 19:50:52.414 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:50:52.414 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.6155], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:50:52.416 INFO: 
2025-04-29 19:50:52.416 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:50:52.416 INFO: eveluation
2025-04-29 19:50:52.416 INFO: The scale is [0.61547296] and shift is 0.0
2025-04-29 19:50:52.551 INFO: Energy Mean: -64250.40130208333, Variance: 0.115860595703125
2025-04-29 19:50:52.833 INFO: Energy RMSE: 0.44467678666114807
2025-04-29 19:50:52.833 INFO: Energy R2: -0.7066843085539156
2025-04-29 19:50:52.833 INFO: Energy MAE: 0.40681424736976624
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:50:52.834 INFO: Forces RMSE: 0.8944163241278839
2025-04-29 19:50:52.834 INFO: Forces R2: 0.7660582657837036
2025-04-29 19:50:53.345 INFO: Energy Mean: -64250.42282986111, Variance: 0.15901635440779324
2025-04-29 19:50:53.471 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_2//checkpoints/bi11-3_samples_run-123_epoch-20.pt
2025-04-29 19:50:53.515 INFO: Loaded Stage one model from epoch 20 for evaluation
2025-04-29 19:50:53.516 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_2/checkpoints/bi11-3_samples_run-123.model
2025-04-29 19:50:53.674 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_2/bi11-3_samples_compiled.model
2025-04-29 19:50:53.762 INFO: Done
Loading saved bootstrap sample 3
Training model 3
Using latent charge and penalty 10
2025-04-29 19:50:54.165 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:50:54.166 INFO: MACE version: 0.3.10
2025-04-29 19:50:54.166 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:50:54.172 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:50:54.172 INFO: Using heads: ['default']
2025-04-29 19:50:54.172 INFO: =============    Processing head default     ===========
2025-04-29 19:50:54.172 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:50:54.180 INFO: Atomic Numbers used: [83]
2025-04-29 19:50:54.180 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.94426886048}}
2025-04-29 19:50:54.184 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.94426886048}
2025-04-29 19:50:54.302 INFO: Computing average number of neighbors
2025-04-29 19:50:55.231 INFO: Average number of neighbors: 9.995351239669422
2025-04-29 19:50:55.231 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:50:55.233 INFO: ===========MODEL DETAILS===========
2025-04-29 19:50:55.233 INFO: Building model
2025-04-29 19:50:55.233 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:50:55.233 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:50:55.233 INFO: 8 radial and 5 basis functions
2025-04-29 19:50:55.233 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:50:55.233 INFO: Distance transform for radial basis functions: None
2025-04-29 19:50:55.233 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:50:55.751 INFO: Mean: -0.00015989080951058488, Std: [0.60218935]
0.0 [0.60218935]
2025-04-29 19:50:55.751 INFO: Scale: [0.60218935], Shift: 0.0
2025-04-29 19:50:56.912 INFO: Total number of parameters: 509618
2025-04-29 19:50:56.912 INFO: 
2025-04-29 19:50:56.912 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:50:56.912 INFO: Using ADAM as parameter optimizer
2025-04-29 19:50:56.912 INFO: Batch size: 32
2025-04-29 19:50:56.912 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:50:56.912 INFO: Number of gradient updates: 2250
2025-04-29 19:50:56.912 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:50:56.912 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 19:50:56.914 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:50:56.914 INFO: 
2025-04-29 19:50:56.914 INFO: ===========TRAINING===========
2025-04-29 19:50:56.914 INFO: Started training, reporting errors on validation set
2025-04-29 19:50:56.914 INFO: Loss metrics on validation set
2025-04-29 19:50:57.781 INFO: Initial: head: validation, loss=14.91473687, MAE_E=25725.68 meV, MAE_F=  418.67 meV / A
2025-04-29 19:51:00.327 INFO: Epoch 0: head: train, loss=2.15173720, MAE_E= 7284.54 meV, MAE_F=  381.84 meV / A
2025-04-29 19:51:01.078 INFO: Epoch 0: head: validation, loss=2.12006984, MAE_E= 7259.20 meV, MAE_F=  369.57 meV / A
2025-04-29 19:51:03.475 INFO: Epoch 1: head: train, loss=4.86324602, MAE_E=  898.42 meV, MAE_F=  385.68 meV / A
2025-04-29 19:51:04.175 INFO: Epoch 1: head: validation, loss=4.86989169, MAE_E=  891.49 meV, MAE_F=  383.49 meV / A
2025-04-29 19:51:06.510 INFO: Epoch 2: head: train, loss=0.69705970, MAE_E=  695.33 meV, MAE_F=  333.08 meV / A
2025-04-29 19:51:07.105 INFO: Epoch 2: head: validation, loss=0.69925321, MAE_E=  661.09 meV, MAE_F=  330.08 meV / A
2025-04-29 19:51:09.524 INFO: Epoch 3: head: train, loss=0.48042795, MAE_E=  589.14 meV, MAE_F=  292.33 meV / A
2025-04-29 19:51:10.206 INFO: Epoch 3: head: validation, loss=0.49991750, MAE_E=  571.60 meV, MAE_F=  292.22 meV / A
2025-04-29 19:51:12.657 INFO: Epoch 4: head: train, loss=0.38149929, MAE_E=  479.05 meV, MAE_F=  261.54 meV / A
2025-04-29 19:51:13.260 INFO: Epoch 4: head: validation, loss=0.39241300, MAE_E=  497.07 meV, MAE_F=  258.62 meV / A
2025-04-29 19:51:15.672 INFO: Epoch 5: head: train, loss=0.34683976, MAE_E=  313.25 meV, MAE_F=  253.52 meV / A
2025-04-29 19:51:16.344 INFO: Epoch 5: head: validation, loss=0.35307946, MAE_E=  334.55 meV, MAE_F=  249.89 meV / A
2025-04-29 19:51:19.000 INFO: Epoch 6: head: train, loss=0.32915359, MAE_E=  779.63 meV, MAE_F=  246.43 meV / A
2025-04-29 19:51:19.686 INFO: Epoch 6: head: validation, loss=0.33480035, MAE_E=  774.75 meV, MAE_F=  243.72 meV / A
2025-04-29 19:51:22.254 INFO: Epoch 7: head: train, loss=0.27588400, MAE_E=  660.41 meV, MAE_F=  227.82 meV / A
2025-04-29 19:51:22.951 INFO: Epoch 7: head: validation, loss=0.28517904, MAE_E=  656.66 meV, MAE_F=  226.41 meV / A
2025-04-29 19:51:25.478 INFO: Epoch 8: head: train, loss=0.34563872, MAE_E=  396.27 meV, MAE_F=  237.01 meV / A
2025-04-29 19:51:26.156 INFO: Epoch 8: head: validation, loss=0.35705506, MAE_E=  411.08 meV, MAE_F=  235.82 meV / A
2025-04-29 19:51:28.690 INFO: Epoch 9: head: train, loss=0.31394089, MAE_E=  974.96 meV, MAE_F=  227.46 meV / A
2025-04-29 19:51:29.345 INFO: Epoch 9: head: validation, loss=0.32585363, MAE_E=  991.74 meV, MAE_F=  226.29 meV / A
2025-04-29 19:51:31.850 INFO: Epoch 10: head: train, loss=0.25702356, MAE_E=  468.44 meV, MAE_F=  215.35 meV / A
2025-04-29 19:51:32.518 INFO: Epoch 10: head: validation, loss=0.26600423, MAE_E=  485.91 meV, MAE_F=  213.57 meV / A
2025-04-29 19:51:35.032 INFO: Epoch 11: head: train, loss=0.99667877, MAE_E= 2916.15 meV, MAE_F=  258.84 meV / A
2025-04-29 19:51:35.607 INFO: Epoch 11: head: validation, loss=1.00305421, MAE_E= 2907.36 meV, MAE_F=  255.75 meV / A
2025-04-29 19:51:38.023 INFO: Epoch 12: head: train, loss=2.14148209, MAE_E= 2956.01 meV, MAE_F=  347.69 meV / A
2025-04-29 19:51:38.673 INFO: Epoch 12: head: validation, loss=2.13666619, MAE_E= 2936.69 meV, MAE_F=  339.81 meV / A
2025-04-29 19:51:41.073 INFO: Epoch 13: head: train, loss=2.38953965, MAE_E= 1863.95 meV, MAE_F=  338.36 meV / A
2025-04-29 19:51:41.680 INFO: Epoch 13: head: validation, loss=2.37427449, MAE_E= 1855.54 meV, MAE_F=  329.11 meV / A
2025-04-29 19:51:44.025 INFO: Epoch 14: head: train, loss=1.00158017, MAE_E=  718.35 meV, MAE_F=  327.79 meV / A
2025-04-29 19:51:44.627 INFO: Epoch 14: head: validation, loss=0.99652169, MAE_E=  714.97 meV, MAE_F=  321.98 meV / A
2025-04-29 19:51:47.034 INFO: Epoch 15: head: train, loss=0.56323529, MAE_E= 1324.14 meV, MAE_F=  302.91 meV / A
2025-04-29 19:51:47.662 INFO: Epoch 15: head: validation, loss=0.56742022, MAE_E= 1292.32 meV, MAE_F=  299.60 meV / A
2025-04-29 19:51:50.212 INFO: Epoch 16: head: train, loss=0.45620786, MAE_E= 1536.97 meV, MAE_F=  285.75 meV / A
2025-04-29 19:51:50.832 INFO: Epoch 16: head: validation, loss=0.45720029, MAE_E= 1515.50 meV, MAE_F=  282.06 meV / A
2025-04-29 19:51:53.315 INFO: Epoch 17: head: train, loss=0.43052276, MAE_E= 2317.96 meV, MAE_F=  273.48 meV / A
2025-04-29 19:51:53.924 INFO: Epoch 17: head: validation, loss=0.45188290, MAE_E= 2296.44 meV, MAE_F=  275.03 meV / A
2025-04-29 19:51:56.538 INFO: Epoch 18: head: train, loss=0.40683655, MAE_E= 1415.95 meV, MAE_F=  271.01 meV / A
2025-04-29 19:51:57.157 INFO: Epoch 18: head: validation, loss=0.42736340, MAE_E= 1364.53 meV, MAE_F=  272.34 meV / A
2025-04-29 19:51:59.667 INFO: Epoch 19: head: train, loss=0.38957861, MAE_E= 1262.88 meV, MAE_F=  268.74 meV / A
2025-04-29 19:52:00.314 INFO: Epoch 19: head: validation, loss=0.40523632, MAE_E= 1221.44 meV, MAE_F=  269.07 meV / A
2025-04-29 19:52:02.718 INFO: Epoch 20: head: train, loss=0.44099019, MAE_E= 1884.45 meV, MAE_F=  264.26 meV / A
2025-04-29 19:52:03.349 INFO: Epoch 20: head: validation, loss=0.45374899, MAE_E= 1865.37 meV, MAE_F=  264.06 meV / A
2025-04-29 19:52:05.875 INFO: Epoch 21: head: train, loss=0.42270695, MAE_E= 1313.43 meV, MAE_F=  262.45 meV / A
2025-04-29 19:52:06.547 INFO: Epoch 21: head: validation, loss=0.43399466, MAE_E= 1279.39 meV, MAE_F=  261.71 meV / A
2025-04-29 19:52:09.043 INFO: Epoch 22: head: train, loss=0.39067094, MAE_E=  901.88 meV, MAE_F=  260.82 meV / A
2025-04-29 19:52:09.635 INFO: Epoch 22: head: validation, loss=0.40189065, MAE_E=  870.77 meV, MAE_F=  260.11 meV / A
2025-04-29 19:52:11.990 INFO: Epoch 23: head: train, loss=0.37826063, MAE_E=  950.09 meV, MAE_F=  258.14 meV / A
2025-04-29 19:52:12.624 INFO: Epoch 23: head: validation, loss=0.38859269, MAE_E=  914.74 meV, MAE_F=  256.97 meV / A
2025-04-29 19:52:14.956 INFO: Epoch 24: head: train, loss=0.35685283, MAE_E= 1213.06 meV, MAE_F=  253.64 meV / A
2025-04-29 19:52:15.580 INFO: Epoch 24: head: validation, loss=0.36718384, MAE_E= 1183.78 meV, MAE_F=  252.63 meV / A
2025-04-29 19:52:18.031 INFO: Epoch 25: head: train, loss=0.33507465, MAE_E= 1060.16 meV, MAE_F=  248.65 meV / A
2025-04-29 19:52:18.791 INFO: Epoch 25: head: validation, loss=0.34352129, MAE_E= 1030.09 meV, MAE_F=  246.94 meV / A
2025-04-29 19:52:21.168 INFO: Epoch 26: head: train, loss=0.31376284, MAE_E= 1013.71 meV, MAE_F=  241.96 meV / A
2025-04-29 19:52:21.804 INFO: Epoch 26: head: validation, loss=0.32221479, MAE_E=  982.57 meV, MAE_F=  240.58 meV / A
2025-04-29 19:52:24.182 INFO: Epoch 27: head: train, loss=0.29337627, MAE_E=  710.96 meV, MAE_F=  234.88 meV / A
2025-04-29 19:52:24.799 INFO: Epoch 27: head: validation, loss=0.30057767, MAE_E=  685.22 meV, MAE_F=  233.12 meV / A
2025-04-29 19:52:27.254 INFO: Epoch 28: head: train, loss=0.30583908, MAE_E=  462.63 meV, MAE_F=  238.15 meV / A
2025-04-29 19:52:27.887 INFO: Epoch 28: head: validation, loss=0.31351036, MAE_E=  451.59 meV, MAE_F=  236.43 meV / A
2025-04-29 19:52:30.303 INFO: Epoch 29: head: train, loss=0.30942874, MAE_E=  293.15 meV, MAE_F=  238.46 meV / A
2025-04-29 19:52:30.914 INFO: Epoch 29: head: validation, loss=0.31592471, MAE_E=  302.79 meV, MAE_F=  236.79 meV / A
2025-04-29 19:52:33.267 INFO: Epoch 30: head: train, loss=0.36360726, MAE_E=  653.37 meV, MAE_F=  253.09 meV / A
2025-04-29 19:52:33.873 INFO: Epoch 30: head: validation, loss=0.37213980, MAE_E=  658.58 meV, MAE_F=  252.59 meV / A
2025-04-29 19:52:33.873 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:52:33.873 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.6022], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:52:33.875 INFO: 
2025-04-29 19:52:33.876 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:52:33.876 INFO: eveluation
2025-04-29 19:52:33.876 INFO: The scale is [0.60218935] and shift is 0.0
2025-04-29 19:52:34.011 INFO: Energy Mean: -64250.40520833333, Variance: 0.1634744601779514
2025-04-29 19:52:34.263 INFO: Energy RMSE: 2.1567437648773193
2025-04-29 19:52:34.263 INFO: Energy R2: -27.454250083695317
2025-04-29 19:52:34.263 INFO: Energy MAE: 2.1143229007720947
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:52:34.264 INFO: Forces RMSE: 1.0929719198230279
2025-04-29 19:52:34.264 INFO: Forces R2: 0.6746699657767635
2025-04-29 19:52:34.794 INFO: Energy Mean: -64250.38695746528, Variance: 0.17210195988784602
2025-04-29 19:52:34.904 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_3//checkpoints/bi11-3_samples_run-123_epoch-10.pt
2025-04-29 19:52:34.950 INFO: Loaded Stage one model from epoch 10 for evaluation
2025-04-29 19:52:34.951 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_3/checkpoints/bi11-3_samples_run-123.model
2025-04-29 19:52:35.112 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_3/bi11-3_samples_compiled.model
2025-04-29 19:52:35.200 INFO: Done
Loading saved bootstrap sample 4
Training model 4
Using latent charge and penalty 10
2025-04-29 19:52:35.611 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 19:52:35.612 INFO: MACE version: 0.3.10
2025-04-29 19:52:35.612 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 19:52:35.617 INFO: ===========LOADING INPUT DATA===========
2025-04-29 19:52:35.617 INFO: Using heads: ['default']
2025-04-29 19:52:35.617 INFO: =============    Processing head default     ===========
2025-04-29 19:52:35.617 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 19:52:35.625 INFO: Atomic Numbers used: [83]
2025-04-29 19:52:35.625 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.945573903093}}
2025-04-29 19:52:35.629 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.945573903093}
2025-04-29 19:52:35.748 INFO: Computing average number of neighbors
2025-04-29 19:52:36.271 INFO: Average number of neighbors: 9.992252066115702
2025-04-29 19:52:36.271 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 19:52:36.273 INFO: ===========MODEL DETAILS===========
2025-04-29 19:52:36.273 INFO: Building model
2025-04-29 19:52:36.273 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 19:52:36.273 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 19:52:36.273 INFO: 8 radial and 5 basis functions
2025-04-29 19:52:36.273 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 19:52:36.273 INFO: Distance transform for radial basis functions: None
2025-04-29 19:52:36.273 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 19:52:36.795 INFO: Mean: -0.0005547529625733317, Std: [0.6027368]
0.0 [0.6027368]
2025-04-29 19:52:36.795 INFO: Scale: [0.6027368], Shift: 0.0
2025-04-29 19:52:38.086 INFO: Total number of parameters: 509618
2025-04-29 19:52:38.086 INFO: 
2025-04-29 19:52:38.086 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 19:52:38.086 INFO: Using ADAM as parameter optimizer
2025-04-29 19:52:38.086 INFO: Batch size: 32
2025-04-29 19:52:38.086 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 19:52:38.086 INFO: Number of gradient updates: 2250
2025-04-29 19:52:38.086 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 19:52:38.086 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 19:52:38.088 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 19:52:38.088 INFO: 
2025-04-29 19:52:38.088 INFO: ===========TRAINING===========
2025-04-29 19:52:38.088 INFO: Started training, reporting errors on validation set
2025-04-29 19:52:38.088 INFO: Loss metrics on validation set
2025-04-29 19:52:38.945 INFO: Initial: head: validation, loss=15.01272688, MAE_E=25757.69 meV, MAE_F=  425.29 meV / A
2025-04-29 19:52:41.373 INFO: Epoch 0: head: train, loss=2.12383063, MAE_E= 7265.07 meV, MAE_F=  378.12 meV / A
2025-04-29 19:52:42.136 INFO: Epoch 0: head: validation, loss=2.17481638, MAE_E= 7240.25 meV, MAE_F=  373.17 meV / A
2025-04-29 19:52:44.612 INFO: Epoch 1: head: train, loss=4.67890746, MAE_E= 1333.85 meV, MAE_F=  366.08 meV / A
2025-04-29 19:52:45.209 INFO: Epoch 1: head: validation, loss=4.71405712, MAE_E= 1349.25 meV, MAE_F=  361.55 meV / A
2025-04-29 19:52:47.668 INFO: Epoch 2: head: train, loss=0.71355982, MAE_E=  433.09 meV, MAE_F=  334.25 meV / A
2025-04-29 19:52:48.288 INFO: Epoch 2: head: validation, loss=0.76657817, MAE_E=  434.95 meV, MAE_F=  336.19 meV / A
2025-04-29 19:52:50.826 INFO: Epoch 3: head: train, loss=0.48861028, MAE_E=  609.91 meV, MAE_F=  292.56 meV / A
2025-04-29 19:52:51.461 INFO: Epoch 3: head: validation, loss=0.52767912, MAE_E=  578.94 meV, MAE_F=  297.10 meV / A
2025-04-29 19:52:54.033 INFO: Epoch 4: head: train, loss=0.38679842, MAE_E=  690.10 meV, MAE_F=  261.30 meV / A
2025-04-29 19:52:54.724 INFO: Epoch 4: head: validation, loss=0.39706383, MAE_E=  666.81 meV, MAE_F=  258.46 meV / A
2025-04-29 19:52:57.304 INFO: Epoch 5: head: train, loss=0.52476367, MAE_E= 2804.32 meV, MAE_F=  282.96 meV / A
2025-04-29 19:52:57.922 INFO: Epoch 5: head: validation, loss=0.53926173, MAE_E= 2779.81 meV, MAE_F=  281.77 meV / A
2025-04-29 19:53:00.592 INFO: Epoch 6: head: train, loss=0.98016427, MAE_E= 3939.50 meV, MAE_F=  391.00 meV / A
2025-04-29 19:53:01.282 INFO: Epoch 6: head: validation, loss=1.05949733, MAE_E= 3922.95 meV, MAE_F=  394.37 meV / A
2025-04-29 19:53:03.723 INFO: Epoch 7: head: train, loss=0.72167891, MAE_E= 2717.18 meV, MAE_F=  295.22 meV / A
2025-04-29 19:53:04.391 INFO: Epoch 7: head: validation, loss=0.75248653, MAE_E= 2731.12 meV, MAE_F=  296.14 meV / A
2025-04-29 19:53:06.872 INFO: Epoch 8: head: train, loss=0.58152637, MAE_E= 2941.61 meV, MAE_F=  275.94 meV / A
2025-04-29 19:53:07.506 INFO: Epoch 8: head: validation, loss=0.60296601, MAE_E= 2936.15 meV, MAE_F=  274.93 meV / A
2025-04-29 19:53:09.957 INFO: Epoch 9: head: train, loss=0.38945417, MAE_E= 1887.31 meV, MAE_F=  255.08 meV / A
2025-04-29 19:53:10.577 INFO: Epoch 9: head: validation, loss=0.41081649, MAE_E= 1898.21 meV, MAE_F=  255.82 meV / A
2025-04-29 19:53:13.092 INFO: Epoch 10: head: train, loss=0.36797573, MAE_E= 2313.52 meV, MAE_F=  249.56 meV / A
2025-04-29 19:53:13.740 INFO: Epoch 10: head: validation, loss=0.37802892, MAE_E= 2314.95 meV, MAE_F=  248.82 meV / A
2025-04-29 19:53:16.256 INFO: Epoch 11: head: train, loss=0.39103986, MAE_E=  694.73 meV, MAE_F=  239.39 meV / A
2025-04-29 19:53:16.901 INFO: Epoch 11: head: validation, loss=0.40692658, MAE_E=  677.45 meV, MAE_F=  239.79 meV / A
2025-04-29 19:53:19.365 INFO: Epoch 12: head: train, loss=0.59972738, MAE_E=  240.48 meV, MAE_F=  265.24 meV / A
2025-04-29 19:53:19.950 INFO: Epoch 12: head: validation, loss=0.61873861, MAE_E=  252.25 meV, MAE_F=  265.38 meV / A
2025-04-29 19:53:22.361 INFO: Epoch 13: head: train, loss=0.53270620, MAE_E= 1228.65 meV, MAE_F=  259.76 meV / A
2025-04-29 19:53:22.946 INFO: Epoch 13: head: validation, loss=0.55001481, MAE_E= 1226.47 meV, MAE_F=  259.02 meV / A
2025-04-29 19:53:25.322 INFO: Epoch 14: head: train, loss=0.40375782, MAE_E= 1312.53 meV, MAE_F=  239.11 meV / A
2025-04-29 19:53:25.940 INFO: Epoch 14: head: validation, loss=0.41679229, MAE_E= 1311.25 meV, MAE_F=  239.61 meV / A
2025-04-29 19:53:28.312 INFO: Epoch 15: head: train, loss=0.46073483, MAE_E= 2334.76 meV, MAE_F=  254.01 meV / A
2025-04-29 19:53:28.923 INFO: Epoch 15: head: validation, loss=0.48146206, MAE_E= 2340.18 meV, MAE_F=  255.72 meV / A
2025-04-29 19:53:31.358 INFO: Epoch 16: head: train, loss=0.43431711, MAE_E= 3068.16 meV, MAE_F=  269.58 meV / A
2025-04-29 19:53:31.964 INFO: Epoch 16: head: validation, loss=0.46168327, MAE_E= 3068.95 meV, MAE_F=  271.78 meV / A
2025-04-29 19:53:34.273 INFO: Epoch 17: head: train, loss=0.40227965, MAE_E= 2887.53 meV, MAE_F=  261.56 meV / A
2025-04-29 19:53:34.843 INFO: Epoch 17: head: validation, loss=0.42818093, MAE_E= 2880.64 meV, MAE_F=  263.10 meV / A
2025-04-29 19:53:37.150 INFO: Epoch 18: head: train, loss=0.33601741, MAE_E=  925.55 meV, MAE_F=  245.84 meV / A
2025-04-29 19:53:37.764 INFO: Epoch 18: head: validation, loss=0.35444107, MAE_E=  918.22 meV, MAE_F=  245.84 meV / A
2025-04-29 19:53:40.217 INFO: Epoch 19: head: train, loss=0.30100357, MAE_E=  532.85 meV, MAE_F=  234.84 meV / A
2025-04-29 19:53:40.898 INFO: Epoch 19: head: validation, loss=0.31755113, MAE_E=  524.93 meV, MAE_F=  234.44 meV / A
2025-04-29 19:53:43.513 INFO: Epoch 20: head: train, loss=0.27789205, MAE_E=  529.49 meV, MAE_F=  227.12 meV / A
2025-04-29 19:53:44.161 INFO: Epoch 20: head: validation, loss=0.29391303, MAE_E=  521.28 meV, MAE_F=  226.73 meV / A
2025-04-29 19:53:46.809 INFO: Epoch 21: head: train, loss=0.25557955, MAE_E=  212.21 meV, MAE_F=  219.24 meV / A
2025-04-29 19:53:47.398 INFO: Epoch 21: head: validation, loss=0.27116489, MAE_E=  236.13 meV, MAE_F=  219.67 meV / A
2025-04-29 19:53:50.008 INFO: Epoch 22: head: train, loss=0.23303409, MAE_E=  206.11 meV, MAE_F=  211.03 meV / A
2025-04-29 19:53:50.695 INFO: Epoch 22: head: validation, loss=0.25053330, MAE_E=  229.51 meV, MAE_F=  212.60 meV / A
2025-04-29 19:53:53.287 INFO: Epoch 23: head: train, loss=0.22004930, MAE_E=  349.63 meV, MAE_F=  203.65 meV / A
2025-04-29 19:53:53.938 INFO: Epoch 23: head: validation, loss=0.23539134, MAE_E=  353.22 meV, MAE_F=  204.88 meV / A
2025-04-29 19:53:56.355 INFO: Epoch 24: head: train, loss=0.29067175, MAE_E= 1114.52 meV, MAE_F=  207.12 meV / A
2025-04-29 19:53:56.979 INFO: Epoch 24: head: validation, loss=0.30668609, MAE_E= 1094.08 meV, MAE_F=  209.53 meV / A
2025-04-29 19:53:59.402 INFO: Epoch 25: head: train, loss=0.25080530, MAE_E=  276.57 meV, MAE_F=  213.26 meV / A
2025-04-29 19:54:00.034 INFO: Epoch 25: head: validation, loss=0.26945245, MAE_E=  269.54 meV, MAE_F=  216.87 meV / A
2025-04-29 19:54:02.488 INFO: Epoch 26: head: train, loss=0.25075171, MAE_E= 1041.59 meV, MAE_F=  213.94 meV / A
2025-04-29 19:54:03.107 INFO: Epoch 26: head: validation, loss=0.26845526, MAE_E= 1054.72 meV, MAE_F=  216.75 meV / A
2025-04-29 19:54:05.453 INFO: Epoch 27: head: train, loss=0.26182814, MAE_E=  467.79 meV, MAE_F=  214.79 meV / A
2025-04-29 19:54:06.038 INFO: Epoch 27: head: validation, loss=0.27769802, MAE_E=  482.91 meV, MAE_F=  217.50 meV / A
2025-04-29 19:54:08.410 INFO: Epoch 28: head: train, loss=0.27442756, MAE_E=  582.47 meV, MAE_F=  223.63 meV / A
2025-04-29 19:54:09.016 INFO: Epoch 28: head: validation, loss=0.28817878, MAE_E=  578.23 meV, MAE_F=  224.32 meV / A
2025-04-29 19:54:11.361 INFO: Epoch 29: head: train, loss=0.29386840, MAE_E=  333.48 meV, MAE_F=  236.45 meV / A
2025-04-29 19:54:11.995 INFO: Epoch 29: head: validation, loss=0.30550490, MAE_E=  340.87 meV, MAE_F=  234.88 meV / A
2025-04-29 19:54:14.348 INFO: Epoch 30: head: train, loss=0.29772287, MAE_E=  765.52 meV, MAE_F=  230.35 meV / A
2025-04-29 19:54:14.903 INFO: Epoch 30: head: validation, loss=0.31316666, MAE_E=  762.18 meV, MAE_F=  230.74 meV / A
2025-04-29 19:54:17.142 INFO: Epoch 31: head: train, loss=0.29392646, MAE_E= 1428.90 meV, MAE_F=  232.37 meV / A
2025-04-29 19:54:17.718 INFO: Epoch 31: head: validation, loss=0.31415719, MAE_E= 1425.90 meV, MAE_F=  233.60 meV / A
2025-04-29 19:54:20.023 INFO: Epoch 32: head: train, loss=0.31083450, MAE_E= 1582.61 meV, MAE_F=  237.01 meV / A
2025-04-29 19:54:20.598 INFO: Epoch 32: head: validation, loss=0.33118304, MAE_E= 1579.08 meV, MAE_F=  238.37 meV / A
2025-04-29 19:54:22.889 INFO: Epoch 33: head: train, loss=0.33256949, MAE_E=  724.85 meV, MAE_F=  244.57 meV / A
2025-04-29 19:54:23.508 INFO: Epoch 33: head: validation, loss=0.35274524, MAE_E=  725.80 meV, MAE_F=  246.11 meV / A
2025-04-29 19:54:25.869 INFO: Epoch 34: head: train, loss=0.31609752, MAE_E=  716.61 meV, MAE_F=  240.19 meV / A
2025-04-29 19:54:26.482 INFO: Epoch 34: head: validation, loss=0.33531430, MAE_E=  718.50 meV, MAE_F=  241.89 meV / A
2025-04-29 19:54:28.778 INFO: Epoch 35: head: train, loss=0.29998202, MAE_E=  477.63 meV, MAE_F=  234.71 meV / A
2025-04-29 19:54:29.423 INFO: Epoch 35: head: validation, loss=0.31992949, MAE_E=  475.23 meV, MAE_F=  236.87 meV / A
2025-04-29 19:54:31.917 INFO: Epoch 36: head: train, loss=0.33525936, MAE_E=  431.19 meV, MAE_F=  236.52 meV / A
2025-04-29 19:54:32.557 INFO: Epoch 36: head: validation, loss=0.34987368, MAE_E=  442.36 meV, MAE_F=  237.30 meV / A
2025-04-29 19:54:34.839 INFO: Epoch 37: head: train, loss=0.32658776, MAE_E=  797.60 meV, MAE_F=  238.48 meV / A
2025-04-29 19:54:35.403 INFO: Epoch 37: head: validation, loss=0.34209540, MAE_E=  793.57 meV, MAE_F=  239.80 meV / A
2025-04-29 19:54:37.685 INFO: Epoch 38: head: train, loss=0.29905412, MAE_E=  516.90 meV, MAE_F=  230.84 meV / A
2025-04-29 19:54:38.272 INFO: Epoch 38: head: validation, loss=0.31527098, MAE_E=  517.95 meV, MAE_F=  232.75 meV / A
2025-04-29 19:54:40.557 INFO: Epoch 39: head: train, loss=0.27810306, MAE_E=  616.84 meV, MAE_F=  224.91 meV / A
2025-04-29 19:54:41.136 INFO: Epoch 39: head: validation, loss=0.29337435, MAE_E=  613.28 meV, MAE_F=  226.62 meV / A
2025-04-29 19:54:43.527 INFO: Epoch 40: head: train, loss=0.26112056, MAE_E=  523.79 meV, MAE_F=  218.88 meV / A
2025-04-29 19:54:44.155 INFO: Epoch 40: head: validation, loss=0.27681946, MAE_E=  524.41 meV, MAE_F=  220.74 meV / A
2025-04-29 19:54:46.537 INFO: Epoch 41: head: train, loss=0.24447598, MAE_E=  427.03 meV, MAE_F=  213.38 meV / A
2025-04-29 19:54:47.088 INFO: Epoch 41: head: validation, loss=0.26040621, MAE_E=  431.42 meV, MAE_F=  215.40 meV / A
2025-04-29 19:54:49.361 INFO: Epoch 42: head: train, loss=0.23371925, MAE_E=  335.54 meV, MAE_F=  208.82 meV / A
2025-04-29 19:54:49.957 INFO: Epoch 42: head: validation, loss=0.24897899, MAE_E=  342.54 meV, MAE_F=  210.79 meV / A
2025-04-29 19:54:52.385 INFO: Epoch 43: head: train, loss=0.22248692, MAE_E=  254.16 meV, MAE_F=  203.73 meV / A
2025-04-29 19:54:52.962 INFO: Epoch 43: head: validation, loss=0.24058106, MAE_E=  264.85 meV, MAE_F=  206.83 meV / A
2025-04-29 19:54:52.962 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 19:54:52.962 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.6027], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 19:54:52.966 INFO: 
2025-04-29 19:54:52.966 INFO: ===========FINISHED TRAINING===========
2025-04-29 19:54:52.966 INFO: eveluation
2025-04-29 19:54:52.966 INFO: The scale is [0.6027368] and shift is 0.0
2025-04-29 19:54:53.101 INFO: Energy Mean: -64250.428515625, Variance: 0.14912938435872394
2025-04-29 19:54:53.384 INFO: Energy RMSE: 0.2495727241039276
2025-04-29 19:54:53.384 INFO: Energy R2: 0.5823321690553067
2025-04-29 19:54:53.385 INFO: Energy MAE: 0.18311631679534912
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 19:54:53.386 INFO: Forces RMSE: 0.8033563722556574
2025-04-29 19:54:53.386 INFO: Forces R2: 0.8314035028020568
2025-04-29 19:54:53.899 INFO: Energy Mean: -64250.40131293403, Variance: 0.15707854930265447
2025-04-29 19:54:54.019 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_4//checkpoints/bi11-3_samples_run-123_epoch-23.pt
2025-04-29 19:54:54.068 INFO: Loaded Stage one model from epoch 23 for evaluation
2025-04-29 19:54:54.068 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_4/checkpoints/bi11-3_samples_run-123.model
2025-04-29 19:54:54.229 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_4/bi11-3_samples_compiled.model
2025-04-29 19:54:54.318 INFO: Done

============================= JOB FEEDBACK =============================

Job ID: 3119740
Cluster: hk
User/Group: hv3694/hk-project-aimat2
Account: hk-project-aimat2
State: COMPLETED (exit code 0)
Partition: accelerated
Nodes: 1
Cores per node: 8
Nodelist: hkn0609
CPU Utilized: 00:20:51
CPU Efficiency: 21.05% of 01:39:04 core-walltime
Job Wall-clock time: 00:12:23
Starttime: Tue Apr 29 19:42:32 2025
Endtime: Tue Apr 29 19:54:55 2025
Memory Utilized: 1.87 GB
Memory Efficiency: 0.00% of 0.00 MB
Energy Consumed: 549448 Joule / 152.624444444444 Watthours
Average node power draw: 739.49932705249 Watt
