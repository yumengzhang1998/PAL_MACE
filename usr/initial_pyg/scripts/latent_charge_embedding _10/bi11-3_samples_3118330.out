cuequivariance or cuequivariance_torch is not available. Cuequivariance acceleration will be disabled.
False
Results directory samples/ already exists. Exiting.
Reading data from:  ./raw/bi11-3_samples_parsed.csv
['./raw/bi11-3_samples_parsed.csv']
Reading data from:  ./raw/bi11-3_samples_parsed.csv
[-64251.033010993764]
(11, 3)
Loading saved bootstrap sample 0
Training model 0
Using latent charge and penalty 10
2025-04-29 14:20:59.345 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:20:59.346 INFO: MACE version: 0.3.10
2025-04-29 14:20:59.409 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:20:59.498 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:20:59.498 INFO: Using heads: ['default']
2025-04-29 14:20:59.498 INFO: =============    Processing head default     ===========
2025-04-29 14:20:59.498 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:20:59.506 INFO: Atomic Numbers used: [83]
2025-04-29 14:20:59.506 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.947697679924}}
2025-04-29 14:20:59.516 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.947697679924}
2025-04-29 14:20:59.642 INFO: Computing average number of neighbors
2025-04-29 14:21:01.867 INFO: Average number of neighbors: 9.993285123966942
2025-04-29 14:21:01.868 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:21:01.868 INFO: ===========MODEL DETAILS===========
2025-04-29 14:21:01.868 INFO: Building model
2025-04-29 14:21:01.868 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:21:01.868 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:21:01.868 INFO: 8 radial and 5 basis functions
2025-04-29 14:21:01.868 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:21:01.868 INFO: Distance transform for radial basis functions: None
2025-04-29 14:21:01.868 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:21:02.244 INFO: Mean: -0.0004194107252170237, Std: [0.5830243]
0.0 [0.5830243]
2025-04-29 14:21:02.245 INFO: Scale: [0.5830243], Shift: 0.0
2025-04-29 14:21:03.616 INFO: Total number of parameters: 509618
2025-04-29 14:21:03.616 INFO: 
2025-04-29 14:21:03.616 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:21:03.616 INFO: Using ADAM as parameter optimizer
2025-04-29 14:21:03.616 INFO: Batch size: 32
2025-04-29 14:21:03.616 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:21:03.616 INFO: Number of gradient updates: 2250
2025-04-29 14:21:03.617 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:21:03.617 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 14:21:03.618 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:21:03.618 INFO: 
2025-04-29 14:21:03.618 INFO: ===========TRAINING===========
2025-04-29 14:21:03.618 INFO: Started training, reporting errors on validation set
2025-04-29 14:21:03.618 INFO: Loss metrics on validation set
2025-04-29 14:21:06.334 INFO: Initial: head: validation, loss=14.95427985, MAE_E=24890.84 meV, MAE_F=  408.84 meV / A
2025-04-29 14:21:18.671 INFO: Epoch 0: head: train, loss=2.09220079, MAE_E= 7116.91 meV, MAE_F=  372.59 meV / A
2025-04-29 14:21:19.428 INFO: Epoch 0: head: validation, loss=2.17862832, MAE_E= 7126.04 meV, MAE_F=  369.28 meV / A
2025-04-29 14:21:22.052 INFO: Epoch 1: head: train, loss=4.76171844, MAE_E=  986.62 meV, MAE_F=  369.22 meV / A
2025-04-29 14:21:22.700 INFO: Epoch 1: head: validation, loss=4.86950947, MAE_E=  964.52 meV, MAE_F=  375.94 meV / A
2025-04-29 14:21:25.242 INFO: Epoch 2: head: train, loss=0.65288123, MAE_E=  590.74 meV, MAE_F=  324.72 meV / A
2025-04-29 14:21:25.899 INFO: Epoch 2: head: validation, loss=0.75702158, MAE_E=  550.91 meV, MAE_F=  331.40 meV / A
2025-04-29 14:21:28.405 INFO: Epoch 3: head: train, loss=0.45583247, MAE_E=  626.58 meV, MAE_F=  285.28 meV / A
2025-04-29 14:21:29.070 INFO: Epoch 3: head: validation, loss=0.53240273, MAE_E=  580.88 meV, MAE_F=  291.23 meV / A
2025-04-29 14:21:31.613 INFO: Epoch 4: head: train, loss=0.38239482, MAE_E=  601.86 meV, MAE_F=  262.14 meV / A
2025-04-29 14:21:32.308 INFO: Epoch 4: head: validation, loss=0.42640110, MAE_E=  616.30 meV, MAE_F=  265.39 meV / A
2025-04-29 14:21:34.828 INFO: Epoch 5: head: train, loss=0.31889170, MAE_E= 1178.95 meV, MAE_F=  247.14 meV / A
2025-04-29 14:21:35.437 INFO: Epoch 5: head: validation, loss=0.35103393, MAE_E= 1179.96 meV, MAE_F=  248.25 meV / A
2025-04-29 14:21:37.940 INFO: Epoch 6: head: train, loss=0.34214310, MAE_E=  694.68 meV, MAE_F=  245.30 meV / A
2025-04-29 14:21:38.593 INFO: Epoch 6: head: validation, loss=0.36744127, MAE_E=  708.87 meV, MAE_F=  245.54 meV / A
2025-04-29 14:21:41.094 INFO: Epoch 7: head: train, loss=0.42469424, MAE_E= 2036.66 meV, MAE_F=  277.67 meV / A
2025-04-29 14:21:41.742 INFO: Epoch 7: head: validation, loss=0.46407524, MAE_E= 2032.64 meV, MAE_F=  276.99 meV / A
2025-04-29 14:21:44.326 INFO: Epoch 8: head: train, loss=0.47966330, MAE_E= 1620.24 meV, MAE_F=  237.75 meV / A
2025-04-29 14:21:44.979 INFO: Epoch 8: head: validation, loss=0.51216379, MAE_E= 1612.88 meV, MAE_F=  240.45 meV / A
2025-04-29 14:21:47.536 INFO: Epoch 9: head: train, loss=0.28931976, MAE_E=  672.45 meV, MAE_F=  222.66 meV / A
2025-04-29 14:21:48.192 INFO: Epoch 9: head: validation, loss=0.31751423, MAE_E=  678.11 meV, MAE_F=  224.77 meV / A
2025-04-29 14:21:50.752 INFO: Epoch 10: head: train, loss=0.23125895, MAE_E=  636.35 meV, MAE_F=  210.20 meV / A
2025-04-29 14:21:51.444 INFO: Epoch 10: head: validation, loss=0.25329823, MAE_E=  653.35 meV, MAE_F=  210.88 meV / A
2025-04-29 14:21:54.002 INFO: Epoch 11: head: train, loss=0.26364928, MAE_E=  482.29 meV, MAE_F=  220.20 meV / A
2025-04-29 14:21:54.658 INFO: Epoch 11: head: validation, loss=0.29798799, MAE_E=  497.51 meV, MAE_F=  224.67 meV / A
2025-04-29 14:21:57.063 INFO: Epoch 12: head: train, loss=0.23048288, MAE_E=  591.20 meV, MAE_F=  196.14 meV / A
2025-04-29 14:21:57.717 INFO: Epoch 12: head: validation, loss=0.25008797, MAE_E=  588.37 meV, MAE_F=  196.66 meV / A
2025-04-29 14:22:00.144 INFO: Epoch 13: head: train, loss=0.38328977, MAE_E=  804.15 meV, MAE_F=  258.74 meV / A
2025-04-29 14:22:00.772 INFO: Epoch 13: head: validation, loss=0.42329104, MAE_E=  810.74 meV, MAE_F=  262.13 meV / A
2025-04-29 14:22:03.179 INFO: Epoch 14: head: train, loss=0.32841886, MAE_E=  459.47 meV, MAE_F=  243.90 meV / A
2025-04-29 14:22:03.846 INFO: Epoch 14: head: validation, loss=0.37006355, MAE_E=  462.64 meV, MAE_F=  247.41 meV / A
2025-04-29 14:22:06.189 INFO: Epoch 15: head: train, loss=0.37055853, MAE_E=  471.11 meV, MAE_F=  261.44 meV / A
2025-04-29 14:22:06.843 INFO: Epoch 15: head: validation, loss=0.40120978, MAE_E=  468.33 meV, MAE_F=  261.37 meV / A
2025-04-29 14:22:09.319 INFO: Epoch 16: head: train, loss=0.38019727, MAE_E= 2692.18 meV, MAE_F=  245.16 meV / A
2025-04-29 14:22:09.946 INFO: Epoch 16: head: validation, loss=0.40958292, MAE_E= 2710.79 meV, MAE_F=  246.84 meV / A
2025-04-29 14:22:12.454 INFO: Epoch 17: head: train, loss=0.61187781, MAE_E= 2120.35 meV, MAE_F=  252.37 meV / A
2025-04-29 14:22:13.089 INFO: Epoch 17: head: validation, loss=0.65062851, MAE_E= 2140.60 meV, MAE_F=  253.55 meV / A
2025-04-29 14:22:15.545 INFO: Epoch 18: head: train, loss=0.64812522, MAE_E= 3989.11 meV, MAE_F=  297.96 meV / A
2025-04-29 14:22:16.210 INFO: Epoch 18: head: validation, loss=0.71746882, MAE_E= 3990.37 meV, MAE_F=  301.51 meV / A
2025-04-29 14:22:18.536 INFO: Epoch 19: head: train, loss=0.62049966, MAE_E= 2845.27 meV, MAE_F=  323.14 meV / A
2025-04-29 14:22:19.145 INFO: Epoch 19: head: validation, loss=0.70592944, MAE_E= 2842.04 meV, MAE_F=  327.76 meV / A
2025-04-29 14:22:21.455 INFO: Epoch 20: head: train, loss=0.61535318, MAE_E= 1035.96 meV, MAE_F=  327.51 meV / A
2025-04-29 14:22:22.048 INFO: Epoch 20: head: validation, loss=0.69870002, MAE_E= 1022.13 meV, MAE_F=  331.47 meV / A
2025-04-29 14:22:24.361 INFO: Epoch 21: head: train, loss=0.56469567, MAE_E= 1463.44 meV, MAE_F=  315.06 meV / A
2025-04-29 14:22:24.951 INFO: Epoch 21: head: validation, loss=0.64601696, MAE_E= 1464.30 meV, MAE_F=  319.47 meV / A
2025-04-29 14:22:27.176 INFO: Epoch 22: head: train, loss=0.51379916, MAE_E= 1113.85 meV, MAE_F=  301.57 meV / A
2025-04-29 14:22:27.689 INFO: Epoch 22: head: validation, loss=0.59414160, MAE_E= 1115.82 meV, MAE_F=  307.43 meV / A
2025-04-29 14:22:29.880 INFO: Epoch 23: head: train, loss=0.47851792, MAE_E= 1227.43 meV, MAE_F=  286.97 meV / A
2025-04-29 14:22:30.419 INFO: Epoch 23: head: validation, loss=0.54362635, MAE_E= 1220.07 meV, MAE_F=  292.70 meV / A
2025-04-29 14:22:32.762 INFO: Epoch 24: head: train, loss=0.46024684, MAE_E= 1157.58 meV, MAE_F=  277.80 meV / A
2025-04-29 14:22:33.430 INFO: Epoch 24: head: validation, loss=0.51226295, MAE_E= 1155.52 meV, MAE_F=  283.05 meV / A
2025-04-29 14:22:35.698 INFO: Epoch 25: head: train, loss=0.40280772, MAE_E=  753.55 meV, MAE_F=  268.32 meV / A
2025-04-29 14:22:36.251 INFO: Epoch 25: head: validation, loss=0.44593023, MAE_E=  747.36 meV, MAE_F=  272.54 meV / A
2025-04-29 14:22:38.565 INFO: Epoch 26: head: train, loss=0.38233204, MAE_E=  655.65 meV, MAE_F=  260.15 meV / A
2025-04-29 14:22:39.062 INFO: Epoch 26: head: validation, loss=0.41573331, MAE_E=  654.14 meV, MAE_F=  262.19 meV / A
2025-04-29 14:22:41.505 INFO: Epoch 27: head: train, loss=0.39493623, MAE_E=  542.20 meV, MAE_F=  259.66 meV / A
2025-04-29 14:22:42.151 INFO: Epoch 27: head: validation, loss=0.43147997, MAE_E=  538.19 meV, MAE_F=  261.55 meV / A
2025-04-29 14:22:44.632 INFO: Epoch 28: head: train, loss=0.37465306, MAE_E=  444.60 meV, MAE_F=  250.37 meV / A
2025-04-29 14:22:45.233 INFO: Epoch 28: head: validation, loss=0.40329052, MAE_E=  451.80 meV, MAE_F=  251.14 meV / A
2025-04-29 14:22:47.699 INFO: Epoch 29: head: train, loss=0.34996481, MAE_E=  461.62 meV, MAE_F=  243.84 meV / A
2025-04-29 14:22:48.278 INFO: Epoch 29: head: validation, loss=0.37570181, MAE_E=  468.19 meV, MAE_F=  244.44 meV / A
2025-04-29 14:22:50.705 INFO: Epoch 30: head: train, loss=0.32562078, MAE_E=  253.57 meV, MAE_F=  237.80 meV / A
2025-04-29 14:22:51.284 INFO: Epoch 30: head: validation, loss=0.34815965, MAE_E=  264.41 meV, MAE_F=  237.60 meV / A
2025-04-29 14:22:53.745 INFO: Epoch 31: head: train, loss=0.30156719, MAE_E=  340.75 meV, MAE_F=  231.77 meV / A
2025-04-29 14:22:54.387 INFO: Epoch 31: head: validation, loss=0.32081984, MAE_E=  352.80 meV, MAE_F=  230.94 meV / A
2025-04-29 14:22:56.785 INFO: Epoch 32: head: train, loss=0.27937115, MAE_E=  219.91 meV, MAE_F=  225.35 meV / A
2025-04-29 14:22:57.458 INFO: Epoch 32: head: validation, loss=0.29710792, MAE_E=  233.58 meV, MAE_F=  224.25 meV / A
2025-04-29 14:22:57.459 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:22:57.459 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5830], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:22:57.492 INFO: 
2025-04-29 14:22:57.493 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:22:57.493 INFO: eveluation
2025-04-29 14:22:57.493 INFO: The scale is [0.5830243] and shift is 0.0
2025-04-29 14:22:57.636 INFO: Energy Mean: -64250.412890625, Variance: 0.16182164510091143
2025-04-29 14:22:57.923 INFO: Energy RMSE: 0.25847944617271423
2025-04-29 14:22:57.924 INFO: Energy R2: 0.58712800675647
2025-04-29 14:22:57.924 INFO: Energy MAE: 0.19735242426395416
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:22:57.925 INFO: Forces RMSE: 0.8724810457569346
2025-04-29 14:22:57.925 INFO: Forces R2: 0.8001682939383802
2025-04-29 14:22:58.489 INFO: Energy Mean: -64250.42467447917, Variance: 0.1520876185099284
2025-04-29 14:22:58.610 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_0//checkpoints/bi11-3_samples_run-123_epoch-12.pt
2025-04-29 14:22:58.661 INFO: Loaded Stage one model from epoch 12 for evaluation
2025-04-29 14:22:58.662 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_0/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:22:58.832 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_0/bi11-3_samples_compiled.model
2025-04-29 14:22:58.936 INFO: Done
Loading saved bootstrap sample 1
Training model 1
Using latent charge and penalty 10
2025-04-29 14:22:59.365 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:22:59.365 INFO: MACE version: 0.3.10
2025-04-29 14:22:59.365 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:22:59.371 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:22:59.371 INFO: Using heads: ['default']
2025-04-29 14:22:59.371 INFO: =============    Processing head default     ===========
2025-04-29 14:22:59.371 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:22:59.381 INFO: Atomic Numbers used: [83]
2025-04-29 14:22:59.381 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.9471699416035}}
2025-04-29 14:22:59.386 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.9471699416035}
2025-04-29 14:22:59.511 INFO: Computing average number of neighbors
2025-04-29 14:23:00.104 INFO: Average number of neighbors: 9.994834710743802
2025-04-29 14:23:00.105 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:23:00.106 INFO: ===========MODEL DETAILS===========
2025-04-29 14:23:00.106 INFO: Building model
2025-04-29 14:23:00.106 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:23:00.106 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:23:00.106 INFO: 8 radial and 5 basis functions
2025-04-29 14:23:00.107 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:23:00.107 INFO: Distance transform for radial basis functions: None
2025-04-29 14:23:00.107 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:23:00.710 INFO: Mean: 8.086457590943835e-05, Std: [0.59166257]
0.0 [0.59166257]
2025-04-29 14:23:00.711 INFO: Scale: [0.59166257], Shift: 0.0
2025-04-29 14:23:01.912 INFO: Total number of parameters: 509618
2025-04-29 14:23:01.913 INFO: 
2025-04-29 14:23:01.913 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:23:01.913 INFO: Using ADAM as parameter optimizer
2025-04-29 14:23:01.913 INFO: Batch size: 32
2025-04-29 14:23:01.913 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:23:01.913 INFO: Number of gradient updates: 2250
2025-04-29 14:23:01.913 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:23:01.913 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 14:23:01.915 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:23:01.915 INFO: 
2025-04-29 14:23:01.915 INFO: ===========TRAINING===========
2025-04-29 14:23:01.915 INFO: Started training, reporting errors on validation set
2025-04-29 14:23:01.915 INFO: Loss metrics on validation set
2025-04-29 14:23:02.977 INFO: Initial: head: validation, loss=14.86389113, MAE_E=25284.25 meV, MAE_F=  411.00 meV / A
2025-04-29 14:23:05.748 INFO: Epoch 0: head: train, loss=2.13778576, MAE_E= 7239.61 meV, MAE_F=  374.81 meV / A
2025-04-29 14:23:06.624 INFO: Epoch 0: head: validation, loss=2.12209896, MAE_E= 7225.96 meV, MAE_F=  368.47 meV / A
2025-04-29 14:23:09.273 INFO: Epoch 1: head: train, loss=4.77547509, MAE_E=  535.56 meV, MAE_F=  363.02 meV / A
2025-04-29 14:23:10.025 INFO: Epoch 1: head: validation, loss=4.79082217, MAE_E=  513.18 meV, MAE_F=  362.67 meV / A
2025-04-29 14:23:12.627 INFO: Epoch 2: head: train, loss=0.70266799, MAE_E=  430.88 meV, MAE_F=  332.96 meV / A
2025-04-29 14:23:13.335 INFO: Epoch 2: head: validation, loss=0.70604580, MAE_E=  432.31 meV, MAE_F=  330.62 meV / A
2025-04-29 14:23:16.128 INFO: Epoch 3: head: train, loss=0.46699143, MAE_E=  723.31 meV, MAE_F=  289.32 meV / A
2025-04-29 14:23:16.896 INFO: Epoch 3: head: validation, loss=0.49135673, MAE_E=  695.95 meV, MAE_F=  289.70 meV / A
2025-04-29 14:23:19.674 INFO: Epoch 4: head: train, loss=0.37737633, MAE_E=  657.79 meV, MAE_F=  262.57 meV / A
2025-04-29 14:23:20.410 INFO: Epoch 4: head: validation, loss=0.41520411, MAE_E=  658.90 meV, MAE_F=  266.27 meV / A
2025-04-29 14:23:23.223 INFO: Epoch 5: head: train, loss=0.36297090, MAE_E=  333.24 meV, MAE_F=  248.71 meV / A
2025-04-29 14:23:24.051 INFO: Epoch 5: head: validation, loss=0.39521162, MAE_E=  325.40 meV, MAE_F=  249.71 meV / A
2025-04-29 14:23:26.697 INFO: Epoch 6: head: train, loss=0.30775482, MAE_E=  296.38 meV, MAE_F=  243.90 meV / A
2025-04-29 14:23:27.395 INFO: Epoch 6: head: validation, loss=0.34457799, MAE_E=  270.12 meV, MAE_F=  247.38 meV / A
2025-04-29 14:23:30.177 INFO: Epoch 7: head: train, loss=0.30987515, MAE_E=  242.69 meV, MAE_F=  238.51 meV / A
2025-04-29 14:23:30.972 INFO: Epoch 7: head: validation, loss=0.34949429, MAE_E=  245.35 meV, MAE_F=  243.34 meV / A
2025-04-29 14:23:34.153 INFO: Epoch 8: head: train, loss=0.31543989, MAE_E= 2263.00 meV, MAE_F=  230.53 meV / A
2025-04-29 14:23:34.878 INFO: Epoch 8: head: validation, loss=0.34803917, MAE_E= 2250.56 meV, MAE_F=  233.95 meV / A
2025-04-29 14:23:37.579 INFO: Epoch 9: head: train, loss=0.51686412, MAE_E=  362.41 meV, MAE_F=  291.07 meV / A
2025-04-29 14:23:38.321 INFO: Epoch 9: head: validation, loss=0.55176913, MAE_E=  366.53 meV, MAE_F=  297.09 meV / A
2025-04-29 14:23:40.988 INFO: Epoch 10: head: train, loss=0.40052682, MAE_E=  743.18 meV, MAE_F=  258.58 meV / A
2025-04-29 14:23:41.758 INFO: Epoch 10: head: validation, loss=0.43684535, MAE_E=  724.25 meV, MAE_F=  262.48 meV / A
2025-04-29 14:23:44.512 INFO: Epoch 11: head: train, loss=1.06171664, MAE_E= 4687.31 meV, MAE_F=  254.75 meV / A
2025-04-29 14:23:45.244 INFO: Epoch 11: head: validation, loss=1.08994935, MAE_E= 4694.79 meV, MAE_F=  256.69 meV / A
2025-04-29 14:23:47.992 INFO: Epoch 12: head: train, loss=1.74614272, MAE_E=10459.53 meV, MAE_F=  441.52 meV / A
2025-04-29 14:23:48.744 INFO: Epoch 12: head: validation, loss=1.84783004, MAE_E=10495.29 meV, MAE_F=  452.81 meV / A
2025-04-29 14:23:51.402 INFO: Epoch 13: head: train, loss=1.35740812, MAE_E=22894.56 meV, MAE_F=  401.69 meV / A
2025-04-29 14:23:52.059 INFO: Epoch 13: head: validation, loss=1.44531137, MAE_E=22923.40 meV, MAE_F=  411.71 meV / A
2025-04-29 14:23:54.777 INFO: Epoch 14: head: train, loss=0.89234644, MAE_E=16925.93 meV, MAE_F=  350.81 meV / A
2025-04-29 14:23:55.511 INFO: Epoch 14: head: validation, loss=0.93959051, MAE_E=16944.99 meV, MAE_F=  355.53 meV / A
2025-04-29 14:23:58.146 INFO: Epoch 15: head: train, loss=0.64071359, MAE_E= 9754.22 meV, MAE_F=  324.60 meV / A
2025-04-29 14:23:58.851 INFO: Epoch 15: head: validation, loss=0.67888841, MAE_E= 9765.08 meV, MAE_F=  328.88 meV / A
2025-04-29 14:24:01.599 INFO: Epoch 16: head: train, loss=0.56122223, MAE_E= 3059.73 meV, MAE_F=  308.61 meV / A
2025-04-29 14:24:02.357 INFO: Epoch 16: head: validation, loss=0.59854602, MAE_E= 3070.84 meV, MAE_F=  312.05 meV / A
2025-04-29 14:24:05.162 INFO: Epoch 17: head: train, loss=0.46515746, MAE_E= 1336.90 meV, MAE_F=  285.62 meV / A
2025-04-29 14:24:05.935 INFO: Epoch 17: head: validation, loss=0.50857720, MAE_E= 1341.70 meV, MAE_F=  291.04 meV / A
2025-04-29 14:24:08.641 INFO: Epoch 18: head: train, loss=0.43990136, MAE_E=  527.53 meV, MAE_F=  275.79 meV / A
2025-04-29 14:24:09.341 INFO: Epoch 18: head: validation, loss=0.48348666, MAE_E=  502.42 meV, MAE_F=  280.88 meV / A
2025-04-29 14:24:11.957 INFO: Epoch 19: head: train, loss=0.39477344, MAE_E= 1433.80 meV, MAE_F=  265.33 meV / A
2025-04-29 14:24:12.671 INFO: Epoch 19: head: validation, loss=0.43888640, MAE_E= 1446.17 meV, MAE_F=  270.32 meV / A
2025-04-29 14:24:15.360 INFO: Epoch 20: head: train, loss=0.36305230, MAE_E=  800.77 meV, MAE_F=  259.78 meV / A
2025-04-29 14:24:16.027 INFO: Epoch 20: head: validation, loss=0.40785601, MAE_E=  814.34 meV, MAE_F=  265.24 meV / A
2025-04-29 14:24:18.699 INFO: Epoch 21: head: train, loss=0.36017370, MAE_E=  376.59 meV, MAE_F=  253.45 meV / A
2025-04-29 14:24:19.442 INFO: Epoch 21: head: validation, loss=0.40067270, MAE_E=  387.17 meV, MAE_F=  257.29 meV / A
2025-04-29 14:24:22.169 INFO: Epoch 22: head: train, loss=0.55303296, MAE_E=  852.23 meV, MAE_F=  300.78 meV / A
2025-04-29 14:24:22.922 INFO: Epoch 22: head: validation, loss=0.57635169, MAE_E=  840.69 meV, MAE_F=  299.46 meV / A
2025-04-29 14:24:25.536 INFO: Epoch 23: head: train, loss=0.71228176, MAE_E= 1315.81 meV, MAE_F=  334.01 meV / A
2025-04-29 14:24:26.223 INFO: Epoch 23: head: validation, loss=0.71867613, MAE_E= 1312.55 meV, MAE_F=  329.78 meV / A
2025-04-29 14:24:28.949 INFO: Epoch 24: head: train, loss=0.73121387, MAE_E=  716.47 meV, MAE_F=  332.69 meV / A
2025-04-29 14:24:29.700 INFO: Epoch 24: head: validation, loss=0.72808208, MAE_E=  707.96 meV, MAE_F=  327.63 meV / A
2025-04-29 14:24:32.441 INFO: Epoch 25: head: train, loss=0.63586028, MAE_E=  899.39 meV, MAE_F=  309.98 meV / A
2025-04-29 14:24:33.149 INFO: Epoch 25: head: validation, loss=0.64277588, MAE_E=  889.31 meV, MAE_F=  307.16 meV / A
2025-04-29 14:24:35.896 INFO: Epoch 26: head: train, loss=0.55103071, MAE_E=  504.73 meV, MAE_F=  295.77 meV / A
2025-04-29 14:24:36.669 INFO: Epoch 26: head: validation, loss=0.57413574, MAE_E=  485.77 meV, MAE_F=  296.28 meV / A
2025-04-29 14:24:36.669 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:24:36.669 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5917], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:24:36.673 INFO: 
2025-04-29 14:24:36.673 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:24:36.673 INFO: eveluation
2025-04-29 14:24:36.673 INFO: The scale is [0.59166257] and shift is 0.0
2025-04-29 14:24:36.825 INFO: Energy Mean: -64250.433029513886, Variance: 0.12955612559377414
2025-04-29 14:24:37.101 INFO: Energy RMSE: 1.1002322435379028
2025-04-29 14:24:37.101 INFO: Energy R2: -8.343525260011512
2025-04-29 14:24:37.101 INFO: Energy MAE: 1.0501736402511597
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:24:37.102 INFO: Forces RMSE: 1.1036615763508812
2025-04-29 14:24:37.102 INFO: Forces R2: 0.6593805674612412
2025-04-29 14:24:37.701 INFO: Energy Mean: -64250.418869357636, Variance: 0.14339980502187472
2025-04-29 14:24:37.839 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_1//checkpoints/bi11-3_samples_run-123_epoch-6.pt
2025-04-29 14:24:37.885 INFO: Loaded Stage one model from epoch 6 for evaluation
2025-04-29 14:24:37.886 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_1/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:24:38.052 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_1/bi11-3_samples_compiled.model
2025-04-29 14:24:38.144 INFO: Done
Loading saved bootstrap sample 2
Training model 2
Using latent charge and penalty 10
2025-04-29 14:24:38.560 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:24:38.560 INFO: MACE version: 0.3.10
2025-04-29 14:24:38.560 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:24:38.565 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:24:38.565 INFO: Using heads: ['default']
2025-04-29 14:24:38.565 INFO: =============    Processing head default     ===========
2025-04-29 14:24:38.566 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:24:38.573 INFO: Atomic Numbers used: [83]
2025-04-29 14:24:38.573 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.947439236111}}
2025-04-29 14:24:38.578 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.947439236111}
2025-04-29 14:24:38.701 INFO: Computing average number of neighbors
2025-04-29 14:24:39.388 INFO: Average number of neighbors: 9.990702479338843
2025-04-29 14:24:39.388 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:24:39.390 INFO: ===========MODEL DETAILS===========
2025-04-29 14:24:39.390 INFO: Building model
2025-04-29 14:24:39.390 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:24:39.390 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:24:39.390 INFO: 8 radial and 5 basis functions
2025-04-29 14:24:39.390 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:24:39.391 INFO: Distance transform for radial basis functions: None
2025-04-29 14:24:39.391 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:24:40.034 INFO: Mean: -0.00016939638030748032, Std: [0.60495738]
0.0 [0.60495738]
2025-04-29 14:24:40.035 INFO: Scale: [0.60495738], Shift: 0.0
2025-04-29 14:24:41.221 INFO: Total number of parameters: 509618
2025-04-29 14:24:41.221 INFO: 
2025-04-29 14:24:41.221 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:24:41.221 INFO: Using ADAM as parameter optimizer
2025-04-29 14:24:41.222 INFO: Batch size: 32
2025-04-29 14:24:41.222 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:24:41.222 INFO: Number of gradient updates: 2250
2025-04-29 14:24:41.222 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:24:41.222 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 14:24:41.223 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:24:41.223 INFO: 
2025-04-29 14:24:41.223 INFO: ===========TRAINING===========
2025-04-29 14:24:41.223 INFO: Started training, reporting errors on validation set
2025-04-29 14:24:41.223 INFO: Loss metrics on validation set
2025-04-29 14:24:42.250 INFO: Initial: head: validation, loss=15.18599279, MAE_E=25791.20 meV, MAE_F=  444.00 meV / A
2025-04-29 14:24:45.028 INFO: Epoch 0: head: train, loss=2.16120017, MAE_E= 7447.14 meV, MAE_F=  373.85 meV / A
2025-04-29 14:24:45.916 INFO: Epoch 0: head: validation, loss=2.32723535, MAE_E= 7468.32 meV, MAE_F=  390.91 meV / A
2025-04-29 14:24:48.620 INFO: Epoch 1: head: train, loss=5.03378124, MAE_E= 2587.32 meV, MAE_F=  410.30 meV / A
2025-04-29 14:24:49.345 INFO: Epoch 1: head: validation, loss=5.11179194, MAE_E= 2600.97 meV, MAE_F=  414.81 meV / A
2025-04-29 14:24:51.928 INFO: Epoch 2: head: train, loss=0.78004549, MAE_E=  906.56 meV, MAE_F=  338.46 meV / A
2025-04-29 14:24:52.637 INFO: Epoch 2: head: validation, loss=0.88891273, MAE_E=  926.43 meV, MAE_F=  350.31 meV / A
2025-04-29 14:24:55.312 INFO: Epoch 3: head: train, loss=0.59011261, MAE_E=  574.17 meV, MAE_F=  309.91 meV / A
2025-04-29 14:24:56.006 INFO: Epoch 3: head: validation, loss=0.62774414, MAE_E=  547.40 meV, MAE_F=  314.76 meV / A
2025-04-29 14:24:58.745 INFO: Epoch 4: head: train, loss=0.48836760, MAE_E=  786.66 meV, MAE_F=  280.01 meV / A
2025-04-29 14:24:59.487 INFO: Epoch 4: head: validation, loss=0.50404396, MAE_E=  802.94 meV, MAE_F=  280.78 meV / A
2025-04-29 14:25:02.209 INFO: Epoch 5: head: train, loss=0.40065887, MAE_E=  527.13 meV, MAE_F=  258.49 meV / A
2025-04-29 14:25:02.973 INFO: Epoch 5: head: validation, loss=0.41032750, MAE_E=  514.20 meV, MAE_F=  259.33 meV / A
2025-04-29 14:25:05.744 INFO: Epoch 6: head: train, loss=0.41877205, MAE_E=  715.81 meV, MAE_F=  263.90 meV / A
2025-04-29 14:25:06.483 INFO: Epoch 6: head: validation, loss=0.43146869, MAE_E=  686.46 meV, MAE_F=  263.84 meV / A
2025-04-29 14:25:09.160 INFO: Epoch 7: head: train, loss=0.89282523, MAE_E= 2564.24 meV, MAE_F=  341.80 meV / A
2025-04-29 14:25:09.909 INFO: Epoch 7: head: validation, loss=0.96732209, MAE_E= 2579.62 meV, MAE_F=  352.19 meV / A
2025-04-29 14:25:12.604 INFO: Epoch 8: head: train, loss=1.24796010, MAE_E= 1475.36 meV, MAE_F=  340.76 meV / A
2025-04-29 14:25:13.409 INFO: Epoch 8: head: validation, loss=1.31040576, MAE_E= 1490.82 meV, MAE_F=  349.09 meV / A
2025-04-29 14:25:16.192 INFO: Epoch 9: head: train, loss=0.75034024, MAE_E=  489.77 meV, MAE_F=  287.63 meV / A
2025-04-29 14:25:16.947 INFO: Epoch 9: head: validation, loss=0.78540062, MAE_E=  489.82 meV, MAE_F=  293.07 meV / A
2025-04-29 14:25:19.780 INFO: Epoch 10: head: train, loss=0.38976970, MAE_E= 1016.13 meV, MAE_F=  260.87 meV / A
2025-04-29 14:25:20.586 INFO: Epoch 10: head: validation, loss=0.40256713, MAE_E= 1017.08 meV, MAE_F=  260.57 meV / A
2025-04-29 14:25:23.506 INFO: Epoch 11: head: train, loss=0.31784014, MAE_E=  265.21 meV, MAE_F=  243.67 meV / A
2025-04-29 14:25:24.314 INFO: Epoch 11: head: validation, loss=0.32288487, MAE_E=  211.32 meV, MAE_F=  241.47 meV / A
2025-04-29 14:25:27.033 INFO: Epoch 12: head: train, loss=0.29344029, MAE_E=  319.00 meV, MAE_F=  233.96 meV / A
2025-04-29 14:25:27.806 INFO: Epoch 12: head: validation, loss=0.29629488, MAE_E=  280.23 meV, MAE_F=  231.35 meV / A
2025-04-29 14:25:30.439 INFO: Epoch 13: head: train, loss=0.31192220, MAE_E=  794.20 meV, MAE_F=  244.77 meV / A
2025-04-29 14:25:31.160 INFO: Epoch 13: head: validation, loss=0.31956733, MAE_E=  797.53 meV, MAE_F=  242.89 meV / A
2025-04-29 14:25:33.807 INFO: Epoch 14: head: train, loss=0.28643337, MAE_E= 1272.60 meV, MAE_F=  230.79 meV / A
2025-04-29 14:25:34.537 INFO: Epoch 14: head: validation, loss=0.29642670, MAE_E= 1267.43 meV, MAE_F=  230.47 meV / A
2025-04-29 14:25:37.083 INFO: Epoch 15: head: train, loss=0.56086726, MAE_E= 5513.61 meV, MAE_F=  251.67 meV / A
2025-04-29 14:25:37.793 INFO: Epoch 15: head: validation, loss=0.57149769, MAE_E= 5516.82 meV, MAE_F=  250.15 meV / A
2025-04-29 14:25:40.439 INFO: Epoch 16: head: train, loss=0.57389922, MAE_E= 5565.14 meV, MAE_F=  270.10 meV / A
2025-04-29 14:25:41.162 INFO: Epoch 16: head: validation, loss=0.58628931, MAE_E= 5569.92 meV, MAE_F=  268.47 meV / A
2025-04-29 14:25:43.836 INFO: Epoch 17: head: train, loss=0.53561131, MAE_E= 2192.76 meV, MAE_F=  278.33 meV / A
2025-04-29 14:25:44.584 INFO: Epoch 17: head: validation, loss=0.55488406, MAE_E= 2191.08 meV, MAE_F=  279.00 meV / A
2025-04-29 14:25:47.108 INFO: Epoch 18: head: train, loss=0.44763076, MAE_E=  726.78 meV, MAE_F=  267.96 meV / A
2025-04-29 14:25:47.831 INFO: Epoch 18: head: validation, loss=0.46342704, MAE_E=  695.76 meV, MAE_F=  268.31 meV / A
2025-04-29 14:25:50.247 INFO: Epoch 19: head: train, loss=0.37367786, MAE_E=  759.41 meV, MAE_F=  254.87 meV / A
2025-04-29 14:25:51.036 INFO: Epoch 19: head: validation, loss=0.38298691, MAE_E=  734.46 meV, MAE_F=  254.14 meV / A
2025-04-29 14:25:53.818 INFO: Epoch 20: head: train, loss=0.34344504, MAE_E=  698.94 meV, MAE_F=  243.58 meV / A
2025-04-29 14:25:54.554 INFO: Epoch 20: head: validation, loss=0.35674286, MAE_E=  673.53 meV, MAE_F=  243.59 meV / A
2025-04-29 14:25:57.294 INFO: Epoch 21: head: train, loss=0.31902595, MAE_E=  264.29 meV, MAE_F=  235.48 meV / A
2025-04-29 14:25:58.069 INFO: Epoch 21: head: validation, loss=0.32542273, MAE_E=  252.15 meV, MAE_F=  234.29 meV / A
2025-04-29 14:26:00.719 INFO: Epoch 22: head: train, loss=0.34721072, MAE_E=  573.89 meV, MAE_F=  239.07 meV / A
2025-04-29 14:26:01.403 INFO: Epoch 22: head: validation, loss=0.36133922, MAE_E=  574.36 meV, MAE_F=  242.22 meV / A
2025-04-29 14:26:04.157 INFO: Epoch 23: head: train, loss=0.39747964, MAE_E=  335.85 meV, MAE_F=  245.72 meV / A
2025-04-29 14:26:04.950 INFO: Epoch 23: head: validation, loss=0.40810823, MAE_E=  324.56 meV, MAE_F=  246.92 meV / A
2025-04-29 14:26:07.740 INFO: Epoch 24: head: train, loss=0.40207998, MAE_E=  882.29 meV, MAE_F=  235.63 meV / A
2025-04-29 14:26:08.549 INFO: Epoch 24: head: validation, loss=0.41400289, MAE_E=  875.15 meV, MAE_F=  237.20 meV / A
2025-04-29 14:26:11.282 INFO: Epoch 25: head: train, loss=0.41540752, MAE_E=  740.16 meV, MAE_F=  261.74 meV / A
2025-04-29 14:26:12.098 INFO: Epoch 25: head: validation, loss=0.42568559, MAE_E=  731.27 meV, MAE_F=  261.01 meV / A
2025-04-29 14:26:15.106 INFO: Epoch 26: head: train, loss=0.34347945, MAE_E=  861.80 meV, MAE_F=  244.69 meV / A
2025-04-29 14:26:15.881 INFO: Epoch 26: head: validation, loss=0.35555127, MAE_E=  865.60 meV, MAE_F=  245.84 meV / A
2025-04-29 14:26:18.644 INFO: Epoch 27: head: train, loss=0.42701217, MAE_E=  235.06 meV, MAE_F=  263.49 meV / A
2025-04-29 14:26:19.410 INFO: Epoch 27: head: validation, loss=0.45149870, MAE_E=  201.36 meV, MAE_F=  267.67 meV / A
2025-04-29 14:26:22.175 INFO: Epoch 28: head: train, loss=0.37669821, MAE_E=  336.69 meV, MAE_F=  250.98 meV / A
2025-04-29 14:26:22.943 INFO: Epoch 28: head: validation, loss=0.39138912, MAE_E=  327.46 meV, MAE_F=  252.82 meV / A
2025-04-29 14:26:25.641 INFO: Epoch 29: head: train, loss=0.33798613, MAE_E=  224.57 meV, MAE_F=  242.70 meV / A
2025-04-29 14:26:26.377 INFO: Epoch 29: head: validation, loss=0.34671322, MAE_E=  198.64 meV, MAE_F=  242.73 meV / A
2025-04-29 14:26:29.109 INFO: Epoch 30: head: train, loss=0.30797139, MAE_E=  203.22 meV, MAE_F=  233.93 meV / A
2025-04-29 14:26:29.862 INFO: Epoch 30: head: validation, loss=0.31305813, MAE_E=  160.83 meV, MAE_F=  232.56 meV / A
2025-04-29 14:26:32.625 INFO: Epoch 31: head: train, loss=0.50485171, MAE_E= 1455.17 meV, MAE_F=  265.75 meV / A
2025-04-29 14:26:33.424 INFO: Epoch 31: head: validation, loss=0.53159117, MAE_E= 1441.68 meV, MAE_F=  269.33 meV / A
2025-04-29 14:26:36.247 INFO: Epoch 32: head: train, loss=1.00764909, MAE_E= 2354.06 meV, MAE_F=  308.57 meV / A
2025-04-29 14:26:37.016 INFO: Epoch 32: head: validation, loss=1.07048715, MAE_E= 2342.15 meV, MAE_F=  317.24 meV / A
2025-04-29 14:26:37.016 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:26:37.016 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.6050], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:26:37.020 INFO: 
2025-04-29 14:26:37.020 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:26:37.020 INFO: eveluation
2025-04-29 14:26:37.021 INFO: The scale is [0.60495738] and shift is 0.0
2025-04-29 14:26:37.161 INFO: Energy Mean: -64250.395703125, Variance: 0.12024042765299478
2025-04-29 14:26:37.408 INFO: Energy RMSE: 4.206019878387451
2025-04-29 14:26:37.408 INFO: Energy R2: -146.12689202544422
2025-04-29 14:26:37.408 INFO: Energy MAE: 4.19214391708374
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:26:37.409 INFO: Forces RMSE: 1.849336316093262
2025-04-29 14:26:37.409 INFO: Forces R2: 0.2349485792212186
2025-04-29 14:26:37.960 INFO: Energy Mean: -64250.421831597225, Variance: 0.16448160618911553
2025-04-29 14:26:38.084 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_2//checkpoints/bi11-3_samples_run-123_epoch-12.pt
2025-04-29 14:26:38.132 INFO: Loaded Stage one model from epoch 12 for evaluation
2025-04-29 14:26:38.132 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_2/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:26:38.297 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_2/bi11-3_samples_compiled.model
2025-04-29 14:26:38.396 INFO: Done
Loading saved bootstrap sample 3
Training model 3
Using latent charge and penalty 10
2025-04-29 14:26:38.840 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:26:38.840 INFO: MACE version: 0.3.10
2025-04-29 14:26:38.840 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:26:38.846 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:26:38.846 INFO: Using heads: ['default']
2025-04-29 14:26:38.846 INFO: =============    Processing head default     ===========
2025-04-29 14:26:38.846 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:26:38.853 INFO: Atomic Numbers used: [83]
2025-04-29 14:26:38.853 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.943625710226}}
2025-04-29 14:26:38.858 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.943625710226}
2025-04-29 14:26:39.000 INFO: Computing average number of neighbors
2025-04-29 14:26:39.669 INFO: Average number of neighbors: 9.993801652892563
2025-04-29 14:26:39.669 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:26:39.671 INFO: ===========MODEL DETAILS===========
2025-04-29 14:26:39.671 INFO: Building model
2025-04-29 14:26:39.671 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:26:39.671 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:26:39.671 INFO: 8 radial and 5 basis functions
2025-04-29 14:26:39.671 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:26:39.671 INFO: Distance transform for radial basis functions: None
2025-04-29 14:26:39.672 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:26:40.287 INFO: Mean: -0.00013114992252065926, Std: [0.58461786]
0.0 [0.58461786]
2025-04-29 14:26:40.288 INFO: Scale: [0.58461786], Shift: 0.0
2025-04-29 14:26:41.521 INFO: Total number of parameters: 509618
2025-04-29 14:26:41.521 INFO: 
2025-04-29 14:26:41.522 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:26:41.522 INFO: Using ADAM as parameter optimizer
2025-04-29 14:26:41.522 INFO: Batch size: 32
2025-04-29 14:26:41.522 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:26:41.522 INFO: Number of gradient updates: 2250
2025-04-29 14:26:41.522 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:26:41.522 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 14:26:41.524 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:26:41.524 INFO: 
2025-04-29 14:26:41.524 INFO: ===========TRAINING===========
2025-04-29 14:26:41.524 INFO: Started training, reporting errors on validation set
2025-04-29 14:26:41.524 INFO: Loss metrics on validation set
2025-04-29 14:26:42.505 INFO: Initial: head: validation, loss=15.10677816, MAE_E=25026.10 meV, MAE_F=  426.15 meV / A
2025-04-29 14:26:45.176 INFO: Epoch 0: head: train, loss=2.08974127, MAE_E= 7118.66 meV, MAE_F=  372.30 meV / A
2025-04-29 14:26:46.069 INFO: Epoch 0: head: validation, loss=2.27443660, MAE_E= 7071.15 meV, MAE_F=  381.96 meV / A
2025-04-29 14:26:48.828 INFO: Epoch 1: head: train, loss=4.76783930, MAE_E=  891.46 meV, MAE_F=  368.04 meV / A
2025-04-29 14:26:49.584 INFO: Epoch 1: head: validation, loss=4.89023524, MAE_E=  911.66 meV, MAE_F=  372.93 meV / A
2025-04-29 14:26:52.243 INFO: Epoch 2: head: train, loss=0.69952001, MAE_E=  553.23 meV, MAE_F=  333.06 meV / A
2025-04-29 14:26:52.985 INFO: Epoch 2: head: validation, loss=0.77578522, MAE_E=  517.79 meV, MAE_F=  332.30 meV / A
2025-04-29 14:26:55.752 INFO: Epoch 3: head: train, loss=0.48525489, MAE_E=  629.23 meV, MAE_F=  292.74 meV / A
2025-04-29 14:26:56.527 INFO: Epoch 3: head: validation, loss=0.50450388, MAE_E=  582.37 meV, MAE_F=  287.93 meV / A
2025-04-29 14:26:59.390 INFO: Epoch 4: head: train, loss=0.39013915, MAE_E=  527.34 meV, MAE_F=  263.84 meV / A
2025-04-29 14:27:00.167 INFO: Epoch 4: head: validation, loss=0.40292129, MAE_E=  407.93 meV, MAE_F=  261.78 meV / A
2025-04-29 14:27:02.946 INFO: Epoch 5: head: train, loss=0.35711079, MAE_E= 1544.43 meV, MAE_F=  256.09 meV / A
2025-04-29 14:27:03.693 INFO: Epoch 5: head: validation, loss=0.36575361, MAE_E= 1444.16 meV, MAE_F=  252.68 meV / A
2025-04-29 14:27:06.394 INFO: Epoch 6: head: train, loss=0.36161420, MAE_E=  336.25 meV, MAE_F=  247.52 meV / A
2025-04-29 14:27:07.087 INFO: Epoch 6: head: validation, loss=0.38816410, MAE_E=  277.44 meV, MAE_F=  248.04 meV / A
2025-04-29 14:27:09.750 INFO: Epoch 7: head: train, loss=0.46061496, MAE_E= 2155.00 meV, MAE_F=  278.70 meV / A
2025-04-29 14:27:10.492 INFO: Epoch 7: head: validation, loss=0.49564132, MAE_E= 2070.31 meV, MAE_F=  278.12 meV / A
2025-04-29 14:27:13.123 INFO: Epoch 8: head: train, loss=0.40786659, MAE_E= 1344.33 meV, MAE_F=  247.50 meV / A
2025-04-29 14:27:13.897 INFO: Epoch 8: head: validation, loss=0.41401323, MAE_E= 1259.81 meV, MAE_F=  244.26 meV / A
2025-04-29 14:27:16.553 INFO: Epoch 9: head: train, loss=0.33121250, MAE_E=  278.06 meV, MAE_F=  233.88 meV / A
2025-04-29 14:27:17.308 INFO: Epoch 9: head: validation, loss=0.34928473, MAE_E=  227.83 meV, MAE_F=  232.91 meV / A
2025-04-29 14:27:20.071 INFO: Epoch 10: head: train, loss=0.27580221, MAE_E=  854.08 meV, MAE_F=  225.11 meV / A
2025-04-29 14:27:20.742 INFO: Epoch 10: head: validation, loss=0.29337651, MAE_E=  802.09 meV, MAE_F=  225.64 meV / A
2025-04-29 14:27:23.484 INFO: Epoch 11: head: train, loss=0.23673867, MAE_E=  289.21 meV, MAE_F=  211.25 meV / A
2025-04-29 14:27:24.313 INFO: Epoch 11: head: validation, loss=0.25400094, MAE_E=  246.25 meV, MAE_F=  214.11 meV / A
2025-04-29 14:27:27.005 INFO: Epoch 12: head: train, loss=0.25673134, MAE_E= 1912.68 meV, MAE_F=  208.26 meV / A
2025-04-29 14:27:27.758 INFO: Epoch 12: head: validation, loss=0.27406556, MAE_E= 1878.89 meV, MAE_F=  210.99 meV / A
2025-04-29 14:27:30.462 INFO: Epoch 13: head: train, loss=0.29090686, MAE_E= 1188.42 meV, MAE_F=  210.39 meV / A
2025-04-29 14:27:31.252 INFO: Epoch 13: head: validation, loss=0.30001080, MAE_E= 1128.64 meV, MAE_F=  210.69 meV / A
2025-04-29 14:27:33.985 INFO: Epoch 14: head: train, loss=0.34022748, MAE_E=  999.89 meV, MAE_F=  201.79 meV / A
2025-04-29 14:27:34.720 INFO: Epoch 14: head: validation, loss=0.35056715, MAE_E=  951.39 meV, MAE_F=  202.67 meV / A
2025-04-29 14:27:37.467 INFO: Epoch 15: head: train, loss=0.28335398, MAE_E=  645.97 meV, MAE_F=  205.62 meV / A
2025-04-29 14:27:38.230 INFO: Epoch 15: head: validation, loss=0.28773634, MAE_E=  579.32 meV, MAE_F=  205.05 meV / A
2025-04-29 14:27:40.869 INFO: Epoch 16: head: train, loss=0.25059494, MAE_E=  482.86 meV, MAE_F=  199.84 meV / A
2025-04-29 14:27:41.564 INFO: Epoch 16: head: validation, loss=0.25519300, MAE_E=  424.81 meV, MAE_F=  199.56 meV / A
2025-04-29 14:27:44.235 INFO: Epoch 17: head: train, loss=0.22221902, MAE_E=  417.05 meV, MAE_F=  197.12 meV / A
2025-04-29 14:27:44.956 INFO: Epoch 17: head: validation, loss=0.23164531, MAE_E=  380.03 meV, MAE_F=  197.20 meV / A
2025-04-29 14:27:47.585 INFO: Epoch 18: head: train, loss=0.23532588, MAE_E=  227.81 meV, MAE_F=  190.98 meV / A
2025-04-29 14:27:48.218 INFO: Epoch 18: head: validation, loss=0.24217262, MAE_E=  201.41 meV, MAE_F=  191.38 meV / A
2025-04-29 14:27:50.659 INFO: Epoch 19: head: train, loss=0.25373635, MAE_E=  328.89 meV, MAE_F=  190.37 meV / A
2025-04-29 14:27:51.269 INFO: Epoch 19: head: validation, loss=0.26112311, MAE_E=  293.37 meV, MAE_F=  191.04 meV / A
2025-04-29 14:27:53.739 INFO: Epoch 20: head: train, loss=0.20725777, MAE_E=  323.36 meV, MAE_F=  187.86 meV / A
2025-04-29 14:27:54.455 INFO: Epoch 20: head: validation, loss=0.21601956, MAE_E=  298.64 meV, MAE_F=  188.76 meV / A
2025-04-29 14:27:57.085 INFO: Epoch 21: head: train, loss=0.19897627, MAE_E=  286.95 meV, MAE_F=  186.25 meV / A
2025-04-29 14:27:57.802 INFO: Epoch 21: head: validation, loss=0.20768066, MAE_E=  263.45 meV, MAE_F=  186.62 meV / A
2025-04-29 14:28:00.505 INFO: Epoch 22: head: train, loss=0.21124820, MAE_E=  415.57 meV, MAE_F=  190.23 meV / A
2025-04-29 14:28:01.213 INFO: Epoch 22: head: validation, loss=0.22407178, MAE_E=  390.40 meV, MAE_F=  191.61 meV / A
2025-04-29 14:28:03.861 INFO: Epoch 23: head: train, loss=0.24780677, MAE_E=  189.05 meV, MAE_F=  194.80 meV / A
2025-04-29 14:28:04.614 INFO: Epoch 23: head: validation, loss=0.26493965, MAE_E=  168.51 meV, MAE_F=  196.02 meV / A
2025-04-29 14:28:07.286 INFO: Epoch 24: head: train, loss=0.31973911, MAE_E=  529.36 meV, MAE_F=  205.01 meV / A
2025-04-29 14:28:08.024 INFO: Epoch 24: head: validation, loss=0.34019473, MAE_E=  534.26 meV, MAE_F=  205.98 meV / A
2025-04-29 14:28:10.767 INFO: Epoch 25: head: train, loss=1.23583452, MAE_E= 9324.30 meV, MAE_F=  474.75 meV / A
2025-04-29 14:28:11.509 INFO: Epoch 25: head: validation, loss=1.28586601, MAE_E= 9445.97 meV, MAE_F=  470.70 meV / A
2025-04-29 14:28:14.212 INFO: Epoch 26: head: train, loss=1.47774574, MAE_E=24540.64 meV, MAE_F=  454.46 meV / A
2025-04-29 14:28:14.988 INFO: Epoch 26: head: validation, loss=1.52161588, MAE_E=24698.85 meV, MAE_F=  446.61 meV / A
2025-04-29 14:28:17.457 INFO: Epoch 27: head: train, loss=1.31040874, MAE_E=30982.20 meV, MAE_F=  403.51 meV / A
2025-04-29 14:28:18.088 INFO: Epoch 27: head: validation, loss=1.35863094, MAE_E=31118.80 meV, MAE_F=  397.41 meV / A
2025-04-29 14:28:20.510 INFO: Epoch 28: head: train, loss=0.73389352, MAE_E=27069.90 meV, MAE_F=  286.69 meV / A
2025-04-29 14:28:21.245 INFO: Epoch 28: head: validation, loss=0.75980338, MAE_E=27192.40 meV, MAE_F=  282.13 meV / A
2025-04-29 14:28:23.692 INFO: Epoch 29: head: train, loss=0.85973250, MAE_E=20318.29 meV, MAE_F=  290.43 meV / A
2025-04-29 14:28:24.357 INFO: Epoch 29: head: validation, loss=0.95053803, MAE_E=20430.59 meV, MAE_F=  297.78 meV / A
2025-04-29 14:28:26.872 INFO: Epoch 30: head: train, loss=0.96070751, MAE_E= 9367.93 meV, MAE_F=  357.83 meV / A
2025-04-29 14:28:27.598 INFO: Epoch 30: head: validation, loss=1.23813287, MAE_E= 9452.67 meV, MAE_F=  374.50 meV / A
2025-04-29 14:28:30.251 INFO: Epoch 31: head: train, loss=0.51255230, MAE_E= 1895.78 meV, MAE_F=  262.11 meV / A
2025-04-29 14:28:30.975 INFO: Epoch 31: head: validation, loss=0.59777419, MAE_E= 1815.22 meV, MAE_F=  268.09 meV / A
2025-04-29 14:28:33.786 INFO: Epoch 32: head: train, loss=0.52038388, MAE_E= 5632.12 meV, MAE_F=  265.48 meV / A
2025-04-29 14:28:34.556 INFO: Epoch 32: head: validation, loss=0.54777859, MAE_E= 5722.26 meV, MAE_F=  263.78 meV / A
2025-04-29 14:28:37.166 INFO: Epoch 33: head: train, loss=0.72131702, MAE_E=29776.57 meV, MAE_F=  303.13 meV / A
2025-04-29 14:28:37.908 INFO: Epoch 33: head: validation, loss=0.76521003, MAE_E=29871.39 meV, MAE_F=  301.43 meV / A
2025-04-29 14:28:40.578 INFO: Epoch 34: head: train, loss=1.20612273, MAE_E=46052.13 meV, MAE_F=  356.86 meV / A
2025-04-29 14:28:41.349 INFO: Epoch 34: head: validation, loss=1.28374382, MAE_E=46144.26 meV, MAE_F=  356.14 meV / A
2025-04-29 14:28:44.552 INFO: Epoch 35: head: train, loss=1.36627069, MAE_E=48397.09 meV, MAE_F=  367.65 meV / A
2025-04-29 14:28:45.279 INFO: Epoch 35: head: validation, loss=1.46044730, MAE_E=48486.30 meV, MAE_F=  366.92 meV / A
2025-04-29 14:28:48.081 INFO: Epoch 36: head: train, loss=1.18675983, MAE_E=39467.74 meV, MAE_F=  366.39 meV / A
2025-04-29 14:28:48.796 INFO: Epoch 36: head: validation, loss=1.27151640, MAE_E=39553.35 meV, MAE_F=  366.50 meV / A
2025-04-29 14:28:51.452 INFO: Epoch 37: head: train, loss=0.92910523, MAE_E=27985.53 meV, MAE_F=  352.61 meV / A
2025-04-29 14:28:52.187 INFO: Epoch 37: head: validation, loss=0.99362001, MAE_E=28079.03 meV, MAE_F=  352.06 meV / A
2025-04-29 14:28:54.829 INFO: Epoch 38: head: train, loss=0.75488956, MAE_E=19391.19 meV, MAE_F=  335.97 meV / A
2025-04-29 14:28:55.545 INFO: Epoch 38: head: validation, loss=0.80199471, MAE_E=19482.88 meV, MAE_F=  333.53 meV / A
2025-04-29 14:28:58.125 INFO: Epoch 39: head: train, loss=0.62854832, MAE_E=14160.90 meV, MAE_F=  322.86 meV / A
2025-04-29 14:28:58.766 INFO: Epoch 39: head: validation, loss=0.66584724, MAE_E=14245.35 meV, MAE_F=  319.92 meV / A
2025-04-29 14:29:01.221 INFO: Epoch 40: head: train, loss=0.58169710, MAE_E=10692.18 meV, MAE_F=  316.69 meV / A
2025-04-29 14:29:01.823 INFO: Epoch 40: head: validation, loss=0.60785712, MAE_E=10777.33 meV, MAE_F=  312.04 meV / A
2025-04-29 14:29:04.403 INFO: Epoch 41: head: train, loss=0.53364695, MAE_E= 8520.05 meV, MAE_F=  309.16 meV / A
2025-04-29 14:29:05.082 INFO: Epoch 41: head: validation, loss=0.55427820, MAE_E= 8605.14 meV, MAE_F=  304.27 meV / A
2025-04-29 14:29:05.082 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:29:05.082 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5846], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:29:05.085 INFO: 
2025-04-29 14:29:05.085 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:29:05.085 INFO: eveluation
2025-04-29 14:29:05.085 INFO: The scale is [0.58461786] and shift is 0.0
2025-04-29 14:29:05.220 INFO: Energy Mean: -64250.434071180556, Variance: 0.1148901461377556
2025-04-29 14:29:05.479 INFO: Energy RMSE: 1.1428300142288208
2025-04-29 14:29:05.479 INFO: Energy R2: -10.367905136297157
2025-04-29 14:29:05.479 INFO: Energy MAE: 1.099609375
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:29:05.480 INFO: Forces RMSE: 1.125490417003381
2025-04-29 14:29:05.480 INFO: Forces R2: 0.6958111627758297
2025-04-29 14:29:06.007 INFO: Energy Mean: -64250.3798828125, Variance: 0.200196901957194
2025-04-29 14:29:06.147 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_3//checkpoints/bi11-3_samples_run-123_epoch-21.pt
2025-04-29 14:29:06.192 INFO: Loaded Stage one model from epoch 21 for evaluation
2025-04-29 14:29:06.192 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_3/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:29:06.354 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_3/bi11-3_samples_compiled.model
2025-04-29 14:29:06.442 INFO: Done
Loading saved bootstrap sample 4
Training model 4
Using latent charge and penalty 10
2025-04-29 14:29:06.854 INFO: ===========VERIFYING SETTINGS===========
2025-04-29 14:29:06.854 INFO: MACE version: 0.3.10
2025-04-29 14:29:06.855 INFO: CUDA version: 12.1, CUDA device: 0
default
2025-04-29 14:29:06.860 INFO: ===========LOADING INPUT DATA===========
2025-04-29 14:29:06.860 INFO: Using heads: ['default']
2025-04-29 14:29:06.860 INFO: =============    Processing head default     ===========
2025-04-29 14:29:06.860 INFO: Total number of configurations: train=360, valid=90, 
2025-04-29 14:29:06.868 INFO: Atomic Numbers used: [83]
2025-04-29 14:29:06.868 INFO: Computing average Atomic Energies using least squares regression
{'default': {83: -5840.950555358269}}
2025-04-29 14:29:06.872 INFO: Atomic Energies used (z: eV) for head default: {83: -5840.950555358269}
2025-04-29 14:29:06.991 INFO: Computing average number of neighbors
2025-04-29 14:29:07.559 INFO: Average number of neighbors: 9.992768595041323
2025-04-29 14:29:07.559 INFO: During training the following quantities will be reported: energy, forces
2025-04-29 14:29:07.561 INFO: ===========MODEL DETAILS===========
2025-04-29 14:29:07.561 INFO: Building model
2025-04-29 14:29:07.561 INFO: Message passing with 128 channels and max_L=1 (128x0e+128x1o)
2025-04-29 14:29:07.561 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-04-29 14:29:07.561 INFO: 8 radial and 5 basis functions
2025-04-29 14:29:07.561 INFO: Radial cutoff: 9.0 A (total receptive field for each atom: 18.0 A)
2025-04-29 14:29:07.561 INFO: Distance transform for radial basis functions: None
2025-04-29 14:29:07.561 INFO: Hidden irreps: 128x0e+128x1o
2025-04-29 14:29:08.124 INFO: Mean: 0.000435709187408337, Std: [0.59789193]
0.0 [0.59789193]
2025-04-29 14:29:08.124 INFO: Scale: [0.59789193], Shift: 0.0
2025-04-29 14:29:09.282 INFO: Total number of parameters: 509618
2025-04-29 14:29:09.282 INFO: 
2025-04-29 14:29:09.282 INFO: ===========OPTIMIZER INFORMATION===========
2025-04-29 14:29:09.282 INFO: Using ADAM as parameter optimizer
2025-04-29 14:29:09.282 INFO: Batch size: 32
2025-04-29 14:29:09.282 INFO: Using Exponential Moving Average with decay: 0.99
2025-04-29 14:29:09.282 INFO: Number of gradient updates: 2250
2025-04-29 14:29:09.282 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-04-29 14:29:09.282 INFO: WeightedEnergyForcesChargeLoss(energy_weight=1.000, forces_weight=100.000, charge_penalty_weight=10.000)
2025-04-29 14:29:09.284 INFO: Using gradient clipping with tolerance=10.000
2025-04-29 14:29:09.284 INFO: 
2025-04-29 14:29:09.284 INFO: ===========TRAINING===========
2025-04-29 14:29:09.284 INFO: Started training, reporting errors on validation set
2025-04-29 14:29:09.284 INFO: Loss metrics on validation set
2025-04-29 14:29:10.173 INFO: Initial: head: validation, loss=14.97579169, MAE_E=25522.82 meV, MAE_F=  421.92 meV / A
2025-04-29 14:29:12.611 INFO: Epoch 0: head: train, loss=2.12622600, MAE_E= 7155.32 meV, MAE_F=  373.23 meV / A
2025-04-29 14:29:13.411 INFO: Epoch 0: head: validation, loss=2.17046664, MAE_E= 7171.19 meV, MAE_F=  374.26 meV / A
2025-04-29 14:29:16.184 INFO: Epoch 1: head: train, loss=4.79998968, MAE_E= 1263.39 meV, MAE_F=  378.62 meV / A
2025-04-29 14:29:16.933 INFO: Epoch 1: head: validation, loss=4.88333976, MAE_E= 1250.43 meV, MAE_F=  382.51 meV / A
2025-04-29 14:29:19.613 INFO: Epoch 2: head: train, loss=0.69521305, MAE_E=  737.96 meV, MAE_F=  331.80 meV / A
2025-04-29 14:29:20.358 INFO: Epoch 2: head: validation, loss=0.74830615, MAE_E=  742.36 meV, MAE_F=  330.96 meV / A
2025-04-29 14:29:23.130 INFO: Epoch 3: head: train, loss=0.49499384, MAE_E=  613.78 meV, MAE_F=  295.71 meV / A
2025-04-29 14:29:23.891 INFO: Epoch 3: head: validation, loss=0.55915741, MAE_E=  649.40 meV, MAE_F=  296.50 meV / A
2025-04-29 14:29:26.683 INFO: Epoch 4: head: train, loss=0.40353165, MAE_E=  705.19 meV, MAE_F=  265.34 meV / A
2025-04-29 14:29:27.427 INFO: Epoch 4: head: validation, loss=0.45281346, MAE_E=  736.79 meV, MAE_F=  268.21 meV / A
2025-04-29 14:29:30.246 INFO: Epoch 5: head: train, loss=0.32156579, MAE_E=  489.78 meV, MAE_F=  245.87 meV / A
2025-04-29 14:29:30.989 INFO: Epoch 5: head: validation, loss=0.35956195, MAE_E=  501.32 meV, MAE_F=  250.42 meV / A
2025-04-29 14:29:33.774 INFO: Epoch 6: head: train, loss=0.37712841, MAE_E= 1988.86 meV, MAE_F=  266.05 meV / A
2025-04-29 14:29:34.557 INFO: Epoch 6: head: validation, loss=0.41879032, MAE_E= 1989.58 meV, MAE_F=  269.52 meV / A
2025-04-29 14:29:37.275 INFO: Epoch 7: head: train, loss=0.29181467, MAE_E=  817.37 meV, MAE_F=  238.19 meV / A
2025-04-29 14:29:38.016 INFO: Epoch 7: head: validation, loss=0.32988440, MAE_E=  827.77 meV, MAE_F=  242.52 meV / A
2025-04-29 14:29:40.758 INFO: Epoch 8: head: train, loss=0.28171936, MAE_E=  258.53 meV, MAE_F=  228.42 meV / A
2025-04-29 14:29:41.505 INFO: Epoch 8: head: validation, loss=0.31181933, MAE_E=  286.96 meV, MAE_F=  231.06 meV / A
2025-04-29 14:29:44.244 INFO: Epoch 9: head: train, loss=0.40599433, MAE_E=  359.08 meV, MAE_F=  220.44 meV / A
2025-04-29 14:29:44.975 INFO: Epoch 9: head: validation, loss=0.43319175, MAE_E=  373.57 meV, MAE_F=  221.54 meV / A
2025-04-29 14:29:47.764 INFO: Epoch 10: head: train, loss=0.27512368, MAE_E=  246.31 meV, MAE_F=  223.68 meV / A
2025-04-29 14:29:48.520 INFO: Epoch 10: head: validation, loss=0.31620236, MAE_E=  256.65 meV, MAE_F=  228.77 meV / A
2025-04-29 14:29:51.200 INFO: Epoch 11: head: train, loss=0.23477399, MAE_E=  265.92 meV, MAE_F=  209.26 meV / A
2025-04-29 14:29:51.950 INFO: Epoch 11: head: validation, loss=0.26599496, MAE_E=  269.58 meV, MAE_F=  212.58 meV / A
2025-04-29 14:29:54.737 INFO: Epoch 12: head: train, loss=0.27281460, MAE_E=  366.13 meV, MAE_F=  231.21 meV / A
2025-04-29 14:29:55.549 INFO: Epoch 12: head: validation, loss=0.30333741, MAE_E=  379.56 meV, MAE_F=  234.73 meV / A
2025-04-29 14:29:58.392 INFO: Epoch 13: head: train, loss=0.38370250, MAE_E= 3202.93 meV, MAE_F=  250.39 meV / A
2025-04-29 14:29:59.129 INFO: Epoch 13: head: validation, loss=0.42463056, MAE_E= 3205.44 meV, MAE_F=  256.14 meV / A
2025-04-29 14:30:01.855 INFO: Epoch 14: head: train, loss=0.51721491, MAE_E=  760.96 meV, MAE_F=  280.18 meV / A
2025-04-29 14:30:02.648 INFO: Epoch 14: head: validation, loss=0.56883079, MAE_E=  770.09 meV, MAE_F=  285.49 meV / A
2025-04-29 14:30:05.385 INFO: Epoch 15: head: train, loss=0.58254761, MAE_E= 2700.27 meV, MAE_F=  302.53 meV / A
2025-04-29 14:30:06.126 INFO: Epoch 15: head: validation, loss=0.64459967, MAE_E= 2670.27 meV, MAE_F=  309.32 meV / A
2025-04-29 14:30:08.887 INFO: Epoch 16: head: train, loss=0.49034890, MAE_E=  398.30 meV, MAE_F=  289.42 meV / A
2025-04-29 14:30:09.646 INFO: Epoch 16: head: validation, loss=0.55289574, MAE_E=  412.66 meV, MAE_F=  298.36 meV / A
2025-04-29 14:30:12.400 INFO: Epoch 17: head: train, loss=0.46173713, MAE_E=  982.41 meV, MAE_F=  284.73 meV / A
2025-04-29 14:30:13.159 INFO: Epoch 17: head: validation, loss=0.52184081, MAE_E=  969.13 meV, MAE_F=  293.86 meV / A
2025-04-29 14:30:15.889 INFO: Epoch 18: head: train, loss=0.41949803, MAE_E= 1343.54 meV, MAE_F=  277.95 meV / A
2025-04-29 14:30:16.634 INFO: Epoch 18: head: validation, loss=0.47622854, MAE_E= 1320.54 meV, MAE_F=  286.42 meV / A
2025-04-29 14:30:19.286 INFO: Epoch 19: head: train, loss=0.40020136, MAE_E=  934.58 meV, MAE_F=  273.45 meV / A
2025-04-29 14:30:20.031 INFO: Epoch 19: head: validation, loss=0.45578669, MAE_E=  916.68 meV, MAE_F=  281.53 meV / A
2025-04-29 14:30:22.775 INFO: Epoch 20: head: train, loss=0.39986045, MAE_E=  382.29 meV, MAE_F=  268.90 meV / A
2025-04-29 14:30:23.508 INFO: Epoch 20: head: validation, loss=0.46008820, MAE_E=  390.12 meV, MAE_F=  278.47 meV / A
2025-04-29 14:30:26.240 INFO: Epoch 21: head: train, loss=0.40469332, MAE_E=  315.58 meV, MAE_F=  271.63 meV / A
2025-04-29 14:30:26.961 INFO: Epoch 21: head: validation, loss=0.46035567, MAE_E=  334.66 meV, MAE_F=  279.13 meV / A
2025-04-29 14:30:29.613 INFO: Epoch 22: head: train, loss=0.43629710, MAE_E=  595.60 meV, MAE_F=  275.27 meV / A
2025-04-29 14:30:30.356 INFO: Epoch 22: head: validation, loss=0.49101761, MAE_E=  583.84 meV, MAE_F=  282.35 meV / A
2025-04-29 14:30:32.962 INFO: Epoch 23: head: train, loss=0.40034004, MAE_E=  483.36 meV, MAE_F=  268.65 meV / A
2025-04-29 14:30:33.685 INFO: Epoch 23: head: validation, loss=0.45661675, MAE_E=  477.18 meV, MAE_F=  276.25 meV / A
2025-04-29 14:30:36.312 INFO: Epoch 24: head: train, loss=0.38791941, MAE_E=  329.14 meV, MAE_F=  265.35 meV / A
2025-04-29 14:30:37.016 INFO: Epoch 24: head: validation, loss=0.44753062, MAE_E=  342.68 meV, MAE_F=  273.88 meV / A
2025-04-29 14:30:39.662 INFO: Epoch 25: head: train, loss=0.38298051, MAE_E=  319.28 meV, MAE_F=  262.73 meV / A
2025-04-29 14:30:40.396 INFO: Epoch 25: head: validation, loss=0.44103523, MAE_E=  329.72 meV, MAE_F=  271.05 meV / A
2025-04-29 14:30:43.115 INFO: Epoch 26: head: train, loss=0.37525036, MAE_E=  353.63 meV, MAE_F=  261.70 meV / A
2025-04-29 14:30:43.876 INFO: Epoch 26: head: validation, loss=0.43069894, MAE_E=  362.20 meV, MAE_F=  269.40 meV / A
2025-04-29 14:30:46.599 INFO: Epoch 27: head: train, loss=0.36304568, MAE_E=  299.15 meV, MAE_F=  259.76 meV / A
2025-04-29 14:30:47.601 INFO: Epoch 27: head: validation, loss=0.41663744, MAE_E=  321.17 meV, MAE_F=  267.27 meV / A
2025-04-29 14:30:50.345 INFO: Epoch 28: head: train, loss=0.36197643, MAE_E=  288.88 meV, MAE_F=  260.91 meV / A
2025-04-29 14:30:51.135 INFO: Epoch 28: head: validation, loss=0.41738308, MAE_E=  314.01 meV, MAE_F=  268.83 meV / A
2025-04-29 14:30:53.884 INFO: Epoch 29: head: train, loss=0.38480817, MAE_E=  361.65 meV, MAE_F=  264.58 meV / A
2025-04-29 14:30:54.651 INFO: Epoch 29: head: validation, loss=0.43926186, MAE_E=  372.27 meV, MAE_F=  272.23 meV / A
2025-04-29 14:30:57.359 INFO: Epoch 30: head: train, loss=0.43209150, MAE_E=  786.26 meV, MAE_F=  269.70 meV / A
2025-04-29 14:30:58.112 INFO: Epoch 30: head: validation, loss=0.48658942, MAE_E=  770.11 meV, MAE_F=  276.03 meV / A
2025-04-29 14:31:00.800 INFO: Epoch 31: head: train, loss=0.50098261, MAE_E=  726.66 meV, MAE_F=  272.04 meV / A
2025-04-29 14:31:01.493 INFO: Epoch 31: head: validation, loss=0.55265712, MAE_E=  716.10 meV, MAE_F=  277.25 meV / A
2025-04-29 14:31:01.493 INFO: Stopping optimization after 20 epochs without improvement
2025-04-29 14:31:01.493 INFO: Training complete
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
tensor([0.5979], device='cuda:0') tensor(0., device='cuda:0')
2025-04-29 14:31:01.496 INFO: 
2025-04-29 14:31:01.496 INFO: ===========FINISHED TRAINING===========
2025-04-29 14:31:01.496 INFO: eveluation
2025-04-29 14:31:01.496 INFO: The scale is [0.59789193] and shift is 0.0
2025-04-29 14:31:01.643 INFO: Energy Mean: -64250.447265625, Variance: 0.17664735582139757
2025-04-29 14:31:01.900 INFO: Energy RMSE: 7.242243766784668
2025-04-29 14:31:01.901 INFO: Energy R2: -295.9198302921994
2025-04-29 14:31:01.901 INFO: Energy MAE: 7.220963478088379
90
(90, 11, 3)
torch.Size([90, 11, 3])
2025-04-29 14:31:01.902 INFO: Forces RMSE: 3.2123890540139852
2025-04-29 14:31:01.902 INFO: Forces R2: -1.695711848089093
2025-04-29 14:31:02.448 INFO: Energy Mean: -64250.45610894097, Variance: 0.14680764645705988
2025-04-29 14:31:02.559 INFO: Loading checkpoint: results/latent_charge_embed_10/bi11-3_samples_logs//sample_4//checkpoints/bi11-3_samples_run-123_epoch-11.pt
2025-04-29 14:31:02.605 INFO: Loaded Stage one model from epoch 11 for evaluation
2025-04-29 14:31:02.605 INFO: Saving model to results/latent_charge_embed_10/bi11-3_samples_logs/sample_4/checkpoints/bi11-3_samples_run-123.model
2025-04-29 14:31:02.767 INFO: Compiling model, saving metadata to results/latent_charge_embed_10/bi11-3_samples_logs/sample_4/bi11-3_samples_compiled.model
2025-04-29 14:31:02.862 INFO: Done

============================= JOB FEEDBACK =============================

Job ID: 3118330
Cluster: hk
User/Group: hv3694/hk-project-aimat2
Account: hk-project-aimat2
State: COMPLETED (exit code 0)
Partition: accelerated
Nodes: 1
Cores per node: 8
Nodelist: hkn0536
CPU Utilized: 00:17:59
CPU Efficiency: 21.17% of 01:24:56 core-walltime
Job Wall-clock time: 00:10:37
Starttime: Tue Apr 29 14:20:27 2025
Endtime: Tue Apr 29 14:31:04 2025
Memory Utilized: 2.38 GB
Memory Efficiency: 0.00% of 0.00 MB
Energy Consumed: 700948 Joule / 194.707777777778 Watthours
Average node power draw: 1100.38932496075 Watt
